{"remainingRequest":"C:\\Users\\AlexisAnohVianneyANI\\Desktop\\emarket-main\\shop\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\AlexisAnohVianneyANI\\Desktop\\emarket-main\\shop\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\AlexisAnohVianneyANI\\Desktop\\emarket-main\\shop\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\AlexisAnohVianneyANI\\Desktop\\emarket-main\\shop\\src\\views\\User\\Login.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\AlexisAnohVianneyANI\\Desktop\\emarket-main\\shop\\src\\views\\User\\Login.vue","mtime":1667831511111},{"path":"C:\\Users\\AlexisAnohVianneyANI\\Desktop\\emarket-main\\shop\\babel.config.js","mtime":1645609201000},{"path":"C:\\Users\\AlexisAnohVianneyANI\\Desktop\\emarket-main\\shop\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1664720015241},{"path":"C:\\Users\\AlexisAnohVianneyANI\\Desktop\\emarket-main\\shop\\node_modules\\babel-loader\\lib\\index.js","mtime":1665053040434},{"path":"C:\\Users\\AlexisAnohVianneyANI\\Desktop\\emarket-main\\shop\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1664720015241},{"path":"C:\\Users\\AlexisAnohVianneyANI\\Desktop\\emarket-main\\shop\\node_modules\\vue-loader\\lib\\index.js","mtime":1665053078023}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCBBdXRoZW50aWNhdGlvblNlcnZpY2UgZnJvbSAiQC9zZXJ2aWNlcy9BdXRoZW50aWNhdGlvblNlcnZpY2UuanMiOwppbXBvcnQgVG9wSGVhZGVyIGZyb20gIkAvY29tcG9uZW50cy9Db21tb24vVG9wSGVhZGVyLnZ1ZSI7CmltcG9ydCBSZXFQYXNzVG9rZW4gZnJvbSAiQC9jb21wb25lbnRzL1VzZXIvUmVxUGFzc1Rva2VuLnZ1ZSI7CmltcG9ydCBGb290ZXIgZnJvbSAiQC9jb21wb25lbnRzL0NvbW1vbi9Gb290ZXIudnVlIjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJMb2dpbiIsCiAgY29tcG9uZW50czogewogICAgVG9wSGVhZGVyLAogICAgUmVxUGFzc1Rva2VuLAogICAgRm9vdGVyCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZW1haWw6IG51bGwsCiAgICAgIHBhc3N3b3JkOiBudWxsLAogICAgICBlbWFpbFZhbGlkYXRpb246IG51bGwsCiAgICAgIGludmFsaWRFbWFpbE1lc3NhZ2U6ICIiLAogICAgICBsb2dpbk1lc3NhZ2U6IG51bGwsCiAgICAgIGxvZ2luQWxlcnQ6IGZhbHNlCiAgICB9OwogIH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuJHJlZnMuZW1haWxGaWVsZC5mb2N1cygpOwogIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgbG9naW4oKSB7CiAgICAgIHZhciB1c2VyOwogICAgICB0cnkgewogICAgICAgIHVzZXIgPSAoYXdhaXQgQXV0aGVudGljYXRpb25TZXJ2aWNlLmNoZWNrUmVnc1Rva2VuKHsKICAgICAgICAgIGVtYWlsOiB0aGlzLmVtYWlsCiAgICAgICAgfSkpLmRhdGE7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5sb2coZXJyb3IucmVzcG9uc2UuZGF0YS5lcnJvcik7CiAgICAgICAgdGhpcy5lbWFpbFZhbGlkYXRpb24gPSBmYWxzZTsKICAgICAgICB0aGlzLmludmFsaWRFbWFpbE1lc3NhZ2UgPSBlcnJvci5yZXNwb25zZS5kYXRhLmVycm9yOwogICAgICB9CiAgICAgIGlmICghdXNlci52ZXJpZmljYXRpb25TdGF0dXMpIHsKICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgiQ3VycmVudFVzZXIvc2V0TmV3VXNlcklkIiwgdXNlci5pZCk7CiAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goIkN1cnJlbnRVc2VyL3NldE5ld1VzZXJFbWFpbCIsIHRoaXMuZW1haWwpOwogICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgIHBhdGg6ICIvdXNlci12ZXJpZnkiCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSAoYXdhaXQgQXV0aGVudGljYXRpb25TZXJ2aWNlLmxvZ2luKHsKICAgICAgICAgIGVtYWlsOiB0aGlzLmVtYWlsLAogICAgICAgICAgcGFzc3dvcmQ6IHRoaXMucGFzc3dvcmQKICAgICAgICB9KSkuZGF0YTsKICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgiQ3VycmVudFVzZXIvc2V0VG9rZW4iLCByZXNwb25zZS50b2tlbik7CiAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goIkN1cnJlbnRVc2VyL3NldFVzZXIiLCByZXNwb25zZS51c2VyKTsKICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgiV2lzaGxpc3Qvc2V0V2lzaGxpc3QiKTsKICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICBwYXRoOiAiLyIKICAgICAgICB9KTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICB0aGlzLmxvZ2luQWxlcnQgPSB0cnVlOwogICAgICAgIHRoaXMubG9naW5NZXNzYWdlID0gZXJyb3IucmVzcG9uc2UuZGF0YS5lcnJvcjsKICAgICAgfQogICAgfQogIH0KfTs="},{"version":3,"mappings":";AAyFA;AACA;AACA;AACA;AACA;EACAA;EACAC;IACAC;IACAC;IACAC;EACA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACA;EACA;EACAC;IACA;MACA;MACA;QACAC,QACA;UACAR;QACA,IACAD;MACA;QACAU;QACA;QACA;MACA;MACA;QACA;QACA;QACA;UAAAC;QAAA;QACA;MACA;MAEA;QACA,kBACA;UACAV;UACAC;QACA,IACAF;QACA;QACA;QACA;QACA;UAAAW;QAAA;MACA;QACA;QACA;MACA;IACA;EACA;AACA","names":["name","components","TopHeader","ReqPassToken","Footer","data","email","password","emailValidation","invalidEmailMessage","loginMessage","loginAlert","mounted","methods","user","console","path"],"sourceRoot":"src/views/User","sources":["Login.vue"],"sourcesContent":["<template>\n  <div>\n    <TopHeader />\n    <b-container class=\"mt-5\">\n      <b-row align-h=\"center\">\n        <b-col cols=\"10\" md=\"7\" lg=\"5\">\n          <b-card style=\"color: #001e5f\">\n            <h4 class=\"font-weight-bold\">Connectez vous</h4>\n            <b-form @submit.stop.prevent=\"login\" class=\"mt-4\">\n              <b-form-group\n                id=\"input-group-email\"\n                label=\"Email\"\n                label-for=\"input-email\"\n              >\n                <b-form-input\n                  v-model=\"email\"\n                  id=\"input-email\"\n                  type=\"email\"\n                  ref=\"emailField\"\n                  :state=\"emailValidation\"\n                  required\n                />\n                <b-form-invalid-feedback :state=\"emailValidation\">\n                  {{ invalidEmailMessage }}\n                </b-form-invalid-feedback>\n              </b-form-group>\n\n              <b-form-group\n                id=\"input-group-password\"\n                label=\"Mot de passe\"\n                label-for=\"input-password\"\n              >\n                <b-form-input\n                  v-model=\"password\"\n                  id=\"input-password\"\n                  type=\"password\"\n                  required\n                />\n              </b-form-group>\n              <b-alert\n                variant=\"primary\"\n                class=\"my-2 p-1 pl-2\"\n                :show=\"loginAlert\"\n              >\n                {{ loginMessage }}\n              </b-alert>\n              <b-row>\n                <b-col cols=\"3\" />\n                <b-col cols=\"6\">\n                  <b-button\n                    block\n                    class=\"p-2 mt-2\"\n                    type=\"submit\"\n                    variant=\"warning\"\n                  >\n                   Se connecter\n                  </b-button>\n                </b-col>\n                <b-col cols=\"3\" />\n              </b-row>\n            </b-form>\n            <b-row class=\"mt-2\">\n              <b-col class=\"text-center\">\n                <small>\n                  <b-link v-b-toggle.request-password-token>\n                    Mot de passe oublier ?\n                  </b-link>\n                </small>\n              </b-col>\n            </b-row>\n            <b-collapse id=\"request-password-token\">\n              <ReqPassToken />\n            </b-collapse>\n            <hr />\n            <b-row>\n              <b-col class=\"text-center\">\n                Nouveau client ?&nbsp;\n                <b-link to=\"/register\">Cr√©er votre compte</b-link>\n              </b-col>\n            </b-row>\n          </b-card>\n        </b-col>\n      </b-row>\n    </b-container>\n    <Footer class=\"mt-5\" />\n  </div>\n</template>\n\n<script>\nimport AuthenticationService from \"@/services/AuthenticationService.js\";\nimport TopHeader from \"@/components/Common/TopHeader.vue\";\nimport ReqPassToken from \"@/components/User/ReqPassToken.vue\";\nimport Footer from \"@/components/Common/Footer.vue\";\nexport default {\n  name: \"Login\",\n  components: {\n    TopHeader,\n    ReqPassToken,\n    Footer\n  },\n  data() {\n    return {\n      email: null,\n      password: null,\n      emailValidation: null,\n      invalidEmailMessage: \"\",\n      loginMessage: null,\n      loginAlert: false\n    };\n  },\n  mounted() {\n    this.$refs.emailField.focus();\n  },\n  methods: {\n    async login() {\n      var user;\n      try {\n        user = (\n          await AuthenticationService.checkRegsToken({\n            email: this.email\n          })\n        ).data;\n      } catch (error) {\n        console.log(error.response.data.error);\n        this.emailValidation = false;\n        this.invalidEmailMessage = error.response.data.error;\n      }\n      if (!user.verificationStatus) {\n        this.$store.dispatch(\"CurrentUser/setNewUserId\", user.id);\n        this.$store.dispatch(\"CurrentUser/setNewUserEmail\", this.email);\n        this.$router.push({ path: \"/user-verify\" });\n        return;\n      }\n\n      try {\n        const response = (\n          await AuthenticationService.login({\n            email: this.email,\n            password: this.password\n          })\n        ).data;\n        this.$store.dispatch(\"CurrentUser/setToken\", response.token);\n        this.$store.dispatch(\"CurrentUser/setUser\", response.user);\n        this.$store.dispatch(\"Wishlist/setWishlist\");\n        this.$router.push({ path: \"/\" });\n      } catch (error) {\n        this.loginAlert = true;\n        this.loginMessage = error.response.data.error;\n      }\n    }\n  }\n};\n</script>\n\n<style scoped lang=\"scss\"></style>\n"]}]}