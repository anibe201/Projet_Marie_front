{"remainingRequest":"C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\node_modules\\primevue\\inputnumber\\InputNumber.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\node_modules\\primevue\\inputnumber\\InputNumber.vue","mtime":1664720011518},{"path":"C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\babel.config.js","mtime":1645609201000},{"path":"C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1664720015241},{"path":"C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\node_modules\\babel-loader\\lib\\index.js","mtime":1665053040434},{"path":"C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1664720015241},{"path":"C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\node_modules\\vue-loader\\lib\\index.js","mtime":1665053078023}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IElucHV0VGV4dCBmcm9tICcuLi9pbnB1dHRleHQvSW5wdXRUZXh0JzsKaW1wb3J0IEJ1dHRvbiBmcm9tICcuLi9idXR0b24vQnV0dG9uJzsKZXhwb3J0IGRlZmF1bHQgewogIGluaGVyaXRBdHRyczogZmFsc2UsCiAgcHJvcHM6IHsKICAgIHZhbHVlOiB7CiAgICAgIHR5cGU6IE51bWJlciwKICAgICAgZGVmYXVsdDogbnVsbAogICAgfSwKICAgIGZvcm1hdDogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0OiB0cnVlCiAgICB9LAogICAgc2hvd0J1dHRvbnM6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogZmFsc2UKICAgIH0sCiAgICBidXR0b25MYXlvdXQ6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiAnc3RhY2tlZCcKICAgIH0sCiAgICBpbmNyZW1lbnRCdXR0b25DbGFzczogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6IG51bGwKICAgIH0sCiAgICBkZWNyZW1lbnRCdXR0b25DbGFzczogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6IG51bGwKICAgIH0sCiAgICBpbmNyZW1lbnRCdXR0b25JY29uOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogJ3BpIHBpLWFuZ2xlLXVwJwogICAgfSwKICAgIGRlY3JlbWVudEJ1dHRvbkljb246IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiAncGkgcGktYW5nbGUtZG93bicKICAgIH0sCiAgICBsb2NhbGU6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiB1bmRlZmluZWQKICAgIH0sCiAgICBsb2NhbGVNYXRjaGVyOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogdW5kZWZpbmVkCiAgICB9LAogICAgbW9kZTogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICdkZWNpbWFsJwogICAgfSwKICAgIHByZWZpeDogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6IG51bGwKICAgIH0sCiAgICBzdWZmaXg6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiBudWxsCiAgICB9LAogICAgY3VycmVuY3k6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiB1bmRlZmluZWQKICAgIH0sCiAgICBjdXJyZW5jeURpc3BsYXk6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiB1bmRlZmluZWQKICAgIH0sCiAgICB1c2VHcm91cGluZzogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0OiB0cnVlCiAgICB9LAogICAgbWluRnJhY3Rpb25EaWdpdHM6IHsKICAgICAgdHlwZTogTnVtYmVyLAogICAgICBkZWZhdWx0OiB1bmRlZmluZWQKICAgIH0sCiAgICBtYXhGcmFjdGlvbkRpZ2l0czogewogICAgICB0eXBlOiBOdW1iZXIsCiAgICAgIGRlZmF1bHQ6IHVuZGVmaW5lZAogICAgfSwKICAgIG1pbjogewogICAgICB0eXBlOiBOdW1iZXIsCiAgICAgIGRlZmF1bHQ6IG51bGwKICAgIH0sCiAgICBtYXg6IHsKICAgICAgdHlwZTogTnVtYmVyLAogICAgICBkZWZhdWx0OiBudWxsCiAgICB9LAogICAgc3RlcDogewogICAgICB0eXBlOiBOdW1iZXIsCiAgICAgIGRlZmF1bHQ6IDEKICAgIH0sCiAgICBhbGxvd0VtcHR5OiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IHRydWUKICAgIH0sCiAgICBzdHlsZXM6IG51bGwsCiAgICBjbGFzc05hbWU6IG51bGwsCiAgICBpbnB1dFN0eWxlOiBudWxsLAogICAgaW5wdXRDbGFzczogbnVsbAogIH0sCiAgbnVtYmVyRm9ybWF0OiBudWxsLAogIF9udW1lcmFsOiBudWxsLAogIF9kZWNpbWFsOiBudWxsLAogIF9ncm91cDogbnVsbCwKICBfbWludXNTaWduOiBudWxsLAogIF9jdXJyZW5jeTogbnVsbCwKICBfc3VmZml4OiBudWxsLAogIF9wcmVmaXg6IG51bGwsCiAgX2luZGV4OiBudWxsLAogIGdyb3VwQ2hhcjogJycsCiAgaXNTcGVjaWFsQ2hhcjogbnVsbCwKICBwcmVmaXhDaGFyOiBudWxsLAogIHN1ZmZpeENoYXI6IG51bGwsCiAgdGltZXI6IG51bGwsCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGRfdmFsdWU6IG51bGwsCiAgICAgIGZvY3VzZWQ6IGZhbHNlCiAgICB9OwogIH0sCiAgd2F0Y2g6IHsKICAgIHZhbHVlKG5ld1ZhbHVlKSB7CiAgICAgIHRoaXMuZF92YWx1ZSA9IG5ld1ZhbHVlOwogICAgfSwKICAgIGxvY2FsZShuZXdWYWx1ZSwgb2xkVmFsdWUpIHsKICAgICAgdGhpcy51cGRhdGVDb25zdHJ1Y3RQYXJzZXIobmV3VmFsdWUsIG9sZFZhbHVlKTsKICAgIH0sCiAgICBsb2NhbGVNYXRjaGVyKG5ld1ZhbHVlLCBvbGRWYWx1ZSkgewogICAgICB0aGlzLnVwZGF0ZUNvbnN0cnVjdFBhcnNlcihuZXdWYWx1ZSwgb2xkVmFsdWUpOwogICAgfSwKICAgIG1vZGUobmV3VmFsdWUsIG9sZFZhbHVlKSB7CiAgICAgIHRoaXMudXBkYXRlQ29uc3RydWN0UGFyc2VyKG5ld1ZhbHVlLCBvbGRWYWx1ZSk7CiAgICB9LAogICAgY3VycmVuY3kobmV3VmFsdWUsIG9sZFZhbHVlKSB7CiAgICAgIHRoaXMudXBkYXRlQ29uc3RydWN0UGFyc2VyKG5ld1ZhbHVlLCBvbGRWYWx1ZSk7CiAgICB9LAogICAgY3VycmVuY3lEaXNwbGF5KG5ld1ZhbHVlLCBvbGRWYWx1ZSkgewogICAgICB0aGlzLnVwZGF0ZUNvbnN0cnVjdFBhcnNlcihuZXdWYWx1ZSwgb2xkVmFsdWUpOwogICAgfSwKICAgIHVzZUdyb3VwaW5nKG5ld1ZhbHVlLCBvbGRWYWx1ZSkgewogICAgICB0aGlzLnVwZGF0ZUNvbnN0cnVjdFBhcnNlcihuZXdWYWx1ZSwgb2xkVmFsdWUpOwogICAgfSwKICAgIG1pbkZyYWN0aW9uRGlnaXRzKG5ld1ZhbHVlLCBvbGRWYWx1ZSkgewogICAgICB0aGlzLnVwZGF0ZUNvbnN0cnVjdFBhcnNlcihuZXdWYWx1ZSwgb2xkVmFsdWUpOwogICAgfSwKICAgIG1heEZyYWN0aW9uRGlnaXRzKG5ld1ZhbHVlLCBvbGRWYWx1ZSkgewogICAgICB0aGlzLnVwZGF0ZUNvbnN0cnVjdFBhcnNlcihuZXdWYWx1ZSwgb2xkVmFsdWUpOwogICAgfSwKICAgIHN1ZmZpeChuZXdWYWx1ZSwgb2xkVmFsdWUpIHsKICAgICAgdGhpcy51cGRhdGVDb25zdHJ1Y3RQYXJzZXIobmV3VmFsdWUsIG9sZFZhbHVlKTsKICAgIH0sCiAgICBwcmVmaXgobmV3VmFsdWUsIG9sZFZhbHVlKSB7CiAgICAgIHRoaXMudXBkYXRlQ29uc3RydWN0UGFyc2VyKG5ld1ZhbHVlLCBvbGRWYWx1ZSk7CiAgICB9CiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5jb25zdHJ1Y3RQYXJzZXIoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGdldE9wdGlvbnMoKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgbG9jYWxlTWF0Y2hlcjogdGhpcy5sb2NhbGVNYXRjaGVyLAogICAgICAgIHN0eWxlOiB0aGlzLm1vZGUsCiAgICAgICAgY3VycmVuY3k6IHRoaXMuY3VycmVuY3ksCiAgICAgICAgY3VycmVuY3lEaXNwbGF5OiB0aGlzLmN1cnJlbmN5RGlzcGxheSwKICAgICAgICB1c2VHcm91cGluZzogdGhpcy51c2VHcm91cGluZywKICAgICAgICBtaW5pbXVtRnJhY3Rpb25EaWdpdHM6IHRoaXMubWluRnJhY3Rpb25EaWdpdHMsCiAgICAgICAgbWF4aW11bUZyYWN0aW9uRGlnaXRzOiB0aGlzLm1heEZyYWN0aW9uRGlnaXRzCiAgICAgIH07CiAgICB9LAogICAgY29uc3RydWN0UGFyc2VyKCkgewogICAgICB0aGlzLm51bWJlckZvcm1hdCA9IG5ldyBJbnRsLk51bWJlckZvcm1hdCh0aGlzLmxvY2FsZSwgdGhpcy5nZXRPcHRpb25zKCkpOwogICAgICBjb25zdCBudW1lcmFscyA9IFsuLi5uZXcgSW50bC5OdW1iZXJGb3JtYXQodGhpcy5sb2NhbGUsIHsKICAgICAgICB1c2VHcm91cGluZzogZmFsc2UKICAgICAgfSkuZm9ybWF0KDk4NzY1NDMyMTApXS5yZXZlcnNlKCk7CiAgICAgIGNvbnN0IGluZGV4ID0gbmV3IE1hcChudW1lcmFscy5tYXAoKGQsIGkpID0+IFtkLCBpXSkpOwogICAgICB0aGlzLl9udW1lcmFsID0gbmV3IFJlZ0V4cChgWyR7bnVtZXJhbHMuam9pbignJyl9XWAsICdnJyk7CiAgICAgIHRoaXMuX2dyb3VwID0gdGhpcy5nZXRHcm91cGluZ0V4cHJlc3Npb24oKTsKICAgICAgdGhpcy5fbWludXNTaWduID0gdGhpcy5nZXRNaW51c1NpZ25FeHByZXNzaW9uKCk7CiAgICAgIHRoaXMuX2N1cnJlbmN5ID0gdGhpcy5nZXRDdXJyZW5jeUV4cHJlc3Npb24oKTsKICAgICAgdGhpcy5fZGVjaW1hbCA9IHRoaXMuZ2V0RGVjaW1hbEV4cHJlc3Npb24oKTsKICAgICAgdGhpcy5fc3VmZml4ID0gdGhpcy5nZXRTdWZmaXhFeHByZXNzaW9uKCk7CiAgICAgIHRoaXMuX3ByZWZpeCA9IHRoaXMuZ2V0UHJlZml4RXhwcmVzc2lvbigpOwogICAgICB0aGlzLl9pbmRleCA9IGQgPT4gaW5kZXguZ2V0KGQpOwogICAgfSwKICAgIHVwZGF0ZUNvbnN0cnVjdFBhcnNlcihuZXdWYWx1ZSwgb2xkVmFsdWUpIHsKICAgICAgaWYgKG5ld1ZhbHVlICE9PSBvbGRWYWx1ZSkgewogICAgICAgIHRoaXMuY29uc3RydWN0UGFyc2VyKCk7CiAgICAgIH0KICAgIH0sCiAgICBlc2NhcGVSZWdFeHAodGV4dCkgewogICAgICByZXR1cm4gdGV4dC5yZXBsYWNlKC9bLVtcXXt9KCkqKz8uLFxcXiR8I1xzXS9nLCAnXFwkJicpOwogICAgfSwKICAgIGdldERlY2ltYWxFeHByZXNzaW9uKCkgewogICAgICBjb25zdCBmb3JtYXR0ZXIgPSBuZXcgSW50bC5OdW1iZXJGb3JtYXQodGhpcy5sb2NhbGUsIHsKICAgICAgICAuLi50aGlzLmdldE9wdGlvbnMoKSwKICAgICAgICB1c2VHcm91cGluZzogZmFsc2UKICAgICAgfSk7CiAgICAgIHJldHVybiBuZXcgUmVnRXhwKGBbJHtmb3JtYXR0ZXIuZm9ybWF0KDEuMSkucmVwbGFjZSh0aGlzLl9jdXJyZW5jeSwgJycpLnRyaW0oKS5yZXBsYWNlKHRoaXMuX251bWVyYWwsICcnKX1dYCwgJ2cnKTsKICAgIH0sCiAgICBnZXRHcm91cGluZ0V4cHJlc3Npb24oKSB7CiAgICAgIGNvbnN0IGZvcm1hdHRlciA9IG5ldyBJbnRsLk51bWJlckZvcm1hdCh0aGlzLmxvY2FsZSwgewogICAgICAgIHVzZUdyb3VwaW5nOiB0cnVlCiAgICAgIH0pOwogICAgICB0aGlzLmdyb3VwQ2hhciA9IGZvcm1hdHRlci5mb3JtYXQoMTAwMDAwMCkudHJpbSgpLnJlcGxhY2UodGhpcy5fbnVtZXJhbCwgJycpLmNoYXJBdCgwKTsKICAgICAgcmV0dXJuIG5ldyBSZWdFeHAoYFske3RoaXMuZ3JvdXBDaGFyfV1gLCAnZycpOwogICAgfSwKICAgIGdldE1pbnVzU2lnbkV4cHJlc3Npb24oKSB7CiAgICAgIGNvbnN0IGZvcm1hdHRlciA9IG5ldyBJbnRsLk51bWJlckZvcm1hdCh0aGlzLmxvY2FsZSwgewogICAgICAgIHVzZUdyb3VwaW5nOiBmYWxzZQogICAgICB9KTsKICAgICAgcmV0dXJuIG5ldyBSZWdFeHAoYFske2Zvcm1hdHRlci5mb3JtYXQoLTEpLnRyaW0oKS5yZXBsYWNlKHRoaXMuX251bWVyYWwsICcnKX1dYCwgJ2cnKTsKICAgIH0sCiAgICBnZXRDdXJyZW5jeUV4cHJlc3Npb24oKSB7CiAgICAgIGlmICh0aGlzLmN1cnJlbmN5KSB7CiAgICAgICAgY29uc3QgZm9ybWF0dGVyID0gbmV3IEludGwuTnVtYmVyRm9ybWF0KHRoaXMubG9jYWxlLCB7CiAgICAgICAgICBzdHlsZTogJ2N1cnJlbmN5JywKICAgICAgICAgIGN1cnJlbmN5OiB0aGlzLmN1cnJlbmN5LAogICAgICAgICAgY3VycmVuY3lEaXNwbGF5OiB0aGlzLmN1cnJlbmN5RGlzcGxheSwKICAgICAgICAgIG1pbmltdW1GcmFjdGlvbkRpZ2l0czogMCwKICAgICAgICAgIG1heGltdW1GcmFjdGlvbkRpZ2l0czogMAogICAgICAgIH0pOwogICAgICAgIHJldHVybiBuZXcgUmVnRXhwKGBbJHtmb3JtYXR0ZXIuZm9ybWF0KDEpLnJlcGxhY2UoL1xzL2csICcnKS5yZXBsYWNlKHRoaXMuX251bWVyYWwsICcnKS5yZXBsYWNlKHRoaXMuX2dyb3VwLCAnJyl9XWAsICdnJyk7CiAgICAgIH0KICAgICAgcmV0dXJuIG5ldyBSZWdFeHAoYFtdYCwgJ2cnKTsKICAgIH0sCiAgICBnZXRQcmVmaXhFeHByZXNzaW9uKCkgewogICAgICBpZiAodGhpcy5wcmVmaXgpIHsKICAgICAgICB0aGlzLnByZWZpeENoYXIgPSB0aGlzLnByZWZpeDsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCBmb3JtYXR0ZXIgPSBuZXcgSW50bC5OdW1iZXJGb3JtYXQodGhpcy5sb2NhbGUsIHsKICAgICAgICAgIHN0eWxlOiB0aGlzLm1vZGUsCiAgICAgICAgICBjdXJyZW5jeTogdGhpcy5jdXJyZW5jeSwKICAgICAgICAgIGN1cnJlbmN5RGlzcGxheTogdGhpcy5jdXJyZW5jeURpc3BsYXkKICAgICAgICB9KTsKICAgICAgICB0aGlzLnByZWZpeENoYXIgPSBmb3JtYXR0ZXIuZm9ybWF0KDEpLnNwbGl0KCcxJylbMF07CiAgICAgIH0KICAgICAgcmV0dXJuIG5ldyBSZWdFeHAoYCR7dGhpcy5lc2NhcGVSZWdFeHAodGhpcy5wcmVmaXhDaGFyIHx8ICcnKX1gLCAnZycpOwogICAgfSwKICAgIGdldFN1ZmZpeEV4cHJlc3Npb24oKSB7CiAgICAgIGlmICh0aGlzLnN1ZmZpeCkgewogICAgICAgIHRoaXMuc3VmZml4Q2hhciA9IHRoaXMuc3VmZml4OwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnN0IGZvcm1hdHRlciA9IG5ldyBJbnRsLk51bWJlckZvcm1hdCh0aGlzLmxvY2FsZSwgewogICAgICAgICAgc3R5bGU6IHRoaXMubW9kZSwKICAgICAgICAgIGN1cnJlbmN5OiB0aGlzLmN1cnJlbmN5LAogICAgICAgICAgY3VycmVuY3lEaXNwbGF5OiB0aGlzLmN1cnJlbmN5RGlzcGxheSwKICAgICAgICAgIG1pbmltdW1GcmFjdGlvbkRpZ2l0czogMCwKICAgICAgICAgIG1heGltdW1GcmFjdGlvbkRpZ2l0czogMAogICAgICAgIH0pOwogICAgICAgIHRoaXMuc3VmZml4Q2hhciA9IGZvcm1hdHRlci5mb3JtYXQoMSkuc3BsaXQoJzEnKVsxXTsKICAgICAgfQogICAgICByZXR1cm4gbmV3IFJlZ0V4cChgJHt0aGlzLmVzY2FwZVJlZ0V4cCh0aGlzLnN1ZmZpeENoYXIgfHwgJycpfWAsICdnJyk7CiAgICB9LAogICAgZm9ybWF0VmFsdWUodmFsdWUpIHsKICAgICAgaWYgKHZhbHVlICE9IG51bGwpIHsKICAgICAgICBpZiAodmFsdWUgPT09ICctJykgewogICAgICAgICAgLy8gTWludXMgc2lnbgogICAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICAgIH0KICAgICAgICBpZiAodGhpcy5mb3JtYXQpIHsKICAgICAgICAgIGxldCBmb3JtYXR0ZXIgPSBuZXcgSW50bC5OdW1iZXJGb3JtYXQodGhpcy5sb2NhbGUsIHRoaXMuZ2V0T3B0aW9ucygpKTsKICAgICAgICAgIGxldCBmb3JtYXR0ZWRWYWx1ZSA9IGZvcm1hdHRlci5mb3JtYXQodmFsdWUpOwogICAgICAgICAgaWYgKHRoaXMucHJlZml4KSB7CiAgICAgICAgICAgIGZvcm1hdHRlZFZhbHVlID0gdGhpcy5wcmVmaXggKyBmb3JtYXR0ZWRWYWx1ZTsKICAgICAgICAgIH0KICAgICAgICAgIGlmICh0aGlzLnN1ZmZpeCkgewogICAgICAgICAgICBmb3JtYXR0ZWRWYWx1ZSA9IGZvcm1hdHRlZFZhbHVlICsgdGhpcy5zdWZmaXg7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gZm9ybWF0dGVkVmFsdWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiB2YWx1ZS50b1N0cmluZygpOwogICAgICB9CiAgICAgIHJldHVybiAnJzsKICAgIH0sCiAgICBwYXJzZVZhbHVlKHRleHQpIHsKICAgICAgbGV0IGZpbHRlcmVkVGV4dCA9IHRleHQucmVwbGFjZSh0aGlzLl9zdWZmaXgsICcnKS5yZXBsYWNlKHRoaXMuX3ByZWZpeCwgJycpLnRyaW0oKS5yZXBsYWNlKC9ccy9nLCAnJykucmVwbGFjZSh0aGlzLl9jdXJyZW5jeSwgJycpLnJlcGxhY2UodGhpcy5fZ3JvdXAsICcnKS5yZXBsYWNlKHRoaXMuX21pbnVzU2lnbiwgJy0nKS5yZXBsYWNlKHRoaXMuX2RlY2ltYWwsICcuJykucmVwbGFjZSh0aGlzLl9udW1lcmFsLCB0aGlzLl9pbmRleCk7CiAgICAgIGlmIChmaWx0ZXJlZFRleHQpIHsKICAgICAgICBpZiAoZmlsdGVyZWRUZXh0ID09PSAnLScpCiAgICAgICAgICAvLyBNaW51cyBzaWduCiAgICAgICAgICByZXR1cm4gZmlsdGVyZWRUZXh0OwogICAgICAgIGxldCBwYXJzZWRWYWx1ZSA9ICtmaWx0ZXJlZFRleHQ7CiAgICAgICAgcmV0dXJuIGlzTmFOKHBhcnNlZFZhbHVlKSA/IG51bGwgOiBwYXJzZWRWYWx1ZTsKICAgICAgfQogICAgICByZXR1cm4gbnVsbDsKICAgIH0sCiAgICByZXBlYXQoZXZlbnQsIGludGVydmFsLCBkaXIpIHsKICAgICAgbGV0IGkgPSBpbnRlcnZhbCB8fCA1MDA7CiAgICAgIHRoaXMuY2xlYXJUaW1lcigpOwogICAgICB0aGlzLnRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgdGhpcy5yZXBlYXQoZXZlbnQsIDQwLCBkaXIpOwogICAgICB9LCBpKTsKICAgICAgdGhpcy5zcGluKGV2ZW50LCBkaXIpOwogICAgfSwKICAgIHNwaW4oZXZlbnQsIGRpcikgewogICAgICBpZiAodGhpcy4kcmVmcy5pbnB1dCkgewogICAgICAgIGxldCBzdGVwID0gdGhpcy5zdGVwICogZGlyOwogICAgICAgIGxldCBjdXJyZW50VmFsdWUgPSB0aGlzLnBhcnNlVmFsdWUodGhpcy4kcmVmcy5pbnB1dC4kZWwudmFsdWUpIHx8IDA7CiAgICAgICAgbGV0IG5ld1ZhbHVlID0gdGhpcy52YWxpZGF0ZVZhbHVlKGN1cnJlbnRWYWx1ZSArIHN0ZXApOwogICAgICAgIHRoaXMudXBkYXRlSW5wdXQobmV3VmFsdWUsIG51bGwsICdzcGluJyk7CiAgICAgICAgdGhpcy51cGRhdGVNb2RlbChldmVudCwgbmV3VmFsdWUpOwogICAgICAgIHRoaXMuaGFuZGxlT25JbnB1dChldmVudCwgY3VycmVudFZhbHVlLCBuZXdWYWx1ZSk7CiAgICAgIH0KICAgIH0sCiAgICBvblVwQnV0dG9uTW91c2VEb3duKGV2ZW50KSB7CiAgICAgIGlmICghdGhpcy4kYXR0cnMuZGlzYWJsZWQpIHsKICAgICAgICB0aGlzLiRyZWZzLmlucHV0LiRlbC5mb2N1cygpOwogICAgICAgIHRoaXMucmVwZWF0KGV2ZW50LCBudWxsLCAxKTsKICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICB9CiAgICB9LAogICAgb25VcEJ1dHRvbk1vdXNlVXAoKSB7CiAgICAgIGlmICghdGhpcy4kYXR0cnMuZGlzYWJsZWQpIHsKICAgICAgICB0aGlzLmNsZWFyVGltZXIoKTsKICAgICAgfQogICAgfSwKICAgIG9uVXBCdXR0b25Nb3VzZUxlYXZlKCkgewogICAgICBpZiAoIXRoaXMuJGF0dHJzLmRpc2FibGVkKSB7CiAgICAgICAgdGhpcy5jbGVhclRpbWVyKCk7CiAgICAgIH0KICAgIH0sCiAgICBvblVwQnV0dG9uS2V5VXAoKSB7CiAgICAgIGlmICghdGhpcy4kYXR0cnMuZGlzYWJsZWQpIHsKICAgICAgICB0aGlzLmNsZWFyVGltZXIoKTsKICAgICAgfQogICAgfSwKICAgIG9uVXBCdXR0b25LZXlEb3duKGV2ZW50KSB7CiAgICAgIGlmIChldmVudC5rZXlDb2RlID09PSAzMiB8fCBldmVudC5rZXlDb2RlID09PSAxMykgewogICAgICAgIHRoaXMucmVwZWF0KGV2ZW50LCBudWxsLCAxKTsKICAgICAgfQogICAgfSwKICAgIG9uRG93bkJ1dHRvbk1vdXNlRG93bihldmVudCkgewogICAgICBpZiAoIXRoaXMuJGF0dHJzLmRpc2FibGVkKSB7CiAgICAgICAgdGhpcy4kcmVmcy5pbnB1dC4kZWwuZm9jdXMoKTsKICAgICAgICB0aGlzLnJlcGVhdChldmVudCwgbnVsbCwgLTEpOwogICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgIH0KICAgIH0sCiAgICBvbkRvd25CdXR0b25Nb3VzZVVwKCkgewogICAgICBpZiAoIXRoaXMuJGF0dHJzLmRpc2FibGVkKSB7CiAgICAgICAgdGhpcy5jbGVhclRpbWVyKCk7CiAgICAgIH0KICAgIH0sCiAgICBvbkRvd25CdXR0b25Nb3VzZUxlYXZlKCkgewogICAgICBpZiAoIXRoaXMuJGF0dHJzLmRpc2FibGVkKSB7CiAgICAgICAgdGhpcy5jbGVhclRpbWVyKCk7CiAgICAgIH0KICAgIH0sCiAgICBvbkRvd25CdXR0b25LZXlVcCgpIHsKICAgICAgaWYgKCF0aGlzLiRhdHRycy5kaXNhYmxlZCkgewogICAgICAgIHRoaXMuY2xlYXJUaW1lcigpOwogICAgICB9CiAgICB9LAogICAgb25Eb3duQnV0dG9uS2V5RG93bihldmVudCkgewogICAgICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMzIgfHwgZXZlbnQua2V5Q29kZSA9PT0gMTMpIHsKICAgICAgICB0aGlzLnJlcGVhdChldmVudCwgbnVsbCwgLTEpOwogICAgICB9CiAgICB9LAogICAgb25Vc2VySW5wdXQoKSB7CiAgICAgIGlmICh0aGlzLmlzU3BlY2lhbENoYXIpIHsKICAgICAgICB0aGlzLiRyZWZzLmlucHV0LiRlbC52YWx1ZSA9IHRoaXMubGFzdFZhbHVlOwogICAgICB9CiAgICAgIHRoaXMuaXNTcGVjaWFsQ2hhciA9IGZhbHNlOwogICAgfSwKICAgIG9uSW5wdXRLZXlEb3duKGV2ZW50KSB7CiAgICAgIHRoaXMubGFzdFZhbHVlID0gZXZlbnQudGFyZ2V0LnZhbHVlOwogICAgICBpZiAoZXZlbnQuc2hpZnRLZXkgfHwgZXZlbnQuYWx0S2V5KSB7CiAgICAgICAgdGhpcy5pc1NwZWNpYWxDaGFyID0gdHJ1ZTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgbGV0IHNlbGVjdGlvblN0YXJ0ID0gZXZlbnQudGFyZ2V0LnNlbGVjdGlvblN0YXJ0OwogICAgICBsZXQgc2VsZWN0aW9uRW5kID0gZXZlbnQudGFyZ2V0LnNlbGVjdGlvbkVuZDsKICAgICAgbGV0IGlucHV0VmFsdWUgPSBldmVudC50YXJnZXQudmFsdWU7CiAgICAgIGxldCBuZXdWYWx1ZVN0ciA9IG51bGw7CiAgICAgIGlmIChldmVudC5hbHRLZXkpIHsKICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICB9CiAgICAgIHN3aXRjaCAoZXZlbnQud2hpY2gpIHsKICAgICAgICAvL3VwCiAgICAgICAgY2FzZSAzODoKICAgICAgICAgIHRoaXMuc3BpbihldmVudCwgMSk7CiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIC8vZG93bgogICAgICAgIGNhc2UgNDA6CiAgICAgICAgICB0aGlzLnNwaW4oZXZlbnQsIC0xKTsKICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgLy9sZWZ0CiAgICAgICAgY2FzZSAzNzoKICAgICAgICAgIGlmICghdGhpcy5pc051bWVyYWxDaGFyKGlucHV0VmFsdWUuY2hhckF0KHNlbGVjdGlvblN0YXJ0IC0gMSkpKSB7CiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKCiAgICAgICAgLy9yaWdodAogICAgICAgIGNhc2UgMzk6CiAgICAgICAgICBpZiAoIXRoaXMuaXNOdW1lcmFsQ2hhcihpbnB1dFZhbHVlLmNoYXJBdChzZWxlY3Rpb25TdGFydCkpKSB7CiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKCiAgICAgICAgLy9lbnRlcgogICAgICAgIGNhc2UgMTM6CiAgICAgICAgICBuZXdWYWx1ZVN0ciA9IHRoaXMudmFsaWRhdGVWYWx1ZSh0aGlzLnBhcnNlVmFsdWUoaW5wdXRWYWx1ZSkpOwogICAgICAgICAgdGhpcy4kcmVmcy5pbnB1dC4kZWwudmFsdWUgPSB0aGlzLmZvcm1hdFZhbHVlKG5ld1ZhbHVlU3RyKTsKICAgICAgICAgIHRoaXMuJHJlZnMuaW5wdXQuJGVsLnNldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW5vdycsIG5ld1ZhbHVlU3RyKTsKICAgICAgICAgIHRoaXMudXBkYXRlTW9kZWwoZXZlbnQsIG5ld1ZhbHVlU3RyKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICAvL2JhY2tzcGFjZQogICAgICAgIGNhc2UgODoKICAgICAgICAgIHsKICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgaWYgKHNlbGVjdGlvblN0YXJ0ID09PSBzZWxlY3Rpb25FbmQpIHsKICAgICAgICAgICAgICBjb25zdCBkZWxldGVDaGFyID0gaW5wdXRWYWx1ZS5jaGFyQXQoc2VsZWN0aW9uU3RhcnQgLSAxKTsKICAgICAgICAgICAgICBjb25zdCB7CiAgICAgICAgICAgICAgICBkZWNpbWFsQ2hhckluZGV4LAogICAgICAgICAgICAgICAgZGVjaW1hbENoYXJJbmRleFdpdGhvdXRQcmVmaXgKICAgICAgICAgICAgICB9ID0gdGhpcy5nZXREZWNpbWFsQ2hhckluZGV4ZXMoaW5wdXRWYWx1ZSk7CiAgICAgICAgICAgICAgaWYgKHRoaXMuaXNOdW1lcmFsQ2hhcihkZWxldGVDaGFyKSkgewogICAgICAgICAgICAgICAgY29uc3QgZGVjaW1hbExlbmd0aCA9IHRoaXMuZ2V0RGVjaW1hbExlbmd0aChpbnB1dFZhbHVlKTsKICAgICAgICAgICAgICAgIGlmICh0aGlzLl9ncm91cC50ZXN0KGRlbGV0ZUNoYXIpKSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuX2dyb3VwLmxhc3RJbmRleCA9IDA7CiAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlU3RyID0gaW5wdXRWYWx1ZS5zbGljZSgwLCBzZWxlY3Rpb25TdGFydCAtIDIpICsgaW5wdXRWYWx1ZS5zbGljZShzZWxlY3Rpb25TdGFydCAtIDEpOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9kZWNpbWFsLnRlc3QoZGVsZXRlQ2hhcikpIHsKICAgICAgICAgICAgICAgICAgdGhpcy5fZGVjaW1hbC5sYXN0SW5kZXggPSAwOwogICAgICAgICAgICAgICAgICBpZiAoZGVjaW1hbExlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuJHJlZnMuaW5wdXQuJGVsLnNldFNlbGVjdGlvblJhbmdlKHNlbGVjdGlvblN0YXJ0IC0gMSwgc2VsZWN0aW9uU3RhcnQgLSAxKTsKICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBuZXdWYWx1ZVN0ciA9IGlucHV0VmFsdWUuc2xpY2UoMCwgc2VsZWN0aW9uU3RhcnQgLSAxKSArIGlucHV0VmFsdWUuc2xpY2Uoc2VsZWN0aW9uU3RhcnQpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGRlY2ltYWxDaGFySW5kZXggPiAwICYmIHNlbGVjdGlvblN0YXJ0ID4gZGVjaW1hbENoYXJJbmRleCkgewogICAgICAgICAgICAgICAgICBjb25zdCBpbnNlcnRlZFRleHQgPSB0aGlzLmlzRGVjaW1hbE1vZGUoKSAmJiAodGhpcy5taW5GcmFjdGlvbkRpZ2l0cyB8fCAwKSA8IGRlY2ltYWxMZW5ndGggPyAnJyA6ICcwJzsKICAgICAgICAgICAgICAgICAgbmV3VmFsdWVTdHIgPSBpbnB1dFZhbHVlLnNsaWNlKDAsIHNlbGVjdGlvblN0YXJ0IC0gMSkgKyBpbnNlcnRlZFRleHQgKyBpbnB1dFZhbHVlLnNsaWNlKHNlbGVjdGlvblN0YXJ0KTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZGVjaW1hbENoYXJJbmRleFdpdGhvdXRQcmVmaXggPT09IDEpIHsKICAgICAgICAgICAgICAgICAgbmV3VmFsdWVTdHIgPSBpbnB1dFZhbHVlLnNsaWNlKDAsIHNlbGVjdGlvblN0YXJ0IC0gMSkgKyAnMCcgKyBpbnB1dFZhbHVlLnNsaWNlKHNlbGVjdGlvblN0YXJ0KTsKICAgICAgICAgICAgICAgICAgbmV3VmFsdWVTdHIgPSB0aGlzLnBhcnNlVmFsdWUobmV3VmFsdWVTdHIpID4gMCA/IG5ld1ZhbHVlU3RyIDogJyc7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBuZXdWYWx1ZVN0ciA9IGlucHV0VmFsdWUuc2xpY2UoMCwgc2VsZWN0aW9uU3RhcnQgLSAxKSArIGlucHV0VmFsdWUuc2xpY2Uoc2VsZWN0aW9uU3RhcnQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVZhbHVlKGV2ZW50LCBuZXdWYWx1ZVN0ciwgbnVsbCwgJ2RlbGV0ZS1zaW5nbGUnKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBuZXdWYWx1ZVN0ciA9IHRoaXMuZGVsZXRlUmFuZ2UoaW5wdXRWYWx1ZSwgc2VsZWN0aW9uU3RhcnQsIHNlbGVjdGlvbkVuZCk7CiAgICAgICAgICAgICAgdGhpcy51cGRhdGVWYWx1ZShldmVudCwgbmV3VmFsdWVTdHIsIG51bGwsICdkZWxldGUtcmFuZ2UnKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgLy8gZGVsCiAgICAgICAgY2FzZSA0NjoKICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICBpZiAoc2VsZWN0aW9uU3RhcnQgPT09IHNlbGVjdGlvbkVuZCkgewogICAgICAgICAgICBjb25zdCBkZWxldGVDaGFyID0gaW5wdXRWYWx1ZS5jaGFyQXQoc2VsZWN0aW9uU3RhcnQpOwogICAgICAgICAgICBjb25zdCB7CiAgICAgICAgICAgICAgZGVjaW1hbENoYXJJbmRleCwKICAgICAgICAgICAgICBkZWNpbWFsQ2hhckluZGV4V2l0aG91dFByZWZpeAogICAgICAgICAgICB9ID0gdGhpcy5nZXREZWNpbWFsQ2hhckluZGV4ZXMoaW5wdXRWYWx1ZSk7CiAgICAgICAgICAgIGlmICh0aGlzLmlzTnVtZXJhbENoYXIoZGVsZXRlQ2hhcikpIHsKICAgICAgICAgICAgICBjb25zdCBkZWNpbWFsTGVuZ3RoID0gdGhpcy5nZXREZWNpbWFsTGVuZ3RoKGlucHV0VmFsdWUpOwogICAgICAgICAgICAgIGlmICh0aGlzLl9ncm91cC50ZXN0KGRlbGV0ZUNoYXIpKSB7CiAgICAgICAgICAgICAgICB0aGlzLl9ncm91cC5sYXN0SW5kZXggPSAwOwogICAgICAgICAgICAgICAgbmV3VmFsdWVTdHIgPSBpbnB1dFZhbHVlLnNsaWNlKDAsIHNlbGVjdGlvblN0YXJ0KSArIGlucHV0VmFsdWUuc2xpY2Uoc2VsZWN0aW9uU3RhcnQgKyAyKTsKICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX2RlY2ltYWwudGVzdChkZWxldGVDaGFyKSkgewogICAgICAgICAgICAgICAgdGhpcy5fZGVjaW1hbC5sYXN0SW5kZXggPSAwOwogICAgICAgICAgICAgICAgaWYgKGRlY2ltYWxMZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgdGhpcy4kcmVmcy5pbnB1dC4kZWwuc2V0U2VsZWN0aW9uUmFuZ2Uoc2VsZWN0aW9uU3RhcnQgKyAxLCBzZWxlY3Rpb25TdGFydCArIDEpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgbmV3VmFsdWVTdHIgPSBpbnB1dFZhbHVlLnNsaWNlKDAsIHNlbGVjdGlvblN0YXJ0KSArIGlucHV0VmFsdWUuc2xpY2Uoc2VsZWN0aW9uU3RhcnQgKyAxKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGVsc2UgaWYgKGRlY2ltYWxDaGFySW5kZXggPiAwICYmIHNlbGVjdGlvblN0YXJ0ID4gZGVjaW1hbENoYXJJbmRleCkgewogICAgICAgICAgICAgICAgY29uc3QgaW5zZXJ0ZWRUZXh0ID0gdGhpcy5pc0RlY2ltYWxNb2RlKCkgJiYgKHRoaXMubWluRnJhY3Rpb25EaWdpdHMgfHwgMCkgPCBkZWNpbWFsTGVuZ3RoID8gJycgOiAnMCc7CiAgICAgICAgICAgICAgICBuZXdWYWx1ZVN0ciA9IGlucHV0VmFsdWUuc2xpY2UoMCwgc2VsZWN0aW9uU3RhcnQpICsgaW5zZXJ0ZWRUZXh0ICsgaW5wdXRWYWx1ZS5zbGljZShzZWxlY3Rpb25TdGFydCArIDEpOwogICAgICAgICAgICAgIH0gZWxzZSBpZiAoZGVjaW1hbENoYXJJbmRleFdpdGhvdXRQcmVmaXggPT09IDEpIHsKICAgICAgICAgICAgICAgIG5ld1ZhbHVlU3RyID0gaW5wdXRWYWx1ZS5zbGljZSgwLCBzZWxlY3Rpb25TdGFydCkgKyAnMCcgKyBpbnB1dFZhbHVlLnNsaWNlKHNlbGVjdGlvblN0YXJ0ICsgMSk7CiAgICAgICAgICAgICAgICBuZXdWYWx1ZVN0ciA9IHRoaXMucGFyc2VWYWx1ZShuZXdWYWx1ZVN0cikgPiAwID8gbmV3VmFsdWVTdHIgOiAnJzsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbmV3VmFsdWVTdHIgPSBpbnB1dFZhbHVlLnNsaWNlKDAsIHNlbGVjdGlvblN0YXJ0KSArIGlucHV0VmFsdWUuc2xpY2Uoc2VsZWN0aW9uU3RhcnQgKyAxKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy51cGRhdGVWYWx1ZShldmVudCwgbmV3VmFsdWVTdHIsIG51bGwsICdkZWxldGUtYmFjay1zaW5nbGUnKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG5ld1ZhbHVlU3RyID0gdGhpcy5kZWxldGVSYW5nZShpbnB1dFZhbHVlLCBzZWxlY3Rpb25TdGFydCwgc2VsZWN0aW9uRW5kKTsKICAgICAgICAgICAgdGhpcy51cGRhdGVWYWx1ZShldmVudCwgbmV3VmFsdWVTdHIsIG51bGwsICdkZWxldGUtcmFuZ2UnKTsKICAgICAgICAgIH0KICAgICAgICAgIGJyZWFrOwogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICBicmVhazsKICAgICAgfQogICAgfSwKICAgIG9uSW5wdXRLZXlVcChldmVudCkgewogICAgICB0aGlzLiRlbWl0KCdrZXl1cCcsIGV2ZW50KTsKICAgIH0sCiAgICBvbklucHV0S2V5UHJlc3MoZXZlbnQpIHsKICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgbGV0IGNvZGUgPSBldmVudC53aGljaCB8fCBldmVudC5rZXlDb2RlOwogICAgICBsZXQgY2hhciA9IFN0cmluZy5mcm9tQ2hhckNvZGUoY29kZSk7CiAgICAgIGNvbnN0IGlzRGVjaW1hbFNpZ24gPSB0aGlzLmlzRGVjaW1hbFNpZ24oY2hhcik7CiAgICAgIGNvbnN0IGlzTWludXNTaWduID0gdGhpcy5pc01pbnVzU2lnbihjaGFyKTsKICAgICAgaWYgKDQ4IDw9IGNvZGUgJiYgY29kZSA8PSA1NyB8fCBpc01pbnVzU2lnbiB8fCBpc0RlY2ltYWxTaWduKSB7CiAgICAgICAgdGhpcy5pbnNlcnQoZXZlbnQsIGNoYXIsIHsKICAgICAgICAgIGlzRGVjaW1hbFNpZ24sCiAgICAgICAgICBpc01pbnVzU2lnbgogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgb25QYXN0ZShldmVudCkgewogICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBsZXQgZGF0YSA9IChldmVudC5jbGlwYm9hcmREYXRhIHx8IHdpbmRvd1snY2xpcGJvYXJkRGF0YSddKS5nZXREYXRhKCdUZXh0Jyk7CiAgICAgIGlmIChkYXRhKSB7CiAgICAgICAgbGV0IGZpbHRlcmVkRGF0YSA9IHRoaXMucGFyc2VWYWx1ZShkYXRhKTsKICAgICAgICBpZiAoZmlsdGVyZWREYXRhICE9IG51bGwpIHsKICAgICAgICAgIHRoaXMuaW5zZXJ0KGV2ZW50LCBmaWx0ZXJlZERhdGEudG9TdHJpbmcoKSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgYWxsb3dNaW51c1NpZ24oKSB7CiAgICAgIHJldHVybiB0aGlzLm1pbiA9PT0gbnVsbCB8fCB0aGlzLm1pbiA8IDA7CiAgICB9LAogICAgaXNNaW51c1NpZ24oY2hhcikgewogICAgICBpZiAodGhpcy5fbWludXNTaWduLnRlc3QoY2hhcikgfHwgY2hhciA9PT0gJy0nKSB7CiAgICAgICAgdGhpcy5fbWludXNTaWduLmxhc3RJbmRleCA9IDA7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSwKICAgIGlzRGVjaW1hbFNpZ24oY2hhcikgewogICAgICBpZiAodGhpcy5fZGVjaW1hbC50ZXN0KGNoYXIpKSB7CiAgICAgICAgdGhpcy5fZGVjaW1hbC5sYXN0SW5kZXggPSAwOwogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0sCiAgICBpc0RlY2ltYWxNb2RlKCkgewogICAgICByZXR1cm4gdGhpcy5tb2RlID09PSAnZGVjaW1hbCc7CiAgICB9LAogICAgZ2V0RGVjaW1hbENoYXJJbmRleGVzKHZhbCkgewogICAgICBsZXQgZGVjaW1hbENoYXJJbmRleCA9IHZhbC5zZWFyY2godGhpcy5fZGVjaW1hbCk7CiAgICAgIHRoaXMuX2RlY2ltYWwubGFzdEluZGV4ID0gMDsKICAgICAgY29uc3QgZmlsdGVyZWRWYWwgPSB2YWwucmVwbGFjZSh0aGlzLl9wcmVmaXgsICcnKS50cmltKCkucmVwbGFjZSgvXHMvZywgJycpLnJlcGxhY2UodGhpcy5fY3VycmVuY3ksICcnKTsKICAgICAgY29uc3QgZGVjaW1hbENoYXJJbmRleFdpdGhvdXRQcmVmaXggPSBmaWx0ZXJlZFZhbC5zZWFyY2godGhpcy5fZGVjaW1hbCk7CiAgICAgIHRoaXMuX2RlY2ltYWwubGFzdEluZGV4ID0gMDsKICAgICAgcmV0dXJuIHsKICAgICAgICBkZWNpbWFsQ2hhckluZGV4LAogICAgICAgIGRlY2ltYWxDaGFySW5kZXhXaXRob3V0UHJlZml4CiAgICAgIH07CiAgICB9LAogICAgZ2V0Q2hhckluZGV4ZXModmFsKSB7CiAgICAgIGNvbnN0IGRlY2ltYWxDaGFySW5kZXggPSB2YWwuc2VhcmNoKHRoaXMuX2RlY2ltYWwpOwogICAgICB0aGlzLl9kZWNpbWFsLmxhc3RJbmRleCA9IDA7CiAgICAgIGNvbnN0IG1pbnVzQ2hhckluZGV4ID0gdmFsLnNlYXJjaCh0aGlzLl9taW51c1NpZ24pOwogICAgICB0aGlzLl9taW51c1NpZ24ubGFzdEluZGV4ID0gMDsKICAgICAgY29uc3Qgc3VmZml4Q2hhckluZGV4ID0gdmFsLnNlYXJjaCh0aGlzLl9zdWZmaXgpOwogICAgICB0aGlzLl9zdWZmaXgubGFzdEluZGV4ID0gMDsKICAgICAgY29uc3QgY3VycmVuY3lDaGFySW5kZXggPSB2YWwuc2VhcmNoKHRoaXMuX2N1cnJlbmN5KTsKICAgICAgdGhpcy5fY3VycmVuY3kubGFzdEluZGV4ID0gMDsKICAgICAgcmV0dXJuIHsKICAgICAgICBkZWNpbWFsQ2hhckluZGV4LAogICAgICAgIG1pbnVzQ2hhckluZGV4LAogICAgICAgIHN1ZmZpeENoYXJJbmRleCwKICAgICAgICBjdXJyZW5jeUNoYXJJbmRleAogICAgICB9OwogICAgfSwKICAgIGluc2VydChldmVudCwgdGV4dCwgc2lnbiA9IHsKICAgICAgaXNEZWNpbWFsU2lnbjogZmFsc2UsCiAgICAgIGlzTWludXNTaWduOiBmYWxzZQogICAgfSkgewogICAgICBjb25zdCBtaW51c0NoYXJJbmRleE9uVGV4dCA9IHRleHQuc2VhcmNoKHRoaXMuX21pbnVzU2lnbik7CiAgICAgIHRoaXMuX21pbnVzU2lnbi5sYXN0SW5kZXggPSAwOwogICAgICBpZiAoIXRoaXMuYWxsb3dNaW51c1NpZ24oKSAmJiBtaW51c0NoYXJJbmRleE9uVGV4dCAhPT0gLTEpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgY29uc3Qgc2VsZWN0aW9uU3RhcnQgPSB0aGlzLiRyZWZzLmlucHV0LiRlbC5zZWxlY3Rpb25TdGFydDsKICAgICAgY29uc3Qgc2VsZWN0aW9uRW5kID0gdGhpcy4kcmVmcy5pbnB1dC4kZWwuc2VsZWN0aW9uRW5kOwogICAgICBsZXQgaW5wdXRWYWx1ZSA9IHRoaXMuJHJlZnMuaW5wdXQuJGVsLnZhbHVlLnRyaW0oKTsKICAgICAgY29uc3QgewogICAgICAgIGRlY2ltYWxDaGFySW5kZXgsCiAgICAgICAgbWludXNDaGFySW5kZXgsCiAgICAgICAgc3VmZml4Q2hhckluZGV4LAogICAgICAgIGN1cnJlbmN5Q2hhckluZGV4CiAgICAgIH0gPSB0aGlzLmdldENoYXJJbmRleGVzKGlucHV0VmFsdWUpOwogICAgICBsZXQgbmV3VmFsdWVTdHI7CiAgICAgIGlmIChzaWduLmlzTWludXNTaWduKSB7CiAgICAgICAgaWYgKHNlbGVjdGlvblN0YXJ0ID09PSAwKSB7CiAgICAgICAgICBuZXdWYWx1ZVN0ciA9IGlucHV0VmFsdWU7CiAgICAgICAgICBpZiAobWludXNDaGFySW5kZXggPT09IC0xIHx8IHNlbGVjdGlvbkVuZCAhPT0gMCkgewogICAgICAgICAgICBuZXdWYWx1ZVN0ciA9IHRoaXMuaW5zZXJ0VGV4dChpbnB1dFZhbHVlLCB0ZXh0LCAwLCBzZWxlY3Rpb25FbmQpOwogICAgICAgICAgfQogICAgICAgICAgdGhpcy51cGRhdGVWYWx1ZShldmVudCwgbmV3VmFsdWVTdHIsIHRleHQsICdpbnNlcnQnKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoc2lnbi5pc0RlY2ltYWxTaWduKSB7CiAgICAgICAgaWYgKGRlY2ltYWxDaGFySW5kZXggPiAwICYmIHNlbGVjdGlvblN0YXJ0ID09PSBkZWNpbWFsQ2hhckluZGV4KSB7CiAgICAgICAgICB0aGlzLnVwZGF0ZVZhbHVlKGV2ZW50LCBpbnB1dFZhbHVlLCB0ZXh0LCAnaW5zZXJ0Jyk7CiAgICAgICAgfSBlbHNlIGlmIChkZWNpbWFsQ2hhckluZGV4ID4gc2VsZWN0aW9uU3RhcnQgJiYgZGVjaW1hbENoYXJJbmRleCA8IHNlbGVjdGlvbkVuZCkgewogICAgICAgICAgbmV3VmFsdWVTdHIgPSB0aGlzLmluc2VydFRleHQoaW5wdXRWYWx1ZSwgdGV4dCwgc2VsZWN0aW9uU3RhcnQsIHNlbGVjdGlvbkVuZCk7CiAgICAgICAgICB0aGlzLnVwZGF0ZVZhbHVlKGV2ZW50LCBuZXdWYWx1ZVN0ciwgdGV4dCwgJ2luc2VydCcpOwogICAgICAgIH0gZWxzZSBpZiAoZGVjaW1hbENoYXJJbmRleCA9PT0gLTEgJiYgdGhpcy5tYXhGcmFjdGlvbkRpZ2l0cykgewogICAgICAgICAgbmV3VmFsdWVTdHIgPSB0aGlzLmluc2VydFRleHQoaW5wdXRWYWx1ZSwgdGV4dCwgc2VsZWN0aW9uU3RhcnQsIHNlbGVjdGlvbkVuZCk7CiAgICAgICAgICB0aGlzLnVwZGF0ZVZhbHVlKGV2ZW50LCBuZXdWYWx1ZVN0ciwgdGV4dCwgJ2luc2VydCcpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCBtYXhGcmFjdGlvbkRpZ2l0cyA9IHRoaXMubnVtYmVyRm9ybWF0LnJlc29sdmVkT3B0aW9ucygpLm1heGltdW1GcmFjdGlvbkRpZ2l0czsKICAgICAgICBjb25zdCBvcGVyYXRpb24gPSBzZWxlY3Rpb25TdGFydCAhPT0gc2VsZWN0aW9uRW5kID8gJ3JhbmdlLWluc2VydCcgOiAnaW5zZXJ0JzsKICAgICAgICBpZiAoZGVjaW1hbENoYXJJbmRleCA+IDAgJiYgc2VsZWN0aW9uU3RhcnQgPiBkZWNpbWFsQ2hhckluZGV4KSB7CiAgICAgICAgICBpZiAoc2VsZWN0aW9uU3RhcnQgKyB0ZXh0Lmxlbmd0aCAtIChkZWNpbWFsQ2hhckluZGV4ICsgMSkgPD0gbWF4RnJhY3Rpb25EaWdpdHMpIHsKICAgICAgICAgICAgY29uc3QgY2hhckluZGV4ID0gY3VycmVuY3lDaGFySW5kZXggPj0gc2VsZWN0aW9uU3RhcnQgPyBjdXJyZW5jeUNoYXJJbmRleCAtIDEgOiBzdWZmaXhDaGFySW5kZXggPj0gc2VsZWN0aW9uU3RhcnQgPyBzdWZmaXhDaGFySW5kZXggOiBpbnB1dFZhbHVlLmxlbmd0aDsKICAgICAgICAgICAgbmV3VmFsdWVTdHIgPSBpbnB1dFZhbHVlLnNsaWNlKDAsIHNlbGVjdGlvblN0YXJ0KSArIHRleHQgKyBpbnB1dFZhbHVlLnNsaWNlKHNlbGVjdGlvblN0YXJ0ICsgdGV4dC5sZW5ndGgsIGNoYXJJbmRleCkgKyBpbnB1dFZhbHVlLnNsaWNlKGNoYXJJbmRleCk7CiAgICAgICAgICAgIHRoaXMudXBkYXRlVmFsdWUoZXZlbnQsIG5ld1ZhbHVlU3RyLCB0ZXh0LCBvcGVyYXRpb24pOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBuZXdWYWx1ZVN0ciA9IHRoaXMuaW5zZXJ0VGV4dChpbnB1dFZhbHVlLCB0ZXh0LCBzZWxlY3Rpb25TdGFydCwgc2VsZWN0aW9uRW5kKTsKICAgICAgICAgIHRoaXMudXBkYXRlVmFsdWUoZXZlbnQsIG5ld1ZhbHVlU3RyLCB0ZXh0LCBvcGVyYXRpb24pOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGluc2VydFRleHQodmFsdWUsIHRleHQsIHN0YXJ0LCBlbmQpIHsKICAgICAgbGV0IHRleHRTcGxpdCA9IHRleHQgPT09ICcuJyA/IHRleHQgOiB0ZXh0LnNwbGl0KCcuJyk7CiAgICAgIGlmICh0ZXh0U3BsaXQubGVuZ3RoID09PSAyKSB7CiAgICAgICAgY29uc3QgZGVjaW1hbENoYXJJbmRleCA9IHZhbHVlLnNsaWNlKHN0YXJ0LCBlbmQpLnNlYXJjaCh0aGlzLl9kZWNpbWFsKTsKICAgICAgICB0aGlzLl9kZWNpbWFsLmxhc3RJbmRleCA9IDA7CiAgICAgICAgcmV0dXJuIGRlY2ltYWxDaGFySW5kZXggPiAwID8gdmFsdWUuc2xpY2UoMCwgc3RhcnQpICsgdGhpcy5mb3JtYXRWYWx1ZSh0ZXh0KSArIHZhbHVlLnNsaWNlKGVuZCkgOiB2YWx1ZSB8fCB0aGlzLmZvcm1hdFZhbHVlKHRleHQpOwogICAgICB9IGVsc2UgaWYgKGVuZCAtIHN0YXJ0ID09PSB2YWx1ZS5sZW5ndGgpIHsKICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXRWYWx1ZSh0ZXh0KTsKICAgICAgfSBlbHNlIGlmIChzdGFydCA9PT0gMCkgewogICAgICAgIHJldHVybiB0ZXh0ICsgdmFsdWUuc2xpY2UoZW5kKTsKICAgICAgfSBlbHNlIGlmIChlbmQgPT09IHZhbHVlLmxlbmd0aCkgewogICAgICAgIHJldHVybiB2YWx1ZS5zbGljZSgwLCBzdGFydCkgKyB0ZXh0OwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiB2YWx1ZS5zbGljZSgwLCBzdGFydCkgKyB0ZXh0ICsgdmFsdWUuc2xpY2UoZW5kKTsKICAgICAgfQogICAgfSwKICAgIGRlbGV0ZVJhbmdlKHZhbHVlLCBzdGFydCwgZW5kKSB7CiAgICAgIGxldCBuZXdWYWx1ZVN0cjsKICAgICAgaWYgKGVuZCAtIHN0YXJ0ID09PSB2YWx1ZS5sZW5ndGgpIG5ld1ZhbHVlU3RyID0gJyc7ZWxzZSBpZiAoc3RhcnQgPT09IDApIG5ld1ZhbHVlU3RyID0gdmFsdWUuc2xpY2UoZW5kKTtlbHNlIGlmIChlbmQgPT09IHZhbHVlLmxlbmd0aCkgbmV3VmFsdWVTdHIgPSB2YWx1ZS5zbGljZSgwLCBzdGFydCk7ZWxzZSBuZXdWYWx1ZVN0ciA9IHZhbHVlLnNsaWNlKDAsIHN0YXJ0KSArIHZhbHVlLnNsaWNlKGVuZCk7CiAgICAgIHJldHVybiBuZXdWYWx1ZVN0cjsKICAgIH0sCiAgICBpbml0Q3Vyc29yKCkgewogICAgICBsZXQgc2VsZWN0aW9uU3RhcnQgPSB0aGlzLiRyZWZzLmlucHV0LiRlbC5zZWxlY3Rpb25TdGFydDsKICAgICAgbGV0IGlucHV0VmFsdWUgPSB0aGlzLiRyZWZzLmlucHV0LiRlbC52YWx1ZTsKICAgICAgbGV0IHZhbHVlTGVuZ3RoID0gaW5wdXRWYWx1ZS5sZW5ndGg7CiAgICAgIGxldCBpbmRleCA9IG51bGw7CgogICAgICAvLyByZW1vdmUgcHJlZml4CiAgICAgIGxldCBwcmVmaXhMZW5ndGggPSAodGhpcy5wcmVmaXhDaGFyIHx8ICcnKS5sZW5ndGg7CiAgICAgIGlucHV0VmFsdWUgPSBpbnB1dFZhbHVlLnJlcGxhY2UodGhpcy5fcHJlZml4LCAnJyk7CiAgICAgIHNlbGVjdGlvblN0YXJ0ID0gc2VsZWN0aW9uU3RhcnQgLSBwcmVmaXhMZW5ndGg7CiAgICAgIGxldCBjaGFyID0gaW5wdXRWYWx1ZS5jaGFyQXQoc2VsZWN0aW9uU3RhcnQpOwogICAgICBpZiAodGhpcy5pc051bWVyYWxDaGFyKGNoYXIpKSB7CiAgICAgICAgcmV0dXJuIHNlbGVjdGlvblN0YXJ0ICsgcHJlZml4TGVuZ3RoOwogICAgICB9CgogICAgICAvL2xlZnQKICAgICAgbGV0IGkgPSBzZWxlY3Rpb25TdGFydCAtIDE7CiAgICAgIHdoaWxlIChpID49IDApIHsKICAgICAgICBjaGFyID0gaW5wdXRWYWx1ZS5jaGFyQXQoaSk7CiAgICAgICAgaWYgKHRoaXMuaXNOdW1lcmFsQ2hhcihjaGFyKSkgewogICAgICAgICAgaW5kZXggPSBpICsgcHJlZml4TGVuZ3RoOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGktLTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKGluZGV4ICE9PSBudWxsKSB7CiAgICAgICAgdGhpcy4kcmVmcy5pbnB1dC4kZWwuc2V0U2VsZWN0aW9uUmFuZ2UoaW5kZXggKyAxLCBpbmRleCArIDEpOwogICAgICB9IGVsc2UgewogICAgICAgIGkgPSBzZWxlY3Rpb25TdGFydDsKICAgICAgICB3aGlsZSAoaSA8IHZhbHVlTGVuZ3RoKSB7CiAgICAgICAgICBjaGFyID0gaW5wdXRWYWx1ZS5jaGFyQXQoaSk7CiAgICAgICAgICBpZiAodGhpcy5pc051bWVyYWxDaGFyKGNoYXIpKSB7CiAgICAgICAgICAgIGluZGV4ID0gaSArIHByZWZpeExlbmd0aDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpKys7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChpbmRleCAhPT0gbnVsbCkgewogICAgICAgICAgdGhpcy4kcmVmcy5pbnB1dC4kZWwuc2V0U2VsZWN0aW9uUmFuZ2UoaW5kZXgsIGluZGV4KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIGluZGV4IHx8IDA7CiAgICB9LAogICAgb25JbnB1dENsaWNrKCkgewogICAgICB0aGlzLmluaXRDdXJzb3IoKTsKICAgIH0sCiAgICBpc051bWVyYWxDaGFyKGNoYXIpIHsKICAgICAgaWYgKGNoYXIubGVuZ3RoID09PSAxICYmICh0aGlzLl9udW1lcmFsLnRlc3QoY2hhcikgfHwgdGhpcy5fZGVjaW1hbC50ZXN0KGNoYXIpIHx8IHRoaXMuX2dyb3VwLnRlc3QoY2hhcikgfHwgdGhpcy5fbWludXNTaWduLnRlc3QoY2hhcikpKSB7CiAgICAgICAgdGhpcy5yZXNldFJlZ2V4KCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSwKICAgIHJlc2V0UmVnZXgoKSB7CiAgICAgIHRoaXMuX251bWVyYWwubGFzdEluZGV4ID0gMDsKICAgICAgdGhpcy5fZGVjaW1hbC5sYXN0SW5kZXggPSAwOwogICAgICB0aGlzLl9ncm91cC5sYXN0SW5kZXggPSAwOwogICAgICB0aGlzLl9taW51c1NpZ24ubGFzdEluZGV4ID0gMDsKICAgIH0sCiAgICB1cGRhdGVWYWx1ZShldmVudCwgdmFsdWVTdHIsIGluc2VydGVkVmFsdWVTdHIsIG9wZXJhdGlvbikgewogICAgICBsZXQgY3VycmVudFZhbHVlID0gdGhpcy4kcmVmcy5pbnB1dC4kZWwudmFsdWU7CiAgICAgIGxldCBuZXdWYWx1ZSA9IG51bGw7CiAgICAgIGlmICh2YWx1ZVN0ciAhPSBudWxsKSB7CiAgICAgICAgbmV3VmFsdWUgPSB0aGlzLnBhcnNlVmFsdWUodmFsdWVTdHIpOwogICAgICAgIG5ld1ZhbHVlID0gIW5ld1ZhbHVlICYmICF0aGlzLmFsbG93RW1wdHkgPyAwIDogbmV3VmFsdWU7CiAgICAgICAgdGhpcy51cGRhdGVJbnB1dChuZXdWYWx1ZSwgaW5zZXJ0ZWRWYWx1ZVN0ciwgb3BlcmF0aW9uLCB2YWx1ZVN0cik7CiAgICAgICAgdGhpcy5oYW5kbGVPbklucHV0KGV2ZW50LCBjdXJyZW50VmFsdWUsIG5ld1ZhbHVlKTsKICAgICAgfQogICAgfSwKICAgIGhhbmRsZU9uSW5wdXQoZXZlbnQsIGN1cnJlbnRWYWx1ZSwgbmV3VmFsdWUpIHsKICAgICAgaWYgKHRoaXMuaXNWYWx1ZUNoYW5nZWQoY3VycmVudFZhbHVlLCBuZXdWYWx1ZSkpIHsKICAgICAgICB0aGlzLiRlbWl0KCdpbnB1dCcsIG5ld1ZhbHVlKTsKICAgICAgfQogICAgfSwKICAgIGlzVmFsdWVDaGFuZ2VkKGN1cnJlbnRWYWx1ZSwgbmV3VmFsdWUpIHsKICAgICAgaWYgKG5ld1ZhbHVlID09PSBudWxsICYmIGN1cnJlbnRWYWx1ZSAhPT0gbnVsbCkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICAgIGlmIChuZXdWYWx1ZSAhPSBudWxsKSB7CiAgICAgICAgbGV0IHBhcnNlZEN1cnJlbnRWYWx1ZSA9IHR5cGVvZiBjdXJyZW50VmFsdWUgPT09ICdzdHJpbmcnID8gdGhpcy5wYXJzZVZhbHVlKGN1cnJlbnRWYWx1ZSkgOiBjdXJyZW50VmFsdWU7CiAgICAgICAgcmV0dXJuIG5ld1ZhbHVlICE9PSBwYXJzZWRDdXJyZW50VmFsdWU7CiAgICAgIH0KICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSwKICAgIHZhbGlkYXRlVmFsdWUodmFsdWUpIHsKICAgICAgaWYgKHZhbHVlID09PSAnLScgfHwgdmFsdWUgPT0gbnVsbCkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICAgIGlmICh0aGlzLm1pbiAhPSBudWxsICYmIHZhbHVlIDwgdGhpcy5taW4pIHsKICAgICAgICByZXR1cm4gdGhpcy5taW47CiAgICAgIH0KICAgICAgaWYgKHRoaXMubWF4ICE9IG51bGwgJiYgdmFsdWUgPiB0aGlzLm1heCkgewogICAgICAgIHJldHVybiB0aGlzLm1heDsKICAgICAgfQogICAgICByZXR1cm4gdmFsdWU7CiAgICB9LAogICAgdXBkYXRlSW5wdXQodmFsdWUsIGluc2VydGVkVmFsdWVTdHIsIG9wZXJhdGlvbiwgdmFsdWVTdHIpIHsKICAgICAgaW5zZXJ0ZWRWYWx1ZVN0ciA9IGluc2VydGVkVmFsdWVTdHIgfHwgJyc7CiAgICAgIGxldCBpbnB1dFZhbHVlID0gdGhpcy4kcmVmcy5pbnB1dC4kZWwudmFsdWU7CiAgICAgIGxldCBuZXdWYWx1ZSA9IHRoaXMuZm9ybWF0VmFsdWUodmFsdWUpOwogICAgICBsZXQgY3VycmVudExlbmd0aCA9IGlucHV0VmFsdWUubGVuZ3RoOwogICAgICBpZiAobmV3VmFsdWUgIT09IHZhbHVlU3RyKSB7CiAgICAgICAgbmV3VmFsdWUgPSB0aGlzLmNvbmNhdFZhbHVlcyhuZXdWYWx1ZSwgdmFsdWVTdHIpOwogICAgICB9CiAgICAgIGlmIChjdXJyZW50TGVuZ3RoID09PSAwKSB7CiAgICAgICAgdGhpcy4kcmVmcy5pbnB1dC4kZWwudmFsdWUgPSBuZXdWYWx1ZTsKICAgICAgICB0aGlzLiRyZWZzLmlucHV0LiRlbC5zZXRTZWxlY3Rpb25SYW5nZSgwLCAwKTsKICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMuaW5pdEN1cnNvcigpOwogICAgICAgIGNvbnN0IHNlbGVjdGlvbkVuZCA9IGluZGV4ICsgaW5zZXJ0ZWRWYWx1ZVN0ci5sZW5ndGg7CiAgICAgICAgdGhpcy4kcmVmcy5pbnB1dC4kZWwuc2V0U2VsZWN0aW9uUmFuZ2Uoc2VsZWN0aW9uRW5kLCBzZWxlY3Rpb25FbmQpOwogICAgICB9IGVsc2UgewogICAgICAgIGxldCBzZWxlY3Rpb25TdGFydCA9IHRoaXMuJHJlZnMuaW5wdXQuJGVsLnNlbGVjdGlvblN0YXJ0OwogICAgICAgIGxldCBzZWxlY3Rpb25FbmQgPSB0aGlzLiRyZWZzLmlucHV0LiRlbC5zZWxlY3Rpb25FbmQ7CiAgICAgICAgdGhpcy4kcmVmcy5pbnB1dC4kZWwudmFsdWUgPSBuZXdWYWx1ZTsKICAgICAgICBsZXQgbmV3TGVuZ3RoID0gbmV3VmFsdWUubGVuZ3RoOwogICAgICAgIGlmIChvcGVyYXRpb24gPT09ICdyYW5nZS1pbnNlcnQnKSB7CiAgICAgICAgICBjb25zdCBzdGFydFZhbHVlID0gdGhpcy5wYXJzZVZhbHVlKChpbnB1dFZhbHVlIHx8ICcnKS5zbGljZSgwLCBzZWxlY3Rpb25TdGFydCkpOwogICAgICAgICAgY29uc3Qgc3RhcnRWYWx1ZVN0ciA9IHN0YXJ0VmFsdWUgIT09IG51bGwgPyBzdGFydFZhbHVlLnRvU3RyaW5nKCkgOiAnJzsKICAgICAgICAgIGNvbnN0IHN0YXJ0RXhwciA9IHN0YXJ0VmFsdWVTdHIuc3BsaXQoJycpLmpvaW4oYCgke3RoaXMuZ3JvdXBDaGFyfSk/YCk7CiAgICAgICAgICBjb25zdCBzUmVnZXggPSBuZXcgUmVnRXhwKHN0YXJ0RXhwciwgJ2cnKTsKICAgICAgICAgIHNSZWdleC50ZXN0KG5ld1ZhbHVlKTsKICAgICAgICAgIGNvbnN0IHRFeHByID0gaW5zZXJ0ZWRWYWx1ZVN0ci5zcGxpdCgnJykuam9pbihgKCR7dGhpcy5ncm91cENoYXJ9KT9gKTsKICAgICAgICAgIGNvbnN0IHRSZWdleCA9IG5ldyBSZWdFeHAodEV4cHIsICdnJyk7CiAgICAgICAgICB0UmVnZXgudGVzdChuZXdWYWx1ZS5zbGljZShzUmVnZXgubGFzdEluZGV4KSk7CiAgICAgICAgICBzZWxlY3Rpb25FbmQgPSBzUmVnZXgubGFzdEluZGV4ICsgdFJlZ2V4Lmxhc3RJbmRleDsKICAgICAgICAgIHRoaXMuJHJlZnMuaW5wdXQuJGVsLnNldFNlbGVjdGlvblJhbmdlKHNlbGVjdGlvbkVuZCwgc2VsZWN0aW9uRW5kKTsKICAgICAgICB9IGVsc2UgaWYgKG5ld0xlbmd0aCA9PT0gY3VycmVudExlbmd0aCkgewogICAgICAgICAgaWYgKG9wZXJhdGlvbiA9PT0gJ2luc2VydCcgfHwgb3BlcmF0aW9uID09PSAnZGVsZXRlLWJhY2stc2luZ2xlJykgdGhpcy4kcmVmcy5pbnB1dC4kZWwuc2V0U2VsZWN0aW9uUmFuZ2Uoc2VsZWN0aW9uRW5kICsgMSwgc2VsZWN0aW9uRW5kICsgMSk7ZWxzZSBpZiAob3BlcmF0aW9uID09PSAnZGVsZXRlLXNpbmdsZScpIHRoaXMuJHJlZnMuaW5wdXQuJGVsLnNldFNlbGVjdGlvblJhbmdlKHNlbGVjdGlvbkVuZCAtIDEsIHNlbGVjdGlvbkVuZCAtIDEpO2Vsc2UgaWYgKG9wZXJhdGlvbiA9PT0gJ2RlbGV0ZS1yYW5nZScgfHwgb3BlcmF0aW9uID09PSAnc3BpbicpIHRoaXMuJHJlZnMuaW5wdXQuJGVsLnNldFNlbGVjdGlvblJhbmdlKHNlbGVjdGlvbkVuZCwgc2VsZWN0aW9uRW5kKTsKICAgICAgICB9IGVsc2UgaWYgKG9wZXJhdGlvbiA9PT0gJ2RlbGV0ZS1iYWNrLXNpbmdsZScpIHsKICAgICAgICAgIGxldCBwcmV2Q2hhciA9IGlucHV0VmFsdWUuY2hhckF0KHNlbGVjdGlvbkVuZCAtIDEpOwogICAgICAgICAgbGV0IG5leHRDaGFyID0gaW5wdXRWYWx1ZS5jaGFyQXQoc2VsZWN0aW9uRW5kKTsKICAgICAgICAgIGxldCBkaWZmID0gY3VycmVudExlbmd0aCAtIG5ld0xlbmd0aDsKICAgICAgICAgIGxldCBpc0dyb3VwQ2hhciA9IHRoaXMuX2dyb3VwLnRlc3QobmV4dENoYXIpOwogICAgICAgICAgaWYgKGlzR3JvdXBDaGFyICYmIGRpZmYgPT09IDEpIHsKICAgICAgICAgICAgc2VsZWN0aW9uRW5kICs9IDE7CiAgICAgICAgICB9IGVsc2UgaWYgKCFpc0dyb3VwQ2hhciAmJiB0aGlzLmlzTnVtZXJhbENoYXIocHJldkNoYXIpKSB7CiAgICAgICAgICAgIHNlbGVjdGlvbkVuZCArPSAtMSAqIGRpZmYgKyAxOwogICAgICAgICAgfQogICAgICAgICAgdGhpcy5fZ3JvdXAubGFzdEluZGV4ID0gMDsKICAgICAgICAgIHRoaXMuJHJlZnMuaW5wdXQuJGVsLnNldFNlbGVjdGlvblJhbmdlKHNlbGVjdGlvbkVuZCwgc2VsZWN0aW9uRW5kKTsKICAgICAgICB9IGVsc2UgaWYgKGlucHV0VmFsdWUgPT09ICctJyAmJiBvcGVyYXRpb24gPT09ICdpbnNlcnQnKSB7CiAgICAgICAgICB0aGlzLiRyZWZzLmlucHV0LiRlbC5zZXRTZWxlY3Rpb25SYW5nZSgwLCAwKTsKICAgICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5pbml0Q3Vyc29yKCk7CiAgICAgICAgICBjb25zdCBzZWxlY3Rpb25FbmQgPSBpbmRleCArIGluc2VydGVkVmFsdWVTdHIubGVuZ3RoICsgMTsKICAgICAgICAgIHRoaXMuJHJlZnMuaW5wdXQuJGVsLnNldFNlbGVjdGlvblJhbmdlKHNlbGVjdGlvbkVuZCwgc2VsZWN0aW9uRW5kKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgc2VsZWN0aW9uRW5kID0gc2VsZWN0aW9uRW5kICsgKG5ld0xlbmd0aCAtIGN1cnJlbnRMZW5ndGgpOwogICAgICAgICAgdGhpcy4kcmVmcy5pbnB1dC4kZWwuc2V0U2VsZWN0aW9uUmFuZ2Uoc2VsZWN0aW9uRW5kLCBzZWxlY3Rpb25FbmQpOwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLiRyZWZzLmlucHV0LiRlbC5zZXRBdHRyaWJ1dGUoJ2FyaWEtdmFsdWVub3cnLCB2YWx1ZSk7CiAgICB9LAogICAgY29uY2F0VmFsdWVzKHZhbDEsIHZhbDIpIHsKICAgICAgaWYgKHZhbDEgJiYgdmFsMikgewogICAgICAgIGxldCBkZWNpbWFsQ2hhckluZGV4ID0gdmFsMi5zZWFyY2godGhpcy5fZGVjaW1hbCk7CiAgICAgICAgdGhpcy5fZGVjaW1hbC5sYXN0SW5kZXggPSAwOwogICAgICAgIHJldHVybiBkZWNpbWFsQ2hhckluZGV4ICE9PSAtMSA/IHZhbDEuc3BsaXQodGhpcy5fZGVjaW1hbClbMF0gKyB2YWwyLnNsaWNlKGRlY2ltYWxDaGFySW5kZXgpIDogdmFsMTsKICAgICAgfQogICAgICByZXR1cm4gdmFsMTsKICAgIH0sCiAgICBnZXREZWNpbWFsTGVuZ3RoKHZhbHVlKSB7CiAgICAgIGlmICh2YWx1ZSkgewogICAgICAgIGNvbnN0IHZhbHVlU3BsaXQgPSB2YWx1ZS5zcGxpdCh0aGlzLl9kZWNpbWFsKTsKICAgICAgICBpZiAodmFsdWVTcGxpdC5sZW5ndGggPT09IDIpIHsKICAgICAgICAgIHJldHVybiB2YWx1ZVNwbGl0WzFdLnJlcGxhY2UodGhpcy5fc3VmZml4LCAnJykudHJpbSgpLnJlcGxhY2UoL1xzL2csICcnKS5yZXBsYWNlKHRoaXMuX2N1cnJlbmN5LCAnJykubGVuZ3RoOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gMDsKICAgIH0sCiAgICB1cGRhdGVNb2RlbChldmVudCwgdmFsdWUpIHsKICAgICAgdGhpcy5kX3ZhbHVlID0gdmFsdWU7CiAgICAgIHRoaXMuJGVtaXQoJ2lucHV0JywgdmFsdWUpOwogICAgfSwKICAgIG9uSW5wdXRGb2N1cyhldmVudCkgewogICAgICB0aGlzLmZvY3VzZWQgPSB0cnVlOwogICAgICB0aGlzLiRlbWl0KCdmb2N1cycsIGV2ZW50KTsKICAgIH0sCiAgICBvbklucHV0Qmx1cihldmVudCkgewogICAgICB0aGlzLmZvY3VzZWQgPSBmYWxzZTsKICAgICAgbGV0IGlucHV0ID0gZXZlbnQudGFyZ2V0OwogICAgICBsZXQgbmV3VmFsdWUgPSB0aGlzLnZhbGlkYXRlVmFsdWUodGhpcy5wYXJzZVZhbHVlKGlucHV0LnZhbHVlKSk7CiAgICAgIGlucHV0LnZhbHVlID0gdGhpcy5mb3JtYXRWYWx1ZShuZXdWYWx1ZSk7CiAgICAgIGlucHV0LnNldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW5vdycsIG5ld1ZhbHVlKTsKICAgICAgdGhpcy51cGRhdGVNb2RlbChldmVudCwgbmV3VmFsdWUpOwogICAgICB0aGlzLiRlbWl0KCdibHVyJywgZXZlbnQpOwogICAgfSwKICAgIGNsZWFyVGltZXIoKSB7CiAgICAgIGlmICh0aGlzLnRpbWVyKSB7CiAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnRpbWVyKTsKICAgICAgfQogICAgfSwKICAgIG1heEJvdW5kcnkoKSB7CiAgICAgIHJldHVybiB0aGlzLmRfdmFsdWUgPj0gdGhpcy5tYXg7CiAgICB9LAogICAgbWluQm91bmRyeSgpIHsKICAgICAgcmV0dXJuIHRoaXMuZF92YWx1ZSA8PSB0aGlzLm1pbjsKICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICBjb250YWluZXJDbGFzcygpIHsKICAgICAgcmV0dXJuIFsncC1pbnB1dG51bWJlciBwLWNvbXBvbmVudCBwLWlucHV0d3JhcHBlcicsIHRoaXMuY2xhc3NOYW1lLCB7CiAgICAgICAgJ3AtaW5wdXR3cmFwcGVyLWZpbGxlZCc6IHRoaXMuZmlsbGVkLAogICAgICAgICdwLWlucHV0d3JhcHBlci1mb2N1cyc6IHRoaXMuZm9jdXNlZCwKICAgICAgICAncC1pbnB1dG51bWJlci1idXR0b25zLXN0YWNrZWQnOiB0aGlzLnNob3dCdXR0b25zICYmIHRoaXMuYnV0dG9uTGF5b3V0ID09PSAnc3RhY2tlZCcsCiAgICAgICAgJ3AtaW5wdXRudW1iZXItYnV0dG9ucy1ob3Jpem9udGFsJzogdGhpcy5zaG93QnV0dG9ucyAmJiB0aGlzLmJ1dHRvbkxheW91dCA9PT0gJ2hvcml6b250YWwnLAogICAgICAgICdwLWlucHV0bnVtYmVyLWJ1dHRvbnMtdmVydGljYWwnOiB0aGlzLnNob3dCdXR0b25zICYmIHRoaXMuYnV0dG9uTGF5b3V0ID09PSAndmVydGljYWwnCiAgICAgIH1dOwogICAgfSwKICAgIHVwQnV0dG9uQ2xhc3MoKSB7CiAgICAgIHJldHVybiBbJ3AtaW5wdXRudW1iZXItYnV0dG9uIHAtaW5wdXRudW1iZXItYnV0dG9uLXVwJywgdGhpcy5pbmNyZW1lbnRCdXR0b25DbGFzcywgewogICAgICAgICdwLWRpc2FibGVkJzogdGhpcy5zaG93QnV0dG9ucyAmJiB0aGlzLm1heCAhPT0gbnVsbCAmJiB0aGlzLm1heEJvdW5kcnkoKQogICAgICB9XTsKICAgIH0sCiAgICBkb3duQnV0dG9uQ2xhc3MoKSB7CiAgICAgIHJldHVybiBbJ3AtaW5wdXRudW1iZXItYnV0dG9uIHAtaW5wdXRudW1iZXItYnV0dG9uLWRvd24nLCB0aGlzLmRlY3JlbWVudEJ1dHRvbkNsYXNzLCB7CiAgICAgICAgJ3AtZGlzYWJsZWQnOiB0aGlzLnNob3dCdXR0b25zICYmIHRoaXMubWluICE9PSBudWxsICYmIHRoaXMubWluQm91bmRyeSgpCiAgICAgIH1dOwogICAgfSwKICAgIGZpbGxlZCgpIHsKICAgICAgcmV0dXJuIHRoaXMudmFsdWUgIT0gbnVsbCAmJiB0aGlzLnZhbHVlLnRvU3RyaW5nKCkubGVuZ3RoID4gMDsKICAgIH0sCiAgICB1cEJ1dHRvbkxpc3RlbmVycygpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBtb3VzZWRvd246IGV2ZW50ID0+IHRoaXMub25VcEJ1dHRvbk1vdXNlRG93bihldmVudCksCiAgICAgICAgbW91c2V1cDogZXZlbnQgPT4gdGhpcy5vblVwQnV0dG9uTW91c2VVcChldmVudCksCiAgICAgICAgbW91c2VsZWF2ZTogZXZlbnQgPT4gdGhpcy5vblVwQnV0dG9uTW91c2VMZWF2ZShldmVudCksCiAgICAgICAga2V5ZG93bjogZXZlbnQgPT4gdGhpcy5vblVwQnV0dG9uS2V5RG93bihldmVudCksCiAgICAgICAga2V5dXA6IGV2ZW50ID0+IHRoaXMub25VcEJ1dHRvbktleVVwKGV2ZW50KQogICAgICB9OwogICAgfSwKICAgIGRvd25CdXR0b25MaXN0ZW5lcnMoKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgbW91c2Vkb3duOiBldmVudCA9PiB0aGlzLm9uRG93bkJ1dHRvbk1vdXNlRG93bihldmVudCksCiAgICAgICAgbW91c2V1cDogZXZlbnQgPT4gdGhpcy5vbkRvd25CdXR0b25Nb3VzZVVwKGV2ZW50KSwKICAgICAgICBtb3VzZWxlYXZlOiBldmVudCA9PiB0aGlzLm9uRG93bkJ1dHRvbk1vdXNlTGVhdmUoZXZlbnQpLAogICAgICAgIGtleWRvd246IGV2ZW50ID0+IHRoaXMub25Eb3duQnV0dG9uS2V5RG93bihldmVudCksCiAgICAgICAga2V5dXA6IGV2ZW50ID0+IHRoaXMub25Eb3duQnV0dG9uS2V5VXAoZXZlbnQpCiAgICAgIH07CiAgICB9LAogICAgZm9ybWF0dGVkVmFsdWUoKSB7CiAgICAgIGNvbnN0IHZhbCA9ICF0aGlzLnZhbHVlICYmICF0aGlzLmFsbG93RW1wdHkgPyAwIDogdGhpcy52YWx1ZTsKICAgICAgcmV0dXJuIHRoaXMuZm9ybWF0VmFsdWUodmFsKTsKICAgIH0sCiAgICBnZXRGb3JtYXR0ZXIoKSB7CiAgICAgIHJldHVybiB0aGlzLm51bWJlckZvcm1hdDsKICAgIH0KICB9LAogIGNvbXBvbmVudHM6IHsKICAgICdJTklucHV0VGV4dCc6IElucHV0VGV4dCwKICAgICdJTkJ1dHRvbic6IEJ1dHRvbgogIH0KfTs="},{"version":3,"mappings":"AAcA;AACA;AAEA;EACAA;EACAC;IACAC;MACAC;MACAC;IACA;IACAC;MACAF;MACAC;IACA;IACAE;MACAH;MACAC;IACA;IACAG;MACAJ;MACAC;IACA;IACAI;MACAL;MACAC;IACA;IACAK;MACAN;MACAC;IACA;IACAM;MACAP;MACAC;IACA;IACAO;MACAR;MACAC;IACA;IACAQ;MACAT;MACAC;IACA;IACAS;MACAV;MACAC;IACA;IACAU;MACAX;MACAC;IACA;IACAW;MACAZ;MACAC;IACA;IACAY;MACAb;MACAC;IACA;IACAa;MACAd;MACAC;IACA;IACAc;MACAf;MACAC;IACA;IACAe;MACAhB;MACAC;IACA;IACAgB;MACAjB;MACAC;IACA;IACAiB;MACAlB;MACAC;IACA;IACAkB;MACAnB;MACAC;IACA;IACAmB;MACApB;MACAC;IACA;IACAoB;MACArB;MACAC;IACA;IACAqB;MACAtB;MACAC;IACA;IACAsB;IACAC;IACAC;IACAC;EACA;EACAC;EACAC;EACAC;EACAC;EACAC;EACAC;EACAC;EACAC;EACAC;EACAC;EACAC;EACAC;EACAC;EACAC;EACAC;IACA;MACAC;MACAC;IACA;EACA;EACAC;IACA7C;MACA;IACA;IACAU;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAG;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAL;MACA;IACA;IACAD;MACA;IACA;EACA;EACAiC;IACA;EACA;EACAC;IACAC;MACA;QACArC;QACAsC;QACAlC;QACAC;QACAC;QACAiC;QACAC;MACA;IACA;IACAC;MACA;MACA;QAAAnC;MAAA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACAoC;MACA;QACA;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;QAAA;QAAAtC;MAAA;MACA;IACA;IACAuC;MACA;QAAAvC;MAAA;MACA;MACA;IACA;IACAwC;MACA;QAAAxC;MAAA;MACA;IACA;IACAyC;MACA;QACA;UAAAT;UAAAlC;UAAAC;UACAkC;UAAAC;QAAA;QACA;MACA;MAEA;IACA;IACAQ;MACA;QACA;MACA,OACA;QACA;UAAAV;UAAAlC;UAAAC;QAAA;QACA;MACA;MAEA;IACA;IACA4C;MACA;QACA;MACA,OACA;QACA;UAAAX;UAAAlC;UAAAC;UACAkC;UAAAC;QAAA;QACA;MACA;MAEA;IACA;IACAU;MACA;QACA;UAAA;UACA;QACA;QAEA;UACA;UACA;UACA;YACAC;UACA;UAEA;YACAA;UACA;UAEA;QACA;QAEA;MACA;MAEA;IACA;IACAC;MACA,wBACAC,0BACAA,0BACAC,OACAD,mBACAA,4BACAA,yBACAA,8BACAA,4BACAA;MAEA;QACA;UAAA;UACA;QAEA;QACA;MACA;MAEA;IACA;IACAE;MACA;MAEA;MACA;QACA;MACA;MAEA;IACA;IACAC;MACA;QACA;QACA;QACA;QAEA;QACA;QAEA;MACA;IACA;IACAC;MACA;QACA;QACA;QACAC;MACA;IACA;IACAC;MACA;QACA;MACA;IACA;IACAC;MACA;QACA;MACA;IACA;IACAC;MACA;QACA;MACA;IACA;IACAC;MACA;QACA;MACA;IACA;IACAC;MACA;QACA;QACA;QACAL;MACA;IACA;IACAM;MACA;QACA;MACA;IACA;IACAC;MACA;QACA;MACA;IACA;IACAC;MACA;QACA;MACA;IACA;IACAC;MACA;QACA;MACA;IACA;IACAC;MACA;QACA;MACA;MACA;IACA;IACAC;MACA;MACA;QACA;QACA;MACA;MAEA;MACA;MACA;MACA;MAEA;QACAX;MACA;MAEA;QACA;QACA;UACA;UACAA;UACA;;QAEA;QACA;UACA;UACAA;UACA;;QAEA;QACA;UACA;YACAA;UACA;UACA;;QAEA;QACA;UACA;YACAA;UACA;UACA;;QAEA;QACA;UACAY;UACA;UACA;UACA;UACA;;QAEA;QACA;UAAA;YACAZ;YAEA;cACA;cACA;gBAAAa;gBAAAC;cAAA;cAEA;gBACA;gBAEA;kBACA;kBACAF;gBACA,OACA;kBACA;kBAEA;oBACA;kBACA,OACA;oBACAA;kBACA;gBACA,OACA;kBACA;kBACAA;gBACA,OACA;kBACAA;kBACAA;gBACA,OACA;kBACAA;gBACA;cACA;cAEA;YACA,OACA;cACAA;cACA;YACA;YAEA;UACA;;QAEA;QACA;UACAZ;UAEA;YACA;YACA;cAAAa;cAAAC;YAAA;YAEA;cACA;cAEA;gBACA;gBACAF;cACA,OACA;gBACA;gBAEA;kBACA;gBACA,OACA;kBACAA;gBACA;cACA,OACA;gBACA;gBACAA;cACA,OACA;gBACAA;gBACAA;cACA,OACA;gBACAA;cACA;YACA;YAEA;UACA,OACA;YACAA;YACA;UACA;UACA;QAEA;UACA;MAAA;IAEA;IACAG;MACA;IACA;IACAC;MACAhB;MACA;MACA;MACA;MACA;MAEA;QACA;UAAAiB;UAAAC;QAAA;MACA;IACA;IACAC;MACAnB;MACA;MACA;QACA;QACA;UACA;QACA;MACA;IACA;IACAoB;MACA;IACA;IACAF;MACA;QACA;QACA;MACA;MAEA;IACA;IACAD;MACA;QACA;QACA;MACA;MAEA;IACA;IACAI;MACA;IACA;IACAC;MACA;MACA;MAEA;MACA;MACA;MAEA;QAAAT;QAAAC;MAAA;IACA;IACAS;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MAEA;QAAAV;QAAAW;QAAAC;QAAAC;MAAA;IACA;IACAC;MAAAV;MAAAC;IAAA;MACA;MACA;MACA;QACA;MACA;MAEA;MACA;MACA;MACA;QAAAL;QAAAW;QAAAC;QAAAC;MAAA;MACA;MAEA;QACA;UACAd;UACA;YACAA;UACA;UAEA;QACA;MACA,OACA;QACA;UACA;QACA,OACA;UACAA;UACA;QACA,OACA;UACAA;UACA;QACA;MACA,OACA;QACA;QACA;QAEA;UACA;YACA;YAEAA;YACA;UACA;QACA,OACA;UACAA;UACA;QACA;MACA;IACA;IACAgB;MACA;MAEA;QACA;QACA;QACA;MACA,OACA;QACA;MACA,OACA;QACA;MACA,OACA;QACA;MACA,OACA;QACA;MACA;IACA;IACAC;MACA;MAEA,kCACAjB,sBACA,iBACAA,oCACA,0BACAA,yCAEAA;MAEA;IACA;IACAkB;MACA;MACA;MACA;MACA;;MAEA;MACA;MACAC;MACAC;MAEA;MACA;QACA;MACA;;MAEA;MACA;MACA;QACAC;QACA;UACAC;UACA;QACA,OACA;UACAC;QACA;MACA;MAEA;QACA;MACA,OACA;QACAA;QACA;UACAF;UACA;YACAC;YACA;UACA,OACA;YACAC;UACA;QACA;QAEA;UACA;QACA;MACA;MAEA;IACA;IACAC;MACA;IACA;IACAC;MACA;QACA;QACA;MACA;MAEA;IACA;IACAC;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;MAEA;QACAC;QACAA;QACA;QAEA;MACA;IACA;IACAC;MACA;QACA;MACA;IACA;IACAC;MACA;QACA;MACA;MAEA;QACA;QACA;MACA;MAEA;IACA;IACAC;MACA;QACA;MACA;MAEA;QACA;MACA;MAEA;QACA;MACA;MAEA;IACA;IACAC;MACAC;MAEA;MACA;MACA;MAEA;QACAL;MACA;MAEA;QACA;QACA;QACA;QACA;QACA;MACA,OACA;QACA;QACA;QACA;QACA;QAEA;UACA;UACA;UACA;UACA;UACAM;UAEA;UACA;UACAC;UAEAC;UACA;QACA,OACA;UACA,kEACA,gFACA,mCACA,gFACA,0DACA;QACA,OACA;UACA;UACA;UACA;UACA;UAEA;YACAA;UACA,OACA;YACAA;UACA;UAEA;UACA;QACA,OACA;UACA;UACA;UACA;UACA;QACA,OACA;UACAA;UACA;QACA;MACA;MAEA;IACA;IACAC;MACA;QACA;QACA;QAEA;MACA;MAEA;IACA;IACAC;MACA;QACA;QAEA;UACA,+CACAtD,OACAD,mBACAA;QACA;MACA;MAEA;IACA;IACAwD;MACA;MACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACA;MAEA;MACA;MACAC;MACAA;MACA;MACA;IACA;IACAC;MACA;QACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;EACA;EACAC;IACAC;MACA;QACA;QACA;QACA;QACA;QACA;MACA;IACA;IACAC;MACA;QACA;MACA;IACA;IACAC;MACA;QACA;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;IACA;IACAC;MACA;QACAL;QACAC;QACAC;QACAC;QACAC;MACA;IACA;IACA5E;MACA;MACA;IACA;IACA8E;MACA;IACA;EACA;EACAC;IACA;IACA;EACA;AACA","names":["inheritAttrs","props","value","type","default","format","showButtons","buttonLayout","incrementButtonClass","decrementButtonClass","incrementButtonIcon","decrementButtonIcon","locale","localeMatcher","mode","prefix","suffix","currency","currencyDisplay","useGrouping","minFractionDigits","maxFractionDigits","min","max","step","allowEmpty","styles","className","inputStyle","inputClass","numberFormat","_numeral","_decimal","_group","_minusSign","_currency","_suffix","_prefix","_index","groupChar","isSpecialChar","prefixChar","suffixChar","timer","data","d_value","focused","watch","created","methods","getOptions","style","minimumFractionDigits","maximumFractionDigits","constructParser","updateConstructParser","escapeRegExp","getDecimalExpression","getGroupingExpression","getMinusSignExpression","getCurrencyExpression","getPrefixExpression","getSuffixExpression","formatValue","formattedValue","parseValue","replace","trim","repeat","spin","onUpButtonMouseDown","event","onUpButtonMouseUp","onUpButtonMouseLeave","onUpButtonKeyUp","onUpButtonKeyDown","onDownButtonMouseDown","onDownButtonMouseUp","onDownButtonMouseLeave","onDownButtonKeyUp","onDownButtonKeyDown","onUserInput","onInputKeyDown","newValueStr","decimalCharIndex","decimalCharIndexWithoutPrefix","onInputKeyUp","onInputKeyPress","isDecimalSign","isMinusSign","onPaste","allowMinusSign","isDecimalMode","getDecimalCharIndexes","getCharIndexes","minusCharIndex","suffixCharIndex","currencyCharIndex","insert","insertText","deleteRange","initCursor","inputValue","selectionStart","char","index","i","onInputClick","isNumeralChar","resetRegex","updateValue","newValue","handleOnInput","isValueChanged","validateValue","updateInput","insertedValueStr","sRegex","tRegex","selectionEnd","concatValues","getDecimalLength","updateModel","onInputFocus","onInputBlur","input","clearTimer","clearInterval","maxBoundry","minBoundry","computed","containerClass","upButtonClass","downButtonClass","filled","upButtonListeners","mousedown","mouseup","mouseleave","keydown","keyup","downButtonListeners","getFormatter","components"],"sourceRoot":"node_modules/primevue/inputnumber","sources":["InputNumber.vue"],"sourcesContent":["<template>\n    <span :class=\"containerClass\" :style=\"styles\">\n        <INInputText ref=\"input\" :class=\"['p-inputnumber-input', inputClass]\" :style=\"inputStyle\" :value=\"formattedValue\" v-bind=\"$attrs\" :aria-valumin=\"min\" :aria-valuemax=\"max\"\n           @input=\"onUserInput\" @keydown=\"onInputKeyDown\" @keyup=\"onInputKeyUp\" @keypress=\"onInputKeyPress\" @paste=\"onPaste\" @click=\"onInputClick\" @focus=\"onInputFocus\" @blur=\"onInputBlur\"/>\n        <span class=\"p-inputnumber-button-group\" v-if=\"showButtons && buttonLayout === 'stacked'\">\n            <INButton :class=\"upButtonClass\" :icon=\"incrementButtonIcon\" v-on=\"upButtonListeners\" :disabled=\"$attrs.disabled\" />\n            <INButton :class=\"downButtonClass\" :icon=\"decrementButtonIcon\" v-on=\"downButtonListeners\" :disabled=\"$attrs.disabled\" />\n        </span>\n        <INButton :class=\"upButtonClass\" :icon=\"incrementButtonIcon\" v-on=\"upButtonListeners\" v-if=\"showButtons && buttonLayout !== 'stacked'\" :disabled=\"$attrs.disabled\" />\n        <INButton :class=\"downButtonClass\" :icon=\"decrementButtonIcon\" v-on=\"downButtonListeners\" v-if=\"showButtons && buttonLayout !== 'stacked'\" :disabled=\"$attrs.disabled\" />\n    </span>\n</template>\n\n<script>\nimport InputText from '../inputtext/InputText';\nimport Button from '../button/Button';\n\nexport default {\n    inheritAttrs: false,\n    props: {\n        value: {\n            type: Number,\n            default: null\n        },\n        format: {\n            type: Boolean,\n            default: true\n        },\n        showButtons: {\n            type: Boolean,\n            default: false\n        },\n        buttonLayout: {\n            type: String,\n            default: 'stacked'\n        },\n        incrementButtonClass: {\n            type: String,\n            default: null,\n        },\n        decrementButtonClass: {\n            type: String,\n            default: null,\n        },\n        incrementButtonIcon: {\n            type: String,\n            default: 'pi pi-angle-up',\n        },\n        decrementButtonIcon: {\n            type: String,\n            default: 'pi pi-angle-down',\n        },\n        locale: {\n            type: String,\n            default: undefined\n        },\n        localeMatcher: {\n            type: String,\n            default: undefined\n        },\n        mode: {\n            type: String,\n            default: 'decimal'\n        },\n        prefix: {\n            type: String,\n            default: null\n        },\n        suffix: {\n            type: String,\n            default: null\n        },\n        currency: {\n            type: String,\n            default: undefined\n        },\n        currencyDisplay: {\n            type: String,\n            default: undefined\n        },\n        useGrouping: {\n            type: Boolean,\n            default: true\n        },\n        minFractionDigits: {\n            type: Number,\n            default: undefined\n        },\n        maxFractionDigits: {\n            type: Number,\n            default: undefined\n        },\n        min: {\n            type: Number,\n            default: null\n        },\n        max: {\n            type: Number,\n            default: null\n        },\n        step: {\n            type: Number,\n            default: 1\n        },\n        allowEmpty: {\n            type: Boolean,\n            default: true\n        },\n        styles: null,\n        className: null,\n        inputStyle: null,\n        inputClass: null\n    },\n    numberFormat: null,\n    _numeral: null,\n    _decimal: null,\n    _group: null,\n    _minusSign: null,\n    _currency: null,\n    _suffix: null,\n    _prefix: null,\n    _index: null,\n    groupChar: '',\n    isSpecialChar: null,\n    prefixChar: null,\n    suffixChar: null,\n    timer: null,\n    data() {\n        return {\n            d_value: null,\n            focused: false\n        }\n    },\n    watch: {\n        value(newValue) {\n            this.d_value = newValue;\n        },\n\t\tlocale(newValue, oldValue) {\n            this.updateConstructParser(newValue, oldValue);\n        },\n        localeMatcher(newValue, oldValue) {\n            this.updateConstructParser(newValue, oldValue);\n        },\n        mode(newValue, oldValue) {\n            this.updateConstructParser(newValue, oldValue);\n        },\n        currency(newValue, oldValue) {\n            this.updateConstructParser(newValue, oldValue);\n        },\n        currencyDisplay(newValue, oldValue) {\n            this.updateConstructParser(newValue, oldValue);\n        },\n        useGrouping(newValue, oldValue) {\n            this.updateConstructParser(newValue, oldValue);\n        },\n        minFractionDigits(newValue, oldValue) {\n            this.updateConstructParser(newValue, oldValue);\n        },\n        maxFractionDigits(newValue, oldValue) {\n            this.updateConstructParser(newValue, oldValue);\n        },\n        suffix(newValue, oldValue) {\n            this.updateConstructParser(newValue, oldValue);\n        },\n        prefix(newValue, oldValue) {\n            this.updateConstructParser(newValue, oldValue);\n        }\n    },\n    created() {\n        this.constructParser();\n    },\n    methods: {\n        getOptions() {\n            return {\n                localeMatcher: this.localeMatcher,\n                style: this.mode,\n                currency: this.currency,\n                currencyDisplay: this.currencyDisplay,\n                useGrouping: this.useGrouping,\n                minimumFractionDigits: this.minFractionDigits,\n                maximumFractionDigits: this.maxFractionDigits\n            };\n        },\n        constructParser() {\n            this.numberFormat = new Intl.NumberFormat(this.locale, this.getOptions());\n            const numerals = [...new Intl.NumberFormat(this.locale, {useGrouping: false}).format(9876543210)].reverse();\n            const index = new Map(numerals.map((d, i) => [d, i]));\n            this._numeral = new RegExp(`[${numerals.join('')}]`, 'g');\n            this._group = this.getGroupingExpression();\n            this._minusSign = this.getMinusSignExpression();\n            this._currency = this.getCurrencyExpression();\n            this._decimal = this.getDecimalExpression();\n            this._suffix = this.getSuffixExpression();\n            this._prefix = this.getPrefixExpression();\n            this._index = d => index.get(d);\n        },\n        updateConstructParser(newValue, oldValue) {\n            if (newValue !== oldValue) {\n                this.constructParser();\n            }\n        },\n        escapeRegExp(text) {\n            return text.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, '\\\\$&');\n        },\n        getDecimalExpression() {\n            const formatter = new Intl.NumberFormat(this.locale, {...this.getOptions(), useGrouping: false});\n            return new RegExp(`[${formatter.format(1.1).replace(this._currency, '').trim().replace(this._numeral, '')}]`, 'g');\n        },\n        getGroupingExpression() {\n            const formatter = new Intl.NumberFormat(this.locale, {useGrouping: true});\n            this.groupChar = formatter.format(1000000).trim().replace(this._numeral, '').charAt(0);\n            return new RegExp(`[${this.groupChar}]`, 'g');\n        },\n        getMinusSignExpression() {\n            const formatter = new Intl.NumberFormat(this.locale, {useGrouping: false});\n            return new RegExp(`[${formatter.format(-1).trim().replace(this._numeral, '')}]`, 'g');\n        },\n        getCurrencyExpression() {\n            if (this.currency) {\n                const formatter = new Intl.NumberFormat(this.locale, {style: 'currency', currency: this.currency, currencyDisplay: this.currencyDisplay,\n                    minimumFractionDigits: 0, maximumFractionDigits: 0});\n                return new RegExp(`[${formatter.format(1).replace(/\\s/g, '').replace(this._numeral, '').replace(this._group, '')}]`, 'g');\n            }\n\n            return new RegExp(`[]`,'g');\n        },\n        getPrefixExpression() {\n            if (this.prefix) {\n                this.prefixChar = this.prefix;\n            }\n            else {\n                const formatter = new Intl.NumberFormat(this.locale, {style: this.mode, currency: this.currency, currencyDisplay: this.currencyDisplay});\n                this.prefixChar = formatter.format(1).split('1')[0];\n            }\n\n            return new RegExp(`${this.escapeRegExp(this.prefixChar||'')}`, 'g');\n        },\n        getSuffixExpression() {\n            if (this.suffix) {\n                this.suffixChar = this.suffix;\n            }\n            else {\n                const formatter = new Intl.NumberFormat(this.locale, {style: this.mode, currency: this.currency, currencyDisplay: this.currencyDisplay,\n                    minimumFractionDigits: 0, maximumFractionDigits: 0});\n                this.suffixChar = formatter.format(1).split('1')[1];\n            }\n\n            return new RegExp(`${this.escapeRegExp(this.suffixChar||'')}`, 'g');\n        },\n        formatValue(value) {\n            if (value != null) {\n                if (value === '-') { // Minus sign\n                    return value;\n                }\n\n                if (this.format) {\n                    let formatter = new Intl.NumberFormat(this.locale, this.getOptions());\n                    let formattedValue = formatter.format(value);\n                    if (this.prefix) {\n                        formattedValue = this.prefix + formattedValue;\n                    }\n\n                    if (this.suffix) {\n                        formattedValue = formattedValue + this.suffix;\n                    }\n\n                    return formattedValue;\n                }\n\n                return value.toString();\n            }\n\n            return '';\n        },\n        parseValue(text) {\n            let filteredText = text\n                                .replace(this._suffix, '')\n                                .replace(this._prefix, '')\n                                .trim()\n                                .replace(/\\s/g, '')\n                                .replace(this._currency, '')\n                                .replace(this._group, '')\n                                .replace(this._minusSign, '-')\n                                .replace(this._decimal, '.')\n                                .replace(this._numeral, this._index);\n\n            if (filteredText) {\n                if (filteredText === '-') // Minus sign\n                    return filteredText;\n\n                let parsedValue = +filteredText;\n                return isNaN(parsedValue) ? null : parsedValue;\n            }\n\n            return null;\n        },\n        repeat(event, interval, dir) {\n            let i = interval || 500;\n\n            this.clearTimer();\n            this.timer = setTimeout(() => {\n                this.repeat(event, 40, dir);\n            }, i);\n\n            this.spin(event, dir);\n        },\n        spin(event, dir) {\n            if (this.$refs.input) {\n                let step = this.step * dir;\n                let currentValue = this.parseValue(this.$refs.input.$el.value) || 0;\n                let newValue = this.validateValue(currentValue + step);\n\n                this.updateInput(newValue, null, 'spin');\n                this.updateModel(event, newValue);\n\n                this.handleOnInput(event, currentValue, newValue);\n            }\n        },\n        onUpButtonMouseDown(event) {\n            if (!this.$attrs.disabled) {\n                this.$refs.input.$el.focus();\n                this.repeat(event, null, 1);\n                event.preventDefault();\n            }\n        },\n        onUpButtonMouseUp() {\n            if (!this.$attrs.disabled) {\n                this.clearTimer();\n            }\n        },\n        onUpButtonMouseLeave() {\n            if (!this.$attrs.disabled) {\n                this.clearTimer();\n            }\n        },\n        onUpButtonKeyUp() {\n            if (!this.$attrs.disabled) {\n                this.clearTimer();\n            }\n        },\n        onUpButtonKeyDown(event) {\n            if (event.keyCode === 32 || event.keyCode === 13) {\n                this.repeat(event, null, 1);\n            }\n        },\n        onDownButtonMouseDown(event) {\n            if (!this.$attrs.disabled) {\n                this.$refs.input.$el.focus();\n                this.repeat(event, null, -1);\n                event.preventDefault();\n            }\n        },\n        onDownButtonMouseUp() {\n            if (!this.$attrs.disabled) {\n                this.clearTimer();\n            }\n        },\n        onDownButtonMouseLeave() {\n            if (!this.$attrs.disabled) {\n                this.clearTimer();\n            }\n        },\n        onDownButtonKeyUp() {\n            if (!this.$attrs.disabled) {\n                this.clearTimer();\n            }\n        },\n        onDownButtonKeyDown(event) {\n            if (event.keyCode === 32 || event.keyCode === 13) {\n                this.repeat(event, null, -1);\n            }\n        },\n        onUserInput() {\n            if (this.isSpecialChar) {\n                this.$refs.input.$el.value = this.lastValue;\n            }\n            this.isSpecialChar = false;\n        },\n        onInputKeyDown(event) {\n            this.lastValue = event.target.value;\n            if (event.shiftKey || event.altKey) {\n                this.isSpecialChar = true;\n                return;\n            }\n\n            let selectionStart = event.target.selectionStart;\n            let selectionEnd = event.target.selectionEnd;\n            let inputValue = event.target.value;\n            let newValueStr = null;\n\n            if (event.altKey) {\n                event.preventDefault();\n            }\n\n            switch (event.which) {\n                //up\n                case 38:\n                    this.spin(event, 1);\n                    event.preventDefault();\n                break;\n\n                //down\n                case 40:\n                    this.spin(event, -1);\n                    event.preventDefault();\n                break;\n\n                //left\n                case 37:\n                    if (!this.isNumeralChar(inputValue.charAt(selectionStart - 1))) {\n                        event.preventDefault();\n                    }\n                break;\n\n                //right\n                case 39:\n                    if (!this.isNumeralChar(inputValue.charAt(selectionStart))) {\n                        event.preventDefault();\n                    }\n                break;\n\n                //enter\n                case 13:\n                    newValueStr = this.validateValue(this.parseValue(inputValue));\n                    this.$refs.input.$el.value = this.formatValue(newValueStr);\n                    this.$refs.input.$el.setAttribute('aria-valuenow', newValueStr);\n                    this.updateModel(event, newValueStr);\n                break;\n\n                //backspace\n                case 8: {\n                    event.preventDefault();\n\n                    if (selectionStart === selectionEnd) {\n                        const deleteChar = inputValue.charAt(selectionStart - 1);\n                        const { decimalCharIndex, decimalCharIndexWithoutPrefix } = this.getDecimalCharIndexes(inputValue);\n\n                        if (this.isNumeralChar(deleteChar)) {\n                            const decimalLength = this.getDecimalLength(inputValue);\n\n                            if (this._group.test(deleteChar)) {\n                                this._group.lastIndex = 0;\n                                newValueStr = inputValue.slice(0, selectionStart - 2) + inputValue.slice(selectionStart - 1);\n                            }\n                            else if (this._decimal.test(deleteChar)) {\n                                this._decimal.lastIndex = 0;\n\n                                if (decimalLength) {\n                                    this.$refs.input.$el.setSelectionRange(selectionStart - 1, selectionStart - 1);\n                                }\n                                else {\n                                    newValueStr = inputValue.slice(0, selectionStart - 1) + inputValue.slice(selectionStart);\n                                }\n                            }\n                            else if (decimalCharIndex > 0 && selectionStart > decimalCharIndex) {\n                                const insertedText = this.isDecimalMode() && (this.minFractionDigits || 0) < decimalLength ? '' : '0';\n                                newValueStr = inputValue.slice(0, selectionStart - 1) + insertedText + inputValue.slice(selectionStart);\n                            }\n                            else if (decimalCharIndexWithoutPrefix === 1) {\n                                newValueStr = inputValue.slice(0, selectionStart - 1) + '0' + inputValue.slice(selectionStart);\n                                newValueStr = this.parseValue(newValueStr) > 0 ? newValueStr : '';\n                            }\n                            else {\n                                newValueStr = inputValue.slice(0, selectionStart - 1) + inputValue.slice(selectionStart);\n                            }\n                        }\n\n                        this.updateValue(event, newValueStr, null, 'delete-single');\n                    }\n                    else {\n                        newValueStr = this.deleteRange(inputValue, selectionStart, selectionEnd);\n                        this.updateValue(event, newValueStr, null, 'delete-range');\n                    }\n\n                    break;\n                }\n\n                // del\n                case 46:\n                    event.preventDefault();\n\n                    if (selectionStart === selectionEnd) {\n                        const deleteChar = inputValue.charAt(selectionStart);\n                        const { decimalCharIndex, decimalCharIndexWithoutPrefix } = this.getDecimalCharIndexes(inputValue);\n\n                        if (this.isNumeralChar(deleteChar)) {\n                            const decimalLength = this.getDecimalLength(inputValue);\n\n                            if (this._group.test(deleteChar)) {\n                                this._group.lastIndex = 0;\n                                newValueStr = inputValue.slice(0, selectionStart) + inputValue.slice(selectionStart + 2);\n                            }\n                            else if (this._decimal.test(deleteChar)) {\n                                this._decimal.lastIndex = 0;\n\n                                if (decimalLength) {\n                                    this.$refs.input.$el.setSelectionRange(selectionStart + 1, selectionStart + 1);\n                                }\n                                else {\n                                    newValueStr = inputValue.slice(0, selectionStart) + inputValue.slice(selectionStart + 1);\n                                }\n                            }\n                            else if (decimalCharIndex > 0 && selectionStart > decimalCharIndex) {\n                                const insertedText = this.isDecimalMode() && (this.minFractionDigits || 0) < decimalLength ? '' : '0';\n                                newValueStr = inputValue.slice(0, selectionStart) + insertedText + inputValue.slice(selectionStart + 1);\n                            }\n                            else if (decimalCharIndexWithoutPrefix === 1) {\n                                newValueStr = inputValue.slice(0, selectionStart) + '0' + inputValue.slice(selectionStart + 1);\n                                newValueStr = this.parseValue(newValueStr) > 0 ? newValueStr : '';\n                            }\n                            else {\n                                newValueStr = inputValue.slice(0, selectionStart) + inputValue.slice(selectionStart + 1);\n                            }\n                        }\n\n                        this.updateValue(event, newValueStr, null, 'delete-back-single');\n                    }\n                    else {\n                        newValueStr = this.deleteRange(inputValue, selectionStart, selectionEnd);\n                        this.updateValue(event, newValueStr, null, 'delete-range');\n                    }\n                break;\n\n                default:\n                break;\n            }\n        },\n        onInputKeyUp(event) {\n            this.$emit('keyup', event);\n        },\n        onInputKeyPress(event) {\n            event.preventDefault();\n            let code = event.which || event.keyCode;\n            let char = String.fromCharCode(code);\n            const isDecimalSign = this.isDecimalSign(char);\n            const isMinusSign = this.isMinusSign(char);\n\n            if ((48 <= code && code <= 57) || isMinusSign || isDecimalSign) {\n                this.insert(event, char, { isDecimalSign, isMinusSign });\n            }\n        },\n        onPaste(event) {\n            event.preventDefault();\n            let data = (event.clipboardData || window['clipboardData']).getData('Text');\n            if (data) {\n                let filteredData = this.parseValue(data);\n                if (filteredData != null) {\n                    this.insert(event, filteredData.toString());\n                }\n            }\n        },\n        allowMinusSign() {\n            return this.min === null || this.min < 0;\n        },\n        isMinusSign(char) {\n            if (this._minusSign.test(char) || char === '-') {\n                this._minusSign.lastIndex = 0;\n                return true;\n            }\n\n            return false;\n        },\n        isDecimalSign(char) {\n            if (this._decimal.test(char)) {\n                this._decimal.lastIndex = 0;\n                return true;\n            }\n\n            return false;\n        },\n        isDecimalMode() {\n            return this.mode === 'decimal';\n        },\n        getDecimalCharIndexes(val) {\n            let decimalCharIndex = val.search(this._decimal);\n            this._decimal.lastIndex = 0;\n\n            const filteredVal = val.replace(this._prefix, '').trim().replace(/\\s/g, '').replace(this._currency, '');\n            const decimalCharIndexWithoutPrefix = filteredVal.search(this._decimal);\n            this._decimal.lastIndex = 0;\n\n            return { decimalCharIndex, decimalCharIndexWithoutPrefix };\n        },\n        getCharIndexes(val) {\n            const decimalCharIndex = val.search(this._decimal);\n            this._decimal.lastIndex = 0;\n            const minusCharIndex = val.search(this._minusSign);\n            this._minusSign.lastIndex = 0;\n            const suffixCharIndex = val.search(this._suffix);\n            this._suffix.lastIndex = 0;\n            const currencyCharIndex = val.search(this._currency);\n            this._currency.lastIndex = 0;\n\n            return { decimalCharIndex, minusCharIndex, suffixCharIndex, currencyCharIndex };\n        },\n        insert(event, text, sign = { isDecimalSign: false, isMinusSign: false }) {\n            const minusCharIndexOnText = text.search(this._minusSign);\n            this._minusSign.lastIndex = 0;\n            if (!this.allowMinusSign() && minusCharIndexOnText !== -1) {\n                return;\n            }\n\n            const selectionStart = this.$refs.input.$el.selectionStart;\n            const selectionEnd = this.$refs.input.$el.selectionEnd;\n            let inputValue = this.$refs.input.$el.value.trim();\n            const { decimalCharIndex, minusCharIndex, suffixCharIndex, currencyCharIndex } = this.getCharIndexes(inputValue);\n            let newValueStr;\n\n            if (sign.isMinusSign) {\n                if (selectionStart === 0) {\n                    newValueStr = inputValue;\n                    if (minusCharIndex === -1 || selectionEnd !== 0) {\n                        newValueStr = this.insertText(inputValue, text, 0, selectionEnd);\n                    }\n\n                    this.updateValue(event, newValueStr, text, 'insert');\n                }\n            }\n            else if (sign.isDecimalSign) {\n                if (decimalCharIndex > 0 && selectionStart === decimalCharIndex) {\n                    this.updateValue(event, inputValue, text, 'insert');\n                }\n                else if (decimalCharIndex > selectionStart && decimalCharIndex < selectionEnd) {\n                    newValueStr = this.insertText(inputValue, text, selectionStart, selectionEnd);\n                    this.updateValue(event, newValueStr, text, 'insert');\n                }\n                else if (decimalCharIndex === -1 && this.maxFractionDigits) {\n                    newValueStr = this.insertText(inputValue, text, selectionStart, selectionEnd);\n                    this.updateValue(event, newValueStr, text, 'insert');\n                }\n            }\n            else {\n                const maxFractionDigits = this.numberFormat.resolvedOptions().maximumFractionDigits;\n                const operation = selectionStart !== selectionEnd ? 'range-insert' : 'insert';\n\n                if (decimalCharIndex > 0 && selectionStart > decimalCharIndex) {\n                    if ((selectionStart + text.length - (decimalCharIndex + 1)) <= maxFractionDigits) {\n                        const charIndex = currencyCharIndex >= selectionStart ? currencyCharIndex - 1 : (suffixCharIndex >= selectionStart ? suffixCharIndex : inputValue.length);\n\n                        newValueStr = inputValue.slice(0, selectionStart) + text + inputValue.slice(selectionStart + text.length, charIndex) + inputValue.slice(charIndex);\n                        this.updateValue(event, newValueStr, text, operation);\n                    }\n                }\n                else {\n                    newValueStr = this.insertText(inputValue, text, selectionStart, selectionEnd);\n                    this.updateValue(event, newValueStr, text, operation);\n                }\n            }\n        },\n        insertText(value, text, start, end) {\n            let textSplit = text === '.' ? text : text.split('.');\n\n            if (textSplit.length === 2) {\n                const decimalCharIndex = value.slice(start, end).search(this._decimal);\n                this._decimal.lastIndex = 0;\n                return (decimalCharIndex > 0) ? value.slice(0, start) + this.formatValue(text) + value.slice(end) : (value || this.formatValue(text));\n            }\n            else if ((end - start) === value.length) {\n                return this.formatValue(text);\n            }\n            else if (start === 0) {\n                return text + value.slice(end);\n            }\n            else if (end === value.length) {\n                return value.slice(0, start) + text;\n            }\n            else {\n                return value.slice(0, start) + text + value.slice(end);\n            }\n        },\n        deleteRange(value, start, end) {\n            let newValueStr;\n\n            if ((end - start) === value.length)\n                newValueStr = '';\n            else if (start === 0)\n                newValueStr = value.slice(end);\n            else if (end === value.length)\n                newValueStr = value.slice(0, start);\n            else\n                newValueStr = value.slice(0, start) + value.slice(end);\n\n            return newValueStr;\n        },\n        initCursor() {\n            let selectionStart = this.$refs.input.$el.selectionStart;\n            let inputValue = this.$refs.input.$el.value;\n            let valueLength = inputValue.length;\n            let index = null;\n\n            // remove prefix\n            let prefixLength = (this.prefixChar || '').length;\n            inputValue = inputValue.replace(this._prefix, '');\n            selectionStart = selectionStart - prefixLength;\n\n            let char = inputValue.charAt(selectionStart);\n            if (this.isNumeralChar(char)) {\n                return selectionStart + prefixLength;\n            }\n\n            //left\n            let i = selectionStart - 1;\n            while (i >= 0) {\n                char = inputValue.charAt(i);\n                if (this.isNumeralChar(char)) {\n                    index = i + prefixLength;\n                    break;\n                }\n                else {\n                    i--;\n                }\n            }\n\n            if (index !== null) {\n                this.$refs.input.$el.setSelectionRange(index + 1, index + 1);\n            }\n            else {\n                i = selectionStart;\n                while (i < valueLength) {\n                    char = inputValue.charAt(i);\n                    if (this.isNumeralChar(char)) {\n                        index = i + prefixLength;\n                        break;\n                    }\n                    else {\n                        i++;\n                    }\n                }\n\n                if (index !== null) {\n                    this.$refs.input.$el.setSelectionRange(index, index);\n                }\n            }\n\n            return index || 0;\n        },\n        onInputClick() {\n            this.initCursor();\n        },\n        isNumeralChar(char) {\n            if (char.length === 1 && (this._numeral.test(char) || this._decimal.test(char) || this._group.test(char) || this._minusSign.test(char))) {\n                this.resetRegex();\n                return true;\n            }\n\n            return false;\n        },\n        resetRegex() {\n            this._numeral.lastIndex =  0;\n            this._decimal.lastIndex =  0;\n            this._group.lastIndex =  0;\n            this._minusSign.lastIndex =  0;\n        },\n        updateValue(event, valueStr, insertedValueStr, operation) {\n            let currentValue = this.$refs.input.$el.value;\n            let newValue = null;\n\n            if (valueStr != null) {\n                newValue = this.parseValue(valueStr);\n                newValue = !newValue && !this.allowEmpty ? 0 : newValue;\n                this.updateInput(newValue, insertedValueStr, operation, valueStr);\n\n                this.handleOnInput(event, currentValue, newValue);\n            }\n        },\n        handleOnInput(event, currentValue, newValue) {\n            if (this.isValueChanged(currentValue, newValue)) {\n                this.$emit('input', newValue);\n            }\n        },\n        isValueChanged(currentValue, newValue) {\n            if (newValue === null && currentValue !== null) {\n                return true;\n            }\n\n            if (newValue != null) {\n                let parsedCurrentValue = (typeof currentValue === 'string') ? this.parseValue(currentValue) : currentValue;\n                return newValue !== parsedCurrentValue;\n            }\n\n            return false;\n        },\n        validateValue(value) {\n            if (value === '-' || value == null) {\n                return null;\n            }\n\n            if (this.min != null && value < this.min) {\n                return this.min;\n            }\n\n            if (this.max != null && value > this.max) {\n                return this.max;\n            }\n\n            return value;\n        },\n        updateInput(value, insertedValueStr, operation, valueStr) {\n            insertedValueStr = insertedValueStr || '';\n\n            let inputValue = this.$refs.input.$el.value;\n            let newValue = this.formatValue(value);\n            let currentLength = inputValue.length;\n\n            if (newValue !== valueStr) {\n                newValue = this.concatValues(newValue, valueStr);\n            }\n\n            if (currentLength === 0) {\n                this.$refs.input.$el.value = newValue;\n                this.$refs.input.$el.setSelectionRange(0, 0);\n                const index = this.initCursor();\n                const selectionEnd = index + insertedValueStr.length;\n                this.$refs.input.$el.setSelectionRange(selectionEnd, selectionEnd);\n            }\n            else {\n                let selectionStart = this.$refs.input.$el.selectionStart;\n                let selectionEnd = this.$refs.input.$el.selectionEnd;\n                this.$refs.input.$el.value = newValue;\n                let newLength = newValue.length;\n\n                if (operation === 'range-insert') {\n                    const startValue = this.parseValue((inputValue || '').slice(0, selectionStart));\n                    const startValueStr = startValue !== null ? startValue.toString() : '';\n                    const startExpr = startValueStr.split('').join(`(${this.groupChar})?`);\n                    const sRegex = new RegExp(startExpr, 'g');\n                    sRegex.test(newValue);\n\n                    const tExpr = insertedValueStr.split('').join(`(${this.groupChar})?`);\n                    const tRegex = new RegExp(tExpr, 'g');\n                    tRegex.test(newValue.slice(sRegex.lastIndex));\n\n                    selectionEnd = sRegex.lastIndex + tRegex.lastIndex;\n                    this.$refs.input.$el.setSelectionRange(selectionEnd, selectionEnd);\n                }\n                else if (newLength === currentLength) {\n                    if (operation === 'insert' || operation === 'delete-back-single')\n                        this.$refs.input.$el.setSelectionRange(selectionEnd + 1, selectionEnd + 1);\n                    else if (operation === 'delete-single')\n                        this.$refs.input.$el.setSelectionRange(selectionEnd - 1, selectionEnd - 1);\n                    else if (operation === 'delete-range' || operation === 'spin')\n                        this.$refs.input.$el.setSelectionRange(selectionEnd, selectionEnd);\n                }\n                else if (operation === 'delete-back-single') {\n                    let prevChar = inputValue.charAt(selectionEnd - 1);\n                    let nextChar = inputValue.charAt(selectionEnd);\n                    let diff = currentLength - newLength;\n                    let isGroupChar = this._group.test(nextChar);\n\n                    if (isGroupChar && diff === 1) {\n                        selectionEnd += 1;\n                    }\n                    else if (!isGroupChar && this.isNumeralChar(prevChar)) {\n                        selectionEnd += (-1 * diff) + 1;\n                    }\n\n                    this._group.lastIndex = 0;\n                    this.$refs.input.$el.setSelectionRange(selectionEnd, selectionEnd);\n                }\n                else if (inputValue === '-' && operation === 'insert') {\n                    this.$refs.input.$el.setSelectionRange(0, 0);\n                    const index = this.initCursor();\n                    const selectionEnd = index + insertedValueStr.length + 1;\n                    this.$refs.input.$el.setSelectionRange(selectionEnd, selectionEnd);\n                }\n                else {\n                    selectionEnd = selectionEnd + (newLength - currentLength);\n                    this.$refs.input.$el.setSelectionRange(selectionEnd, selectionEnd);\n                }\n            }\n\n            this.$refs.input.$el.setAttribute('aria-valuenow', value);\n        },\n        concatValues(val1, val2) {\n            if (val1 && val2) {\n                let decimalCharIndex = val2.search(this._decimal);\n                this._decimal.lastIndex = 0;\n\n                return decimalCharIndex !== -1 ? (val1.split(this._decimal)[0] + val2.slice(decimalCharIndex)) : val1;\n            }\n\n            return val1;\n        },\n        getDecimalLength(value) {\n            if (value) {\n                const valueSplit = value.split(this._decimal);\n\n                if (valueSplit.length === 2) {\n                    return valueSplit[1].replace(this._suffix, '')\n                                .trim()\n                                .replace(/\\s/g, '')\n                                .replace(this._currency, '').length;\n                }\n            }\n\n            return 0;\n        },\n        updateModel(event, value) {\n            this.d_value = value;\n            this.$emit('input', value);\n        },\n        onInputFocus(event) {\n            this.focused = true;\n            this.$emit('focus', event);\n        },\n        onInputBlur(event) {\n            this.focused = false;\n\n            let input = event.target;\n            let newValue = this.validateValue(this.parseValue(input.value));\n            input.value = this.formatValue(newValue);\n            input.setAttribute('aria-valuenow', newValue);\n            this.updateModel(event, newValue);\n            this.$emit('blur', event);\n        },\n        clearTimer() {\n            if (this.timer) {\n                clearInterval(this.timer);\n            }\n        },\n        maxBoundry() {\n            return this.d_value >= this.max;\n        },\n        minBoundry() {\n            return this.d_value <= this.min;\n        },\n    },\n    computed: {\n        containerClass() {\n            return ['p-inputnumber p-component p-inputwrapper', this.className, {\n                'p-inputwrapper-filled': this.filled,\n                'p-inputwrapper-focus': this.focused,\n                'p-inputnumber-buttons-stacked': this.showButtons && this.buttonLayout === 'stacked',\n                'p-inputnumber-buttons-horizontal': this.showButtons && this.buttonLayout === 'horizontal',\n                'p-inputnumber-buttons-vertical': this.showButtons && this.buttonLayout === 'vertical'\n            }];\n        },\n        upButtonClass() {\n            return ['p-inputnumber-button p-inputnumber-button-up', this.incrementButtonClass, {\n                'p-disabled': this.showButtons && this.max !== null && this.maxBoundry()\n            }];\n        },\n        downButtonClass() {\n            return ['p-inputnumber-button p-inputnumber-button-down', this.decrementButtonClass, {\n                'p-disabled': this.showButtons && this.min !== null && this.minBoundry()\n            }];\n        },\n        filled() {\n            return (this.value != null && this.value.toString().length > 0)\n        },\n        upButtonListeners() {\n            return {\n                mousedown: event => this.onUpButtonMouseDown(event),\n                mouseup: event => this.onUpButtonMouseUp(event),\n                mouseleave: event => this.onUpButtonMouseLeave(event),\n                keydown: event => this.onUpButtonKeyDown(event),\n                keyup: event => this.onUpButtonKeyUp(event)\n            }\n        },\n        downButtonListeners() {\n            return {\n                mousedown: event => this.onDownButtonMouseDown(event),\n                mouseup: event => this.onDownButtonMouseUp(event),\n                mouseleave: event => this.onDownButtonMouseLeave(event),\n                keydown: event => this.onDownButtonKeyDown(event),\n                keyup: event => this.onDownButtonKeyUp(event)\n            }\n        },\n        formattedValue() {\n            const val = !this.value && !this.allowEmpty ? 0 : this.value;\n            return this.formatValue(val);\n        },\n        getFormatter() {\n            return this.numberFormat;\n        }\n    },\n    components: {\n        'INInputText': InputText,\n        'INButton': Button\n    }\n}\n</script>\n\n<style>\n.p-inputnumber {\n    display: inline-flex;\n}\n\n.p-inputnumber-button {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    flex: 0 0 auto;\n}\n\n.p-inputnumber-buttons-stacked .p-button.p-inputnumber-button .p-button-label,\n.p-inputnumber-buttons-horizontal .p-button.p-inputnumber-button .p-button-label {\n    display: none;\n}\n\n.p-inputnumber-buttons-stacked .p-button.p-inputnumber-button-up {\n    border-top-left-radius: 0;\n    border-bottom-left-radius: 0;\n    border-bottom-right-radius: 0;\n    padding: 0;\n}\n\n.p-inputnumber-buttons-stacked .p-inputnumber-input {\n    border-top-right-radius: 0;\n    border-bottom-right-radius: 0;\n}\n\n.p-inputnumber-buttons-stacked .p-button.p-inputnumber-button-down {\n    border-top-left-radius: 0;\n    border-top-right-radius: 0;\n    border-bottom-left-radius: 0;\n    padding: 0;\n}\n\n.p-inputnumber-buttons-stacked .p-inputnumber-button-group {\n    display: flex;\n    flex-direction: column;\n}\n\n.p-inputnumber-buttons-stacked .p-inputnumber-button-group .p-button.p-inputnumber-button {\n    flex: 1 1 auto;\n}\n\n.p-inputnumber-buttons-horizontal .p-button.p-inputnumber-button-up {\n    order: 3;\n    border-top-left-radius: 0;\n    border-bottom-left-radius: 0;\n}\n\n.p-inputnumber-buttons-horizontal .p-inputnumber-input {\n    order: 2;\n    border-radius: 0;\n}\n\n.p-inputnumber-buttons-horizontal .p-button.p-inputnumber-button-down {\n    order: 1;\n    border-top-right-radius: 0;\n    border-bottom-right-radius: 0;\n}\n\n.p-inputnumber-buttons-vertical {\n    flex-direction: column;\n}\n\n.p-inputnumber-buttons-vertical .p-button.p-inputnumber-button-up {\n    order: 1;\n    border-bottom-left-radius: 0;\n    border-bottom-right-radius: 0;\n    width: 100%;\n}\n\n.p-inputnumber-buttons-vertical .p-inputnumber-input {\n    order: 2;\n    border-radius: 0;\n    text-align: center;\n}\n\n.p-inputnumber-buttons-vertical .p-button.p-inputnumber-button-down {\n    order: 3;\n    border-top-left-radius: 0;\n    border-top-right-radius: 0;\n    width: 100%;\n}\n\n.p-inputnumber-input {\n    flex: 1 1 auto;\n}\n\n.p-fluid .p-inputnumber {\n    width: 100%;\n}\n\n.p-fluid .p-inputnumber .p-inputnumber-input {\n    width: 1%;\n}\n\n.p-fluid .p-inputnumber-buttons-vertical .p-inputnumber-input {\n    width: 100%;\n}\n</style>\n"]}]}