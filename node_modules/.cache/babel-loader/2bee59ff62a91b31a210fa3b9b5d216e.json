{"remainingRequest":"C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\src\\views\\User\\UserVerify.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\src\\views\\User\\UserVerify.vue","mtime":1645609201000},{"path":"C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\babel.config.js","mtime":1645609201000},{"path":"C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1664810865393},{"path":"C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\node_modules\\babel-loader\\lib\\index.js","mtime":1664810865430},{"path":"C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1664810865393},{"path":"C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\node_modules\\vue-loader\\lib\\index.js","mtime":1664810875252}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCBBdXRoZW50aWNhdGlvblNlcnZpY2UgZnJvbSAiQC9zZXJ2aWNlcy9BdXRoZW50aWNhdGlvblNlcnZpY2UuanMiOwppbXBvcnQgVG9wSGVhZGVyIGZyb20gIkAvY29tcG9uZW50cy9Db21tb24vVG9wSGVhZGVyLnZ1ZSI7CmltcG9ydCBGb290ZXIgZnJvbSAiQC9jb21wb25lbnRzL0NvbW1vbi9Gb290ZXIudnVlIjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJVc2VyVmVyaWZ5IiwKICBjb21wb25lbnRzOiB7CiAgICBUb3BIZWFkZXIsCiAgICBGb290ZXIKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB1c2VySWQ6IDAsCiAgICAgIHVzZXJFbWFpbDogIiIsCiAgICAgIHJlZ2lzdGVyVG9rZW5WYWxpZGF0aW9uOiBudWxsLAogICAgICBjb2RlVmVyaWZpY2F0aW9uTWVzc2FnZTogIiIsCiAgICAgIHJlZ2lzdGVyVG9rZW46ICIiCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHt9LAogIGFzeW5jIG1vdW50ZWQoKSB7CiAgICB0aGlzLnVzZXJJZCA9IHRoaXMuJHN0b3JlLnN0YXRlLkN1cnJlbnRVc2VyLm5ld1VzZXJJZDsKICAgIHRoaXMudXNlckVtYWlsID0gdGhpcy4kc3RvcmUuc3RhdGUuQ3VycmVudFVzZXIubmV3VXNlckVtYWlsOwogIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgdHJ5QWdhaW4oKSB7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgdXNlciA9IChhd2FpdCBBdXRoZW50aWNhdGlvblNlcnZpY2UuY2hlY2tSZWdzVG9rZW4oewogICAgICAgICAgZW1haWw6IHRoaXMudXNlckVtYWlsLAogICAgICAgICAgcGFzc3dvcmQ6IHRoaXMuJHN0b3JlLnN0YXRlLkN1cnJlbnRVc2VyLm5ld1VzZXJQYXNzd29yZAogICAgICAgIH0pKS5kYXRhOwogICAgICAgIGlmICh1c2VyLnZlcmlmaWNhdGlvblN0YXR1cykgewogICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgICAgICBwYXRoOiAiL2xvZ2luIgogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5sb2coZXJyb3IucmVzcG9uc2UuZGF0YS5lcnJvcik7CiAgICAgIH0KICAgIH0sCiAgICBhc3luYyB2ZXJpZnlSZWdzVG9rZW4oKSB7CiAgICAgIHZhciB1c2VyOwogICAgICB0cnkgewogICAgICAgIHVzZXIgPSAoYXdhaXQgQXV0aGVudGljYXRpb25TZXJ2aWNlLnZlcmlmeVJlZ3NUb2tlbih7CiAgICAgICAgICB1c2VySWQ6IHRoaXMudXNlcklkLAogICAgICAgICAgcmVnaXN0ZXJUb2tlbjogdGhpcy5yZWdpc3RlclRva2VuCiAgICAgICAgfSkpLmRhdGE7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgdGhpcy5yZWdpc3RlclRva2VuVmFsaWRhdGlvbiA9IGZhbHNlOwogICAgICAgIHRoaXMuY29kZVZlcmlmaWNhdGlvbk1lc3NhZ2UgPSBlcnJvci5yZXNwb25zZS5kYXRhLmVycm9yOwogICAgICB9CiAgICAgIGlmICh1c2VyKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGF3YWl0IEF1dGhlbnRpY2F0aW9uU2VydmljZS5yZXNldFJlZ3NUb2tlbih7CiAgICAgICAgICAgIGlkOiB1c2VyLnVzZXIuaWQsCiAgICAgICAgICAgIGVtYWlsOiB1c2VyLnVzZXIuZW1haWwsCiAgICAgICAgICAgIG5hbWU6IHVzZXIudXNlci5maXJzdE5hbWUgKyAiICIgKyB1c2VyLnVzZXIubGFzdE5hbWUKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goIkN1cnJlbnRVc2VyL3NldFRva2VuIiwgdXNlci50b2tlbik7CiAgICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgiQ3VycmVudFVzZXIvc2V0VXNlciIsIHVzZXIudXNlcik7CiAgICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgiV2lzaGxpc3Qvc2V0V2lzaGxpc3QiKTsKICAgICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCJDdXJyZW50VXNlci9zZXROZXdVc2VySWQiLCAwKTsKICAgICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCJDdXJyZW50VXNlci9zZXROZXdVc2VyRW1haWwiLCAiIik7CiAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICAgIHBhdGg6ICIvIgogICAgICAgICAgfSk7CiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yLnJlc3BvbnNlLmRhdGEuZXJyb3IpOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KfTs="},{"version":3,"mappings":";AAoEA;AACA;AACA;AACA;EACAA;EACAC;IACAC;IACAC;EACA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EACAC;EACA;IACA;IACA;EACA;EACAC;IACA;MACA;QACA,cACA;UACAC;UACAC;QACA,IACAT;QACA;UACA;YAAAU;UAAA;QACA;UACAC;QACA;MACA;QACAC;MACA;IACA;IACA;MACA;MACA;QACAC,QACA;UACAZ;UACAI;QACA,IACAL;MACA;QACA;QACA;MACA;MACA;QACA;UACA;YACAc;YACAN;YACAZ;UACA;UACA;UACA;UACA;UACA;UACA;UACA;YAAAc;UAAA;QACA;UACAE;QACA;MACA;IACA;EACA;AACA","names":["name","components","TopHeader","Footer","data","userId","userEmail","registerTokenValidation","codeVerificationMessage","registerToken","computed","methods","email","password","path","window","console","user","id"],"sourceRoot":"src/views/User","sources":["UserVerify.vue"],"sourcesContent":["<template>\n  <div>\n    <TopHeader />\n    <b-container class=\"mt-5\">\n      <b-row>\n        <b-col cols=\"6\">\n          <b-card v-if=\"userId == 0\">\n            <h5 class=\"text-center\"><strong>Email Verification</strong></h5>\n            <b-alert class=\"mt-4\" variant=\"warning\" show>\n              <small>\n                Please try to\n                <b-link to=\"/register\">Create your account</b-link>\n                first.\n              </small>\n            </b-alert>\n          </b-card>\n\n          <b-card\n            style=\"color: #001e5f\"\n            v-if=\"userId != 0\"\n            border-variant=\"info\"\n            header=\"Verify email\"\n            header-bg-variant=\"info\"\n            header-text-variant=\"white\"\n            header-class=\"text-center\"\n          >\n            <b-form @submit.stop.prevent=\"verifyRegsToken\">\n              <b-form-group>\n                <label for=\"input-verification-code\">\n                  Enter the code we send to <strong>{{ userEmail }}.</strong> If\n                  it doesnâ€™t appear within a few minutes, check your spam folder\n                </label>\n                <b-form-input\n                  id=\"input-verification-code\"\n                  v-model=\"registerToken\"\n                  required\n                  :state=\"registerTokenValidation\"\n                />\n                <b-form-invalid-feedback :state=\"registerTokenValidation\">\n                  {{ codeVerificationMessage }}\n                </b-form-invalid-feedback>\n              </b-form-group>\n              <b-button type=\"submit\" variant=\"success\">\n                Submit\n              </b-button>\n              <div class=\"mt-4\">\n                you can resend the verification code if you have not received\n                the email.\n                <br />\n                <b-button\n                  class=\"mt-2\"\n                  size=\"sm\"\n                  variant=\"info\"\n                  @click=\"tryAgain\"\n                >\n                  Resend Email\n                </b-button>\n              </div>\n            </b-form>\n          </b-card>\n        </b-col>\n      </b-row>\n    </b-container>\n    <Footer class=\"mt-5\" />\n  </div>\n</template>\n\n<script>\nimport AuthenticationService from \"@/services/AuthenticationService.js\";\nimport TopHeader from \"@/components/Common/TopHeader.vue\";\nimport Footer from \"@/components/Common/Footer.vue\";\nexport default {\n  name: \"UserVerify\",\n  components: {\n    TopHeader,\n    Footer\n  },\n  data() {\n    return {\n      userId: 0,\n      userEmail: \"\",\n      registerTokenValidation: null,\n      codeVerificationMessage: \"\",\n      registerToken: \"\"\n    };\n  },\n  computed: {},\n  async mounted() {\n    this.userId = this.$store.state.CurrentUser.newUserId;\n    this.userEmail = this.$store.state.CurrentUser.newUserEmail;\n  },\n  methods: {\n    async tryAgain() {\n      try {\n        const user = (\n          await AuthenticationService.checkRegsToken({\n            email: this.userEmail,\n            password: this.$store.state.CurrentUser.newUserPassword\n          })\n        ).data;\n        if (user.verificationStatus) {\n          this.$router.push({ path: \"/login\" });\n        } else {\n          window.location.reload();\n        }\n      } catch (error) {\n        console.log(error.response.data.error);\n      }\n    },\n    async verifyRegsToken() {\n      var user;\n      try {\n        user = (\n          await AuthenticationService.verifyRegsToken({\n            userId: this.userId,\n            registerToken: this.registerToken\n          })\n        ).data;\n      } catch (error) {\n        this.registerTokenValidation = false;\n        this.codeVerificationMessage = error.response.data.error;\n      }\n      if (user) {\n        try {\n          await AuthenticationService.resetRegsToken({\n            id: user.user.id,\n            email: user.user.email,\n            name: user.user.firstName + \" \" + user.user.lastName\n          });\n          this.$store.dispatch(\"CurrentUser/setToken\", user.token);\n          this.$store.dispatch(\"CurrentUser/setUser\", user.user);\n          this.$store.dispatch(\"Wishlist/setWishlist\");\n          this.$store.dispatch(\"CurrentUser/setNewUserId\", 0);\n          this.$store.dispatch(\"CurrentUser/setNewUserEmail\", \"\");\n          this.$router.push({ path: \"/\" });\n        } catch (error) {\n          console.log(error.response.data.error);\n        }\n      }\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped></style>\n"]}]}