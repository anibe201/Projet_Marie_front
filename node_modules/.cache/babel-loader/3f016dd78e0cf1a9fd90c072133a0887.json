{"remainingRequest":"C:\\Users\\AlexisAnohVianneyANI\\Desktop\\emarket-main\\shop\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\AlexisAnohVianneyANI\\Desktop\\emarket-main\\shop\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\AlexisAnohVianneyANI\\Desktop\\emarket-main\\shop\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\AlexisAnohVianneyANI\\Desktop\\emarket-main\\shop\\src\\views\\Admin\\AUsers.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\AlexisAnohVianneyANI\\Desktop\\emarket-main\\shop\\src\\views\\Admin\\AUsers.vue","mtime":1667832798146},{"path":"C:\\Users\\AlexisAnohVianneyANI\\Desktop\\emarket-main\\shop\\babel.config.js","mtime":1645609201000},{"path":"C:\\Users\\AlexisAnohVianneyANI\\Desktop\\emarket-main\\shop\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1664720015241},{"path":"C:\\Users\\AlexisAnohVianneyANI\\Desktop\\emarket-main\\shop\\node_modules\\babel-loader\\lib\\index.js","mtime":1665053040434},{"path":"C:\\Users\\AlexisAnohVianneyANI\\Desktop\\emarket-main\\shop\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1664720015241},{"path":"C:\\Users\\AlexisAnohVianneyANI\\Desktop\\emarket-main\\shop\\node_modules\\vue-loader\\lib\\index.js","mtime":1665053078023}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IEFUb3BIZWFkZXIgZnJvbSAiQC9jb21wb25lbnRzL0FkbWlucy9BVG9wSGVhZGVyLnZ1ZSI7CmltcG9ydCBGb290ZXIgZnJvbSAiQC9jb21wb25lbnRzL0NvbW1vbi9Gb290ZXIudnVlIjsKaW1wb3J0IFVzZXJTZXJ2aWNlIGZyb20gIkAvc2VydmljZXMvVXNlclNlcnZpY2UuanMiOwppbXBvcnQgUmV2aWV3U2VydmljZSBmcm9tICJAL3NlcnZpY2VzL1Jldmlld1NlcnZpY2UuanMiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIkFVc2VycyIsCiAgY29tcG9uZW50czogewogICAgQVRvcEhlYWRlciwKICAgIEZvb3RlcgogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGFueVR5cGU6IHsKICAgICAgICBuYW1lOiAiQWxsIiwKICAgICAgICB2YXJpYW50OiAiZGFyayIKICAgICAgfSwKICAgICAgdXNlcklkOiAwLAogICAgICBzZWxlY3RlZFR5cGVOYW1lOiAiQWxsIiwKICAgICAgc2VsZWN0ZWRUeXBlVmFyaWFudDogImRhcmsiLAogICAgICBzZWFyY2hVc2VyVGV4dDogIiIsCiAgICAgIHVzZXJzOiAwLAogICAgICBzZWNvbmRVc2VyTGlzdDogW10sCiAgICAgIHVzZXJMaXN0OiBbXSwKICAgICAgdXNlckxpc3QyOiBbXSwKICAgICAgdXNlclN0YXR1czogW3sKICAgICAgICBuYW1lOiAiQWRtaW4iLAogICAgICAgIHByaW9yaXR5OiAxLAogICAgICAgIGRlc2NyaXB0aW9uOiAiT3duZXIgb2YgdGhpcyBzeXN0ZW0uIiwKICAgICAgICB2YXJpYW50OiAiZGFyayIKICAgICAgfSwgewogICAgICAgIG5hbWU6ICJDdXN0b21lciIsCiAgICAgICAgcHJpb3JpdHk6IDIsCiAgICAgICAgZGVzY3JpcHRpb246ICJFbmQgdXNlciBvZiB0aGUgc3lzdGVtLiIsCiAgICAgICAgdmFyaWFudDogIndhcm5pbmciCiAgICAgIH1dLAogICAgICBjdXJyZW50UGFnZTogMSwKICAgICAgcGVyUGFnZTogMjAKICAgIH07CiAgfSwKICBjb21wdXRlZDoge30sCiAgYXN5bmMgbW91bnRlZCgpIHsKICAgIHRyeSB7CiAgICAgIHRoaXMudXNlcklkID0gdGhpcy4kc3RvcmUuc3RhdGUuQ3VycmVudFVzZXIudXNlcklkOwogICAgICB0aGlzLnVzZXJMaXN0ID0gKGF3YWl0IFVzZXJTZXJ2aWNlLmdldFVzZXJMaXN0KCkpLmRhdGE7CiAgICAgIHRoaXMudXNlckxpc3QyID0gdGhpcy51c2VyTGlzdC5zbGljZSgpOwogICAgICBpZiAodGhpcy51c2VyTGlzdDIpIHsKICAgICAgICB0aGlzLnVzZXJzID0gdGhpcy51c2VyTGlzdDIubGVuZ3RoOwogICAgICAgIGNvbnN0IHN0YXJ0ID0gMDsKICAgICAgICB0aGlzLnNlY29uZFVzZXJMaXN0ID0gdGhpcy51c2VyTGlzdDIuc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgdGhpcy5wZXJQYWdlKTsKICAgICAgfQogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgY29uc29sZS5sb2coZXJyb3IucmVzcG9uc2UuZGF0YS5lcnJvcik7CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBzZWFyY2goKSB7CiAgICAgIGlmICh0aGlzLnNlbGVjdGVkVHlwZU5hbWUgIT0gIkFsbCIpIHsKICAgICAgICB0aGlzLnVzZXJMaXN0MiA9IHRoaXMudXNlckxpc3QyLmZpbHRlcih2YWwgPT4gewogICAgICAgICAgcmV0dXJuIHZhbC51c2VyVHlwZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHRoaXMuc2VsZWN0ZWRUeXBlTmFtZS50b0xvd2VyQ2FzZSgpKTsKICAgICAgICB9KTsKICAgICAgfQogICAgICB0aGlzLnVzZXJMaXN0MiA9IHRoaXMudXNlckxpc3QyLmZpbHRlcih2YWwgPT4gewogICAgICAgIHJldHVybiB2YWwuZmlyc3ROYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXModGhpcy5zZWFyY2hVc2VyVGV4dC50b0xvd2VyQ2FzZSgpKSB8fCB2YWwubGFzdE5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyh0aGlzLnNlYXJjaFVzZXJUZXh0LnRvTG93ZXJDYXNlKCkpIHx8IHZhbC5lbWFpbC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHRoaXMuc2VhcmNoVXNlclRleHQudG9Mb3dlckNhc2UoKSk7CiAgICAgIH0pOwogICAgICB0aGlzLnVzZXJzID0gdGhpcy51c2VyTGlzdDIubGVuZ3RoOwogICAgICBjb25zdCBzdGFydCA9IDA7CiAgICAgIHRoaXMuc2Vjb25kVXNlckxpc3QgPSB0aGlzLnVzZXJMaXN0Mi5zbGljZShzdGFydCwgc3RhcnQgKyB0aGlzLnBlclBhZ2UpOwogICAgfSwKICAgIHNlbGVjdFR5cGUoc3RhdHVzKSB7CiAgICAgIGlmIChzdGF0dXMubmFtZSA9PSAiQWxsIikgewogICAgICAgIHRoaXMuc2VhcmNoVXNlclRleHQgPSAiIjsKICAgICAgICB0aGlzLnNlbGVjdGVkVHlwZU5hbWUgPSBzdGF0dXMubmFtZTsKICAgICAgICB0aGlzLnNlbGVjdGVkVHlwZVZhcmlhbnQgPSBzdGF0dXMudmFyaWFudDsKICAgICAgICB0aGlzLnVzZXJMaXN0MiA9IHRoaXMudXNlckxpc3Quc2xpY2UoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnNlbGVjdGVkVHlwZU5hbWUgPSBzdGF0dXMubmFtZTsKICAgICAgICB0aGlzLnNlbGVjdGVkVHlwZVZhcmlhbnQgPSBzdGF0dXMudmFyaWFudDsKICAgICAgICB0aGlzLnVzZXJMaXN0MiA9IHRoaXMudXNlckxpc3QuZmlsdGVyKG9iaiA9PiBvYmoudXNlclR5cGUgPT0gc3RhdHVzLm5hbWUpOwogICAgICB9CiAgICAgIHRoaXMudXNlcnMgPSB0aGlzLnVzZXJMaXN0Mi5sZW5ndGg7CiAgICAgIGNvbnN0IHN0YXJ0ID0gMDsKICAgICAgdGhpcy5zZWNvbmRVc2VyTGlzdCA9IHRoaXMudXNlckxpc3QyLnNsaWNlKHN0YXJ0LCBzdGFydCArIHRoaXMucGVyUGFnZSk7CiAgICB9LAogICAgYXN5bmMgdXBkYXRlU3RhdHVzKHVzZXIsIHN0YXR1cykgewogICAgICBjb25zdCBpbmRleCA9IHRoaXMuc2Vjb25kVXNlckxpc3QuZmluZEluZGV4KG9iaiA9PiBvYmouaWQgPT09IHVzZXIuaWQpOwogICAgICB0aGlzLnNlY29uZFVzZXJMaXN0W2luZGV4XS51c2VyVHlwZSA9IHN0YXR1cy5uYW1lOwogICAgICB0aGlzLnNlY29uZFVzZXJMaXN0W2luZGV4XS52YXJpYW50ID0gc3RhdHVzLnZhcmlhbnQ7CiAgICAgIGF3YWl0IFVzZXJTZXJ2aWNlLnVwZGF0ZVVzZXIoewogICAgICAgIGlkOiB1c2VyLmlkLAogICAgICAgIHVzZXJUeXBlOiBzdGF0dXMubmFtZSwKICAgICAgICBwcmlvcml0eTogc3RhdHVzLnByaW9yaXR5LAogICAgICAgIHZhcmlhbnQ6IHN0YXR1cy52YXJpYW50CiAgICAgIH0pOwogICAgfSwKICAgIGFzeW5jIGRlbGV0ZUFjY291bnQodXNlcikgewogICAgICB2YXIgcmV2aWV3TGlzdCA9IFtdOwogICAgICB0cnkgewogICAgICAgIHJldmlld0xpc3QgPSAoYXdhaXQgUmV2aWV3U2VydmljZS5nZXRVc2Vyc1Jldmlld0xpc3QodXNlci5pZCkpLmRhdGE7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5sb2coZXJyb3IucmVzcG9uc2UuZGF0YS5lcnJvcik7CiAgICAgIH0KICAgICAgdmFyIGk7CiAgICAgIGZvciAoaSBpbiByZXZpZXdMaXN0KSB7CiAgICAgICAgYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goIlJldmlldy9kZWxldGVSZXZpZXciLCByZXZpZXdMaXN0W2ldKTsKICAgICAgfQogICAgICB0cnkgewogICAgICAgIGF3YWl0IFVzZXJTZXJ2aWNlLmRlbGV0ZUFjY291bnQodXNlci5pZCk7CiAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIHRoaXMuJGJ2VG9hc3QudG9hc3QoZXJyb3IucmVzcG9uc2UuZGF0YS5lcnJvciwgewogICAgICAgICAgdGl0bGU6ICJFcnJvciBkZWxldGluZyBBY2NvdW50IiwKICAgICAgICAgIHZhcmlhbnQ6ICJkYW5nZXIiLAogICAgICAgICAgdG9hc3RlcjogImItdG9hc3Rlci10b3AtY2VudGVyIiwKICAgICAgICAgIG5vQ2xvc2VCdXR0b246IGZhbHNlLAogICAgICAgICAgc29saWQ6IHRydWUKICAgICAgICB9KTsKICAgICAgICBjb25zb2xlLmxvZyhlcnJvci5yZXNwb25zZS5kYXRhLmVycm9yKTsKICAgICAgfQogICAgfSwKICAgIHBhZ2luYXRlKGN1cnJlbnRQYWdlKSB7CiAgICAgIGNvbnN0IHN0YXJ0ID0gKGN1cnJlbnRQYWdlIC0gMSkgKiB0aGlzLnBlclBhZ2U7CiAgICAgIHRoaXMuc2Vjb25kVXNlckxpc3QgPSB0aGlzLnVzZXJMaXN0Mi5zbGljZShzdGFydCwgc3RhcnQgKyB0aGlzLnBlclBhZ2UpOwogICAgfQogIH0KfTs="},{"version":3,"mappings":"AAkJA;AACA;AACA;AACA;AACA;EACAA;EACAC;IACAC;IACAC;EACA;EACAC;IACA;MACAC;QACAL;QACAM;MACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC,aACA;QACAf;QACAgB;QACAC;QACAX;MACA,GACA;QACAN;QACAgB;QACAC;QACAX;MACA,EACA;MACAY;MACAC;IACA;EACA;EACAC;EAEA;IACA;MACA;MACA;MACA;MACA;QACA;QACA;QACA;MACA;IACA;MACAC;IACA;EACA;EAEAC;IACAC;MACA;QACA;UACA,oBACAC,cACAC;QACA;MACA;MACA;QACA,OACAC,cACAF,cACAC,+CACAC,aACAF,cACAC,+CACAC;MAEA;MACA;MACA;MACA;IACA;IACAC;MACA;QACA;QACA;QACA;QACA;MACA;QACA;QACA;QACA,sCACAC,mCACA;MACA;MACA;MACA;MACA;IACA;IACA;MACA;MACA;MACA;MACA;QACAC;QACAC;QACAd;QACAV;MACA;IACA;IACA;MACA;MACA;QACAyB;MACA;QACAV;MACA;MACA;MACA;QACA;MACA;MAEA;QACA;QACAW;MACA;QACA;UACAC;UACA3B;UACA4B;UACAC;UACAC;QACA;QACAf;MACA;IACA;IACAgB;MACA;MACA;IACA;EACA;AACA","names":["name","components","ATopHeader","Footer","data","anyType","variant","userId","selectedTypeName","selectedTypeVariant","searchUserText","users","secondUserList","userList","userList2","userStatus","priority","description","currentPage","perPage","computed","console","methods","search","toLowerCase","includes","val","selectType","obj","id","userType","reviewList","window","title","toaster","noCloseButton","solid","paginate"],"sourceRoot":"src/views/Admin","sources":["AUsers.vue"],"sourcesContent":["<template>\n  <div>\n    <ATopHeader></ATopHeader>\n    <b-container class=\"mt-2\">\n      <b-row>\n        <b-col class=\"text-center\">\n          <h3>UTILISATEURS INSCRIT</h3>\n        </b-col>\n      </b-row>\n      <hr />\n      <b-row>\n        <b-col>\n          <b-row>\n            <b-col cols=\"8\" />\n            <b-col cols=\"4\">\n              <b-form inline @submit.prevent=\"search\">\n                <b-form-input\n                  v-model=\"searchUserText\"\n                  size=\"\"\n                  class=\"mr-sm-2\"\n                  placeholder=\"Rechercher utilisateur...\"\n                  @keyup.enter=\"search\"\n                />\n                <b-button @click=\"search\" variant=\"white\">\n                  <b-icon icon=\"search\"></b-icon\n                ></b-button>\n              </b-form>\n            </b-col>\n          </b-row>\n\n          <div v-if=\"users != 0\">\n            <hr />\n            <div>\n              <b-row>\n                <b-col> </b-col>\n                <b-col>\n                  <strong>Email</strong>\n                </b-col>\n                <b-col>\n                  <strong>Nom</strong>\n                </b-col>\n                <b-col>\n                  <strong>No. tél</strong>\n                </b-col>\n                <b-col class=\"text-center\">\n                  <strong>Statut</strong>\n                  <b-dropdown\n                    size=\"sm\"\n                    id=\"dropdown-left\"\n                    :text=\"selectedTypeName\"\n                    :variant=\"selectedTypeVariant\"\n                    class=\"ml-2\"\n                  >\n                    <b-dropdown-item @click=\"selectType(anyType)\">\n                      {{ anyType.name }}\n                    </b-dropdown-item>\n                    <b-dropdown-item\n                      v-for=\"(status, idx) in userStatus\"\n                      :key=\"idx\"\n                      @click=\"selectType(status)\"\n                    >\n                      {{ status.name }}\n                    </b-dropdown-item>\n                  </b-dropdown>\n                </b-col>\n              </b-row>\n              <hr />\n            </div>\n\n            <div v-for=\"user in secondUserList\" :key=\"user.id\">\n              <b-row>\n                <b-col>\n                  <b-img\n                    height=\"80px\"\n                    :src=\"user.profileImage\"\n                    alt=\"No Image\"\n                  />\n                </b-col>\n                <b-col>\n                  {{ user.email }}\n                </b-col>\n                <b-col>{{ user.firstName }} {{ user.lastName }}</b-col>\n                <b-col>{{ user.phoneNo }}</b-col>\n                <b-col>\n                  <b-row>\n                    <b-col cols=\"7\">\n                      <b-dropdown\n                        size=\"sm\"\n                        block\n                        id=\"dropdown-left\"\n                        :text=\"user.userType\"\n                        :variant=\"user.variant\"\n                      >\n                        <b-dropdown-item\n                          v-for=\"(status, idx) in userStatus\"\n                          :key=\"idx\"\n                          @click=\"updateStatus(user, status)\"\n                        >\n                          {{ status.name }}\n                        </b-dropdown-item>\n                      </b-dropdown>\n                    </b-col>\n                    <b-col cols=\"5\">\n                      <b-button\n                        size=\"sm\"\n                        block\n                        variant=\"danger\"\n                        v-if=\"user.id != userId\"\n                        @click=\"deleteAccount(user)\"\n                      >\n                        Delete\n                      </b-button>\n                      <b-button\n                        size=\"sm\"\n                        block\n                        to=\"/admin/profile\"\n                        v-if=\"user.id == userId\"\n                        variant=\"info\"\n                      >\n                        Profile\n                      </b-button>\n                    </b-col>\n                  </b-row>\n                </b-col>\n              </b-row>\n              <hr />\n            </div>\n          </div>\n          <div class=\"m-4 d-flex justify-content-center\" v-if=\"users == 0\">\n            <h3>Utilisateur non trouvé...</h3>\n          </div>\n          <b-pagination\n            v-if=\"users != 0\"\n            size=\"lg\"\n            v-model=\"currentPage\"\n            :total-rows=\"users\"\n            :per-page=\"perPage\"\n            @input=\"paginate(currentPage)\"\n          ></b-pagination>\n        </b-col>\n      </b-row>\n    </b-container>\n    <Footer class=\"mt-5\" />\n  </div>\n</template>\n<script>\nimport ATopHeader from \"@/components/Admins/ATopHeader.vue\";\nimport Footer from \"@/components/Common/Footer.vue\";\nimport UserService from \"@/services/UserService.js\";\nimport ReviewService from \"@/services/ReviewService.js\";\nexport default {\n  name: \"AUsers\",\n  components: {\n    ATopHeader,\n    Footer\n  },\n  data() {\n    return {\n      anyType: {\n        name: \"All\",\n        variant: \"dark\"\n      },\n      userId: 0,\n      selectedTypeName: \"All\",\n      selectedTypeVariant: \"dark\",\n      searchUserText: \"\",\n      users: 0,\n      secondUserList: [],\n      userList: [],\n      userList2: [],\n      userStatus: [\n        {\n          name: \"Admin\",\n          priority: 1,\n          description: \"Owner of this system.\",\n          variant: \"dark\"\n        },\n        {\n          name: \"Customer\",\n          priority: 2,\n          description: \"End user of the system.\",\n          variant: \"warning\"\n        }\n      ],\n      currentPage: 1,\n      perPage: 20\n    };\n  },\n  computed: {},\n\n  async mounted() {\n    try {\n      this.userId = this.$store.state.CurrentUser.userId;\n      this.userList = (await UserService.getUserList()).data;\n      this.userList2 = this.userList.slice();\n      if (this.userList2) {\n        this.users = this.userList2.length;\n        const start = 0;\n        this.secondUserList = this.userList2.slice(start, start + this.perPage);\n      }\n    } catch (error) {\n      console.log(error.response.data.error);\n    }\n  },\n\n  methods: {\n    search() {\n      if (this.selectedTypeName != \"All\") {\n        this.userList2 = this.userList2.filter(val => {\n          return val.userType\n            .toLowerCase()\n            .includes(this.selectedTypeName.toLowerCase());\n        });\n      }\n      this.userList2 = this.userList2.filter(val => {\n        return (\n          val.firstName\n            .toLowerCase()\n            .includes(this.searchUserText.toLowerCase()) ||\n          val.lastName\n            .toLowerCase()\n            .includes(this.searchUserText.toLowerCase()) ||\n          val.email.toLowerCase().includes(this.searchUserText.toLowerCase())\n        );\n      });\n      this.users = this.userList2.length;\n      const start = 0;\n      this.secondUserList = this.userList2.slice(start, start + this.perPage);\n    },\n    selectType(status) {\n      if (status.name == \"All\") {\n        this.searchUserText = \"\";\n        this.selectedTypeName = status.name;\n        this.selectedTypeVariant = status.variant;\n        this.userList2 = this.userList.slice();\n      } else {\n        this.selectedTypeName = status.name;\n        this.selectedTypeVariant = status.variant;\n        this.userList2 = this.userList.filter(\n          obj => obj.userType == status.name\n        );\n      }\n      this.users = this.userList2.length;\n      const start = 0;\n      this.secondUserList = this.userList2.slice(start, start + this.perPage);\n    },\n    async updateStatus(user, status) {\n      const index = this.secondUserList.findIndex(obj => obj.id === user.id);\n      this.secondUserList[index].userType = status.name;\n      this.secondUserList[index].variant = status.variant;\n      await UserService.updateUser({\n        id: user.id,\n        userType: status.name,\n        priority: status.priority,\n        variant: status.variant\n      });\n    },\n    async deleteAccount(user) {\n      var reviewList = [];\n      try {\n        reviewList = (await ReviewService.getUsersReviewList(user.id)).data;\n      } catch (error) {\n        console.log(error.response.data.error);\n      }\n      var i;\n      for (i in reviewList) {\n        await this.$store.dispatch(\"Review/deleteReview\", reviewList[i]);\n      }\n\n      try {\n        await UserService.deleteAccount(user.id);\n        window.location.reload();\n      } catch (error) {\n        this.$bvToast.toast(error.response.data.error, {\n          title: \"Error deleting Account\",\n          variant: \"danger\",\n          toaster: \"b-toaster-top-center\",\n          noCloseButton: false,\n          solid: true\n        });\n        console.log(error.response.data.error);\n      }\n    },\n    paginate(currentPage) {\n      const start = (currentPage - 1) * this.perPage;\n      this.secondUserList = this.userList2.slice(start, start + this.perPage);\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped></style>\n"]}]}