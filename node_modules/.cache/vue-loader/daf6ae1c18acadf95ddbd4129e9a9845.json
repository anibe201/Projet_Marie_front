{"remainingRequest":"C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\src\\components\\Checkout\\BuyItem.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\src\\components\\Checkout\\BuyItem.vue","mtime":1645609201000},{"path":"C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1664720015241},{"path":"C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\node_modules\\babel-loader\\lib\\index.js","mtime":1665053040434},{"path":"C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1664720015241},{"path":"C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\node_modules\\vue-loader\\lib\\index.js","mtime":1664810875252}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IGxvYWRTdHJpcGUgfSBmcm9tICJAc3RyaXBlL3N0cmlwZS1qcyI7CmNvbnN0IHN0cmlwZUluaXQgPSBsb2FkU3RyaXBlKAogICJwa190ZXN0XzUxSTRtYmlHVjNtTEFZSmVRMTNCQ1B0dDBiMERXTUhBSkFMaGRPYUFWcDJzQTVQMFdnalBjSDIxWml3OGZRcGJCbjhrWnNOZ1Q1MTN0N2h0UENEbHduZnpoMDBna1l5bFVWMSIKKTsKaW1wb3J0IENoZWNrb3V0U2VydmljZSBmcm9tICJAL3NlcnZpY2VzL0NoZWNrb3V0U2VydmljZS5qcyI7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIkJ1eUl0ZW0iLAogIGNvbXBvbmVudHM6IHt9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBzZWxlY3RlZEN1cnJlbmN5OiAiVVNEIiwKICAgICAgcGF5QnRuU3BpbjogZmFsc2UsCiAgICAgIHN1YlRvdGFsQW1vdW50OiAwLAogICAgICBmb3JtVmFsaWRhdGU6IHRydWUsCiAgICAgIG1lc3NhZ2U6ICJmb3JtIGRhdGEgaXMgbm90IHZhbGlkIiwKICAgICAgc2hpcHBpbmdSYXRlOiB0aGlzLiRzdG9yZS5zdGF0ZS5DaGVja291dC5zaGlwcGluZ1JhdGUsCiAgICAgIHRvdGFsQW1vdW50OiAwLAogICAgICBjaGVja291dFByb2R1Y3Q6IG51bGwKICAgIH07CiAgfSwKICBjb21wdXRlZDoge30sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuY2hlY2tvdXRQcm9kdWN0ID0gdGhpcy4kc3RvcmUuc3RhdGUuQ2FydC5jYXJ0UHJvZHVjdHM7CiAgICB2YXIgaTsKICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLmNoZWNrb3V0UHJvZHVjdC5sZW5ndGg7IGkrKykgewogICAgICB0aGlzLnN1YlRvdGFsQW1vdW50ICs9CiAgICAgICAgdGhpcy5jaGVja291dFByb2R1Y3RbaV0uYW1vdW50ICogdGhpcy5jaGVja291dFByb2R1Y3RbaV0ucXVhbnRpdHk7CiAgICB9CiAgICB0aGlzLnRvdGFsQW1vdW50ID0gdGhpcy5zdWJUb3RhbEFtb3VudCArIHRoaXMuc2hpcHBpbmdSYXRlOwogIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgY2hlY2tvdXRBcHBsaWVkKCkgewogICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKAogICAgICAgICJDaGVja291dC9pbmZvcm1hdGlvblZhbGlkYXRlIgogICAgICApOwogICAgICBpZiAoIXJlc3BvbnNlKSB7CiAgICAgICAgdGhpcy5mb3JtVmFsaWRhdGUgPSBmYWxzZTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdGhpcy5wYXlCdG5TcGluID0gdHJ1ZTsKICAgICAgY29uc3QgY3VzdG9tZXJOYW1lID0gcmVzcG9uc2UubmFtZTsKICAgICAgY29uc3QgY3VzdG9tZXJFbWFpbCA9IHJlc3BvbnNlLmVtYWlsOwogICAgICBjb25zdCBjdXN0b21lclBob25lTm8gPSByZXNwb25zZS5waG9uZU5vOwogICAgICBjb25zdCBzaGlwcGluZ0FkZHJlc3MgPSByZXNwb25zZS5zaGlwcGluZ0FkZHJlc3M7CiAgICAgIHZhciBpOwogICAgICB2YXIgY2hlY2tvdXRJdGVtcyA9IFtdOwogICAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5jaGVja291dFByb2R1Y3QubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YXIgb2JqID0gewogICAgICAgICAgY3VycmVuY3k6ICJVU0QiLAogICAgICAgICAgbmFtZTogdGhpcy5jaGVja291dFByb2R1Y3RbaV0udGl0bGUsCiAgICAgICAgICBkZXNjcmlwdGlvbjogdGhpcy5jaGVja291dFByb2R1Y3RbaV0ucHJvZHVjdElkLAogICAgICAgICAgYW1vdW50OiB0aGlzLmNoZWNrb3V0UHJvZHVjdFtpXS5hbW91bnQgKiAxMDAsCiAgICAgICAgICBxdWFudGl0eTogdGhpcy5jaGVja291dFByb2R1Y3RbaV0ucXVhbnRpdHkKICAgICAgICB9OwogICAgICAgIGNoZWNrb3V0SXRlbXMucHVzaChvYmopOwogICAgICB9CiAgICAgIGNoZWNrb3V0SXRlbXMucHVzaCh7CiAgICAgICAgbmFtZTogIlNoaXBwaW5nIENvc3QiLAogICAgICAgIGFtb3VudDogdGhpcy5zaGlwcGluZ1JhdGUgKiAxMDAsCiAgICAgICAgY3VycmVuY3k6ICJVU0QiLAogICAgICAgIHF1YW50aXR5OiAxCiAgICAgIH0pOwogICAgICB0cnkgewogICAgICAgIGNvbnN0IGNoZWNrb3V0U2Vzc2lvbiA9ICgKICAgICAgICAgIGF3YWl0IENoZWNrb3V0U2VydmljZS5jcmVhdGVDaGVja291dFNlc3Npb24oewogICAgICAgICAgICBjaGVja291dFByb2R1Y3Q6IGNoZWNrb3V0SXRlbXMsCiAgICAgICAgICAgIGN1c3RvbWVyTmFtZTogY3VzdG9tZXJOYW1lLAogICAgICAgICAgICBjdXN0b21lckVtYWlsOiBjdXN0b21lckVtYWlsLAogICAgICAgICAgICBjdXN0b21lclBob25lTm86IGN1c3RvbWVyUGhvbmVObywKICAgICAgICAgICAgc2hpcHBpbmdBZGRyZXNzOiBzaGlwcGluZ0FkZHJlc3MKICAgICAgICAgIH0pCiAgICAgICAgKS5kYXRhOwogICAgICAgIHN0cmlwZUluaXQudGhlbihzdHJpcGUgPT4gewogICAgICAgICAgc3RyaXBlCiAgICAgICAgICAgIC5yZWRpcmVjdFRvQ2hlY2tvdXQoewogICAgICAgICAgICAgIHNlc3Npb25JZDogY2hlY2tvdXRTZXNzaW9uLmlkCiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnJvcikgewogICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpOwogICAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmxvZyhlcnJvci5yZXNwb25zZS5kYXRhLmVycm9yKTsKICAgICAgfQogICAgfQogIH0KfTsK"},{"version":3,"sources":["BuyItem.vue"],"names":[],"mappings":";AAiHA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"BuyItem.vue","sourceRoot":"src/components/Checkout","sourcesContent":["<template>\n  <div>\n    <b-row>\n      <b-col\n        cols=\"6\"\n        v-for=\"product in checkoutProduct\"\n        :key=\"product.productId\"\n      >\n        <b-card-group deck>\n          <b-card img-top style=\"max-width: 14rem\" class=\"mb-4\">\n            <b-card-img\n              :src=\"product.image\"\n              style=\"max-width: 14rem; max-height: 14rem\"\n              alt=\"Image Not Found\"\n            />\n            <br />\n            <b-link :to=\"{ path: `/product/${product.productId}` }\">\n              {{ product.title }}\n            </b-link>\n            <br />\n            <small class=\"mt-2\">\n              Price: {{ product.amount }} {{ product.currency }}\n            </small>\n            <br />\n            <small class=\"mt-2\">Quantity: {{ product.quantity }}</small>\n            <br />\n            <small class=\"mt-2\">\n              Cost: {{ product.amount * product.quantity }}\n              {{ product.currency }}\n            </small>\n          </b-card>\n        </b-card-group>\n      </b-col>\n    </b-row>\n    <b-row class=\"mt-5\">\n      <b-col cols=\"2\" />\n      <b-col cols=\"10\">\n        <b-card class=\"mt-5\" v-if=\"subTotalAmount != 0\">\n          <b-row>\n            <b-col cols=\"8\">\n              <h5>Sub-Total</h5>\n            </b-col>\n            <b-col cols=\"4\">\n              <b-card-text>\n                {{ subTotalAmount }} {{ selectedCurrency }}\n              </b-card-text>\n            </b-col>\n          </b-row>\n          <b-row>\n            <b-col cols=\"8\">\n              <h5>Shipping Rate</h5>\n            </b-col>\n            <b-col cols=\"4\">\n              <b-card-text>\n                {{ shippingRate }} {{ selectedCurrency }}\n              </b-card-text>\n            </b-col>\n          </b-row>\n          <hr />\n          <b-row>\n            <b-col cols=\"8\">\n              <h5>Total</h5>\n            </b-col>\n            <b-col cols=\"4\">\n              <b-card-text>\n                {{ totalAmount }} {{ selectedCurrency }}\n              </b-card-text>\n            </b-col>\n          </b-row>\n        </b-card>\n      </b-col>\n    </b-row>\n    <b-row>\n      <b-col>\n        <b-alert\n          variant=\"primary\"\n          class=\"mb-0 mt-5 p-1 pl-2\"\n          :show=\"!formValidate\"\n        >\n          {{ message }}\n        </b-alert>\n      </b-col>\n    </b-row>\n    <b-row class=\"mt-4\" v-if=\"subTotalAmount != 0\">\n      <b-col cols=\"5\">\n        <b-button block variant=\"warning\" to=\"/cart-view\">Edit Cart</b-button>\n      </b-col>\n      <b-col cols=\"2\" />\n      <b-col>\n        <b-button\n          v-if=\"!payBtnSpin\"\n          @click=\"checkoutApplied\"\n          block\n          variant=\"success\"\n        >\n          <b-icon icon=\"cursor-fill\" />\n          Pay Now\n        </b-button>\n        <b-button v-if=\"payBtnSpin\" block variant=\"success\">\n          Processing...\n          <b-spinner small variant=\"light\"></b-spinner>\n        </b-button>\n      </b-col>\n    </b-row>\n    <b-row v-if=\"subTotalAmount == 0\">\n      <b-col class=\"text-center\">\n        <h4>No Product to Buy!!!</h4>\n      </b-col>\n    </b-row>\n  </div>\n</template>\n\n<script>\nimport { loadStripe } from \"@stripe/stripe-js\";\nconst stripeInit = loadStripe(\n  \"pk_test_51I4mbiGV3mLAYJeQ13BCPtt0b0DWMHAJALhdOaAVp2sA5P0WgjPcH21Ziw8fQpbBn8kZsNgT513t7htPCDlwnfzh00gkYylUV1\"\n);\nimport CheckoutService from \"@/services/CheckoutService.js\";\n\nexport default {\n  name: \"BuyItem\",\n  components: {},\n  data() {\n    return {\n      selectedCurrency: \"USD\",\n      payBtnSpin: false,\n      subTotalAmount: 0,\n      formValidate: true,\n      message: \"form data is not valid\",\n      shippingRate: this.$store.state.Checkout.shippingRate,\n      totalAmount: 0,\n      checkoutProduct: null\n    };\n  },\n  computed: {},\n  mounted() {\n    this.checkoutProduct = this.$store.state.Cart.cartProducts;\n    var i;\n    for (i = 0; i < this.checkoutProduct.length; i++) {\n      this.subTotalAmount +=\n        this.checkoutProduct[i].amount * this.checkoutProduct[i].quantity;\n    }\n    this.totalAmount = this.subTotalAmount + this.shippingRate;\n  },\n  methods: {\n    async checkoutApplied() {\n      const response = await this.$store.dispatch(\n        \"Checkout/informationValidate\"\n      );\n      if (!response) {\n        this.formValidate = false;\n        return;\n      }\n      this.payBtnSpin = true;\n      const customerName = response.name;\n      const customerEmail = response.email;\n      const customerPhoneNo = response.phoneNo;\n      const shippingAddress = response.shippingAddress;\n      var i;\n      var checkoutItems = [];\n      for (i = 0; i < this.checkoutProduct.length; i++) {\n        var obj = {\n          currency: \"USD\",\n          name: this.checkoutProduct[i].title,\n          description: this.checkoutProduct[i].productId,\n          amount: this.checkoutProduct[i].amount * 100,\n          quantity: this.checkoutProduct[i].quantity\n        };\n        checkoutItems.push(obj);\n      }\n      checkoutItems.push({\n        name: \"Shipping Cost\",\n        amount: this.shippingRate * 100,\n        currency: \"USD\",\n        quantity: 1\n      });\n      try {\n        const checkoutSession = (\n          await CheckoutService.createCheckoutSession({\n            checkoutProduct: checkoutItems,\n            customerName: customerName,\n            customerEmail: customerEmail,\n            customerPhoneNo: customerPhoneNo,\n            shippingAddress: shippingAddress\n          })\n        ).data;\n        stripeInit.then(stripe => {\n          stripe\n            .redirectToCheckout({\n              sessionId: checkoutSession.id\n            })\n            .catch(function(error) {\n              console.error(error);\n            });\n        });\n      } catch (error) {\n        console.log(error.response.data.error);\n      }\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped></style>\n"]}]}