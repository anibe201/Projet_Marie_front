{"remainingRequest":"C:\\Users\\AlexisAnohVianneyANI\\Desktop\\emarket-main\\shop\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\AlexisAnohVianneyANI\\Desktop\\emarket-main\\shop\\src\\components\\ProductDetails\\Review.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\AlexisAnohVianneyANI\\Desktop\\emarket-main\\shop\\src\\components\\ProductDetails\\Review.vue","mtime":1668157351501},{"path":"C:\\Users\\AlexisAnohVianneyANI\\Desktop\\emarket-main\\shop\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1664720015241},{"path":"C:\\Users\\AlexisAnohVianneyANI\\Desktop\\emarket-main\\shop\\node_modules\\babel-loader\\lib\\index.js","mtime":1665053040434},{"path":"C:\\Users\\AlexisAnohVianneyANI\\Desktop\\emarket-main\\shop\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1664720015241},{"path":"C:\\Users\\AlexisAnohVianneyANI\\Desktop\\emarket-main\\shop\\node_modules\\vue-loader\\lib\\index.js","mtime":1665053078023}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBSZXZpZXdTZXJ2aWNlIGZyb20gIkAvc2VydmljZXMvUmV2aWV3U2VydmljZS5qcyI7CmltcG9ydCBQcm9kdWN0c1NlcnZpY2UgZnJvbSAiQC9zZXJ2aWNlcy9Qcm9kdWN0c1NlcnZpY2UuanMiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIlJldmlldyIsCiAgY29tcG9uZW50czoge30sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHplcm9TdGFyOiAwLAogICAgICB6ZXJvU3RhclBlcmNlbnQ6IDAsCiAgICAgIG9uZVN0YXI6IDAsCiAgICAgIG9uZVN0YXJQZXJjZW50OiAwLAogICAgICB0d29TdGFyOiAwLAogICAgICB0d29TdGFyUGVyY2VudDogMCwKICAgICAgdGhyZWVTdGFyOiAwLAogICAgICB0aHJlZVN0YXJQZXJjZW50OiAwLAogICAgICBmb3VyU3RhcjogMCwKICAgICAgZm91clN0YXJQZXJjZW50OiAwLAogICAgICBmaXZlU3RhcjogMCwKICAgICAgZml2ZVN0YXJQZXJjZW50OiAwLAogICAgICByYXRpbmdDb3VudDogMCwKICAgICAgYXZlcmFnZVJhdGluZzogMCwKICAgICAgY29tbWVudENvdW50OiAwLAogICAgICBjdXJyZW50VXNlclJldmlldzoge30sCiAgICAgIHVzZXJSZXZpZXdGbGFnOiBmYWxzZSwKICAgICAgdXNlcklkOiAwLAogICAgICBhZG1pbjogZmFsc2UsCiAgICAgIHVzZXJMb2dnZWRJbjogZmFsc2UsCiAgICAgIHJhdGluZzogMCwKICAgICAgY29tbWVudDogIiIsCiAgICAgIHJldmlld0VkaXRpbmc6IHt9LAogICAgICBlZGl0UmF0aW5nOiAwLAogICAgICBlZGl0Q29tbWVudDogIiIsCiAgICAgIHByb2R1Y3RJZDogMCwKICAgICAgY3VycmVudFBhZ2U6IDEsCiAgICAgIHBlclBhZ2U6IDMsCiAgICAgIHJldmlld3M6IDAsCiAgICAgIHByb2R1Y3RSYXRpbmc6IHt9LAogICAgICByZXZpZXdMaXN0OiBbXSwKICAgICAgcmV2aWV3TGlzdDI6IFtdCiAgICB9OwogIH0sCiAgYXN5bmMgbW91bnRlZCgpIHsKICAgIHRoaXMudXNlcklkID0gdGhpcy4kc3RvcmUuc3RhdGUuQ3VycmVudFVzZXIudXNlcklkOwogICAgdGhpcy5hZG1pbiA9IHRoaXMuJHN0b3JlLnN0YXRlLkN1cnJlbnRVc2VyLmFkbWluOwogICAgdGhpcy51c2VyTG9nZ2VkSW4gPSB0aGlzLiRzdG9yZS5zdGF0ZS5DdXJyZW50VXNlci51c2VyTG9nZ2VkSW47CiAgICB0aGlzLnByb2R1Y3RJZCA9IHBhcnNlSW50KHRoaXMuJHJvdXRlLnBhcmFtcy5wcm9kdWN0SWQpOwogICAgdHJ5IHsKICAgICAgdGhpcy5wcm9kdWN0UmF0aW5nID0gKAogICAgICAgIGF3YWl0IFByb2R1Y3RzU2VydmljZS5nZXRQcm9kdWN0UmF0aW5nKHRoaXMucHJvZHVjdElkKQogICAgICApLmRhdGE7CiAgICB9IGNhdGNoIChlcnJvcikgewogICAgICBjb25zb2xlLmxvZyhlcnJvci5yZXNwb25zZS5kYXRhLmVycm9yKTsKICAgIH0KICAgIHRyeSB7CiAgICAgIHRoaXMucmV2aWV3TGlzdCA9ICgKICAgICAgICBhd2FpdCBSZXZpZXdTZXJ2aWNlLmdldFJldmlld0xpc3QodGhpcy5wcm9kdWN0SWQpCiAgICAgICkuZGF0YTsKICAgICAgaWYgKHRoaXMucmV2aWV3TGlzdCkgewogICAgICAgIHRoaXMucmV2aWV3cyA9IHRoaXMucmV2aWV3TGlzdC5sZW5ndGg7CiAgICAgICAgY29uc3Qgc3RhcnQgPSAwOwogICAgICAgIHRoaXMucmV2aWV3TGlzdDIgPSB0aGlzLnJldmlld0xpc3Quc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgdGhpcy5wZXJQYWdlKTsKICAgICAgfQogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgY29uc29sZS5sb2coZXJyb3IucmVzcG9uc2UuZGF0YS5lcnJvcik7CiAgICB9CiAgICB2YXIgaTsKICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLnJldmlld0xpc3QubGVuZ3RoOyBpKyspIHsKICAgICAgaWYgKHRoaXMucmV2aWV3TGlzdFtpXS5jb21tZW50ICE9ICIiKSB0aGlzLmNvbW1lbnRDb3VudCsrOwogICAgICBpZiAodGhpcy5yZXZpZXdMaXN0W2ldLnJhdGluZyA9PSAwKSB0aGlzLnplcm9TdGFyKys7CiAgICAgIGVsc2UgaWYgKHRoaXMucmV2aWV3TGlzdFtpXS5yYXRpbmcgPT0gMSkgdGhpcy5vbmVTdGFyKys7CiAgICAgIGVsc2UgaWYgKHRoaXMucmV2aWV3TGlzdFtpXS5yYXRpbmcgPT0gMikgdGhpcy50d29TdGFyKys7CiAgICAgIGVsc2UgaWYgKHRoaXMucmV2aWV3TGlzdFtpXS5yYXRpbmcgPT0gMykgdGhpcy50aHJlZVN0YXIrKzsKICAgICAgZWxzZSBpZiAodGhpcy5yZXZpZXdMaXN0W2ldLnJhdGluZyA9PSA0KSB0aGlzLmZvdXJTdGFyKys7CiAgICAgIGVsc2UgaWYgKHRoaXMucmV2aWV3TGlzdFtpXS5yYXRpbmcgPT0gNSkgdGhpcy5maXZlU3RhcisrOwoKICAgICAgaWYgKHRoaXMucmV2aWV3TGlzdFtpXS5Vc2VySWQgPT0gdGhpcy51c2VySWQpCiAgICAgICAgdGhpcy5jdXJyZW50VXNlclJldmlldyA9IHRoaXMucmV2aWV3TGlzdFtpXTsKICAgICAgdGhpcy51c2VyUmV2aWV3RmxhZyA9IE9iamVjdC5rZXlzKHRoaXMuY3VycmVudFVzZXJSZXZpZXcpLmxlbmd0aCAhPSAwOwogICAgICBpZiAoIXRoaXMucmV2aWV3TGlzdFtpXS5tb2RlKSB7CiAgICAgICAgdGhpcy5yZXZpZXdMaXN0W2ldLm1vZGUgPSAwOwogICAgICB9CiAgICB9CiAgICB0aGlzLnJhdGluZ0NvdW50ID0KICAgICAgdGhpcy5vbmVTdGFyICsKICAgICAgdGhpcy50d29TdGFyICsKICAgICAgdGhpcy50aHJlZVN0YXIgKwogICAgICB0aGlzLmZvdXJTdGFyICsKICAgICAgdGhpcy5maXZlU3RhcjsKICAgIGlmICh0aGlzLnJhdGluZ0NvdW50ICE9IDApIHsKICAgICAgdGhpcy5hdmVyYWdlUmF0aW5nID0KICAgICAgICBNYXRoLnJvdW5kKAogICAgICAgICAgKDEwICoKICAgICAgICAgICAgKDUgKiB0aGlzLmZpdmVTdGFyICsKICAgICAgICAgICAgICA0ICogdGhpcy5mb3VyU3RhciArCiAgICAgICAgICAgICAgMyAqIHRoaXMudGhyZWVTdGFyICsKICAgICAgICAgICAgICAyICogdGhpcy50d29TdGFyICsKICAgICAgICAgICAgICAxICogdGhpcy5vbmVTdGFyKSkgLwogICAgICAgICAgICB0aGlzLnJhdGluZ0NvdW50CiAgICAgICAgKSAvIDEwOwogICAgICB0aGlzLm9uZVN0YXJQZXJjZW50ID0gTWF0aC5yb3VuZCgodGhpcy5vbmVTdGFyICogMTAwKSAvIHRoaXMucmF0aW5nQ291bnQpOwogICAgICB0aGlzLnR3b1N0YXJQZXJjZW50ID0gTWF0aC5yb3VuZCgodGhpcy50d29TdGFyICogMTAwKSAvIHRoaXMucmF0aW5nQ291bnQpOwogICAgICB0aGlzLnRocmVlU3RhclBlcmNlbnQgPSBNYXRoLnJvdW5kKAogICAgICAgICh0aGlzLnRocmVlU3RhciAqIDEwMCkgLyB0aGlzLnJhdGluZ0NvdW50CiAgICAgICk7CiAgICAgIHRoaXMuZm91clN0YXJQZXJjZW50ID0gTWF0aC5yb3VuZCgKICAgICAgICAodGhpcy5mb3VyU3RhciAqIDEwMCkgLyB0aGlzLnJhdGluZ0NvdW50CiAgICAgICk7CiAgICAgIHRoaXMuZml2ZVN0YXJQZXJjZW50ID0gTWF0aC5yb3VuZCgKICAgICAgICAodGhpcy5maXZlU3RhciAqIDEwMCkgLyB0aGlzLnJhdGluZ0NvdW50CiAgICAgICk7CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBwYWdpbmF0ZShjdXJyZW50UGFnZSkgewogICAgICBjb25zdCBzdGFydCA9IChjdXJyZW50UGFnZSAtIDEpICogdGhpcy5wZXJQYWdlOwogICAgICB0aGlzLnJldmlld0xpc3QyID0gdGhpcy5yZXZpZXdMaXN0LnNsaWNlKHN0YXJ0LCBzdGFydCArIHRoaXMucGVyUGFnZSk7CiAgICB9LAogICAgYXN5bmMgY3JlYXRlUmV2aWV3KCkgewogICAgICBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgiUmV2aWV3L2NyZWF0ZVJldmlldyIsIHsKICAgICAgICByYXRpbmc6IHRoaXMucmF0aW5nLAogICAgICAgIGNvbW1lbnQ6IHRoaXMuY29tbWVudCwKICAgICAgICBwcm9kdWN0SWQ6IHRoaXMucHJvZHVjdElkLAogICAgICAgIHByb2R1Y3RSYXRpbmc6IHRoaXMucHJvZHVjdFJhdGluZwogICAgICB9KTsKICAgICAgYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goIlByb2R1Y3RzL3NldEFsbEJhY2t1cFByb2R1Y3RzIik7CiAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTsKICAgIH0sCgogICAgZWRpdFJldmlldyhyZXZpZXcpIHsKICAgICAgdGhpcy5lZGl0UmF0aW5nID0gcmV2aWV3LnJhdGluZzsKICAgICAgdGhpcy5lZGl0Q29tbWVudCA9IHJldmlldy5jb21tZW50OwogICAgICB0aGlzLnJldmlld0VkaXRpbmcgPSByZXZpZXc7CiAgICAgIHRoaXMuJGJ2TW9kYWwuc2hvdygiZWRpdFJldmlld01vZGFsIik7CiAgICB9LAogICAgYXN5bmMgdXBkYXRlUmV2aWV3KCkgewogICAgICB0aGlzLiRidk1vZGFsLmhpZGUoImVkaXRSZXZpZXdNb2RhbCIpOwogICAgICBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgiUmV2aWV3L3VwZGF0ZVJldmlldyIsIHsKICAgICAgICByZXZpZXc6IHRoaXMucmV2aWV3RWRpdGluZywKICAgICAgICBuZXdSYXRpbmc6IHRoaXMuZWRpdFJhdGluZywKICAgICAgICBuZXdDb21tZW50OiB0aGlzLmVkaXRDb21tZW50CiAgICAgIH0pOwogICAgICBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgiUHJvZHVjdHMvc2V0QWxsQmFja3VwUHJvZHVjdHMiKTsKICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpOwogICAgfSwKCiAgICBhc3luYyBkZWxldGVSZXZpZXcocmV2aWV3KSB7CiAgICAgIGlmICh0aGlzLnVzZXJMb2dnZWRJbikgewogICAgICAgIGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCJSZXZpZXcvZGVsZXRlUmV2aWV3IiwgcmV2aWV3KTsKICAgICAgICBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgiUHJvZHVjdHMvc2V0QWxsQmFja3VwUHJvZHVjdHMiKTsKICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7CiAgICAgIH0KICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["Review.vue"],"names":[],"mappings":";AA8UA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Review.vue","sourceRoot":"src/components/ProductDetails","sourcesContent":["<template>\n  <div>\n    <b-row align-v=\"center\">\n      <b-col />\n      <b-col cols=\"4\" class=\"text-center\">\n        <b-card class=\"py-4\">\n          <br />\n          <strong>\n            <span>{{ averageRating }}</span>\n            <span>/5</span>\n          </strong>\n          <b-row class=\"mt-2\">\n            <b-col cols=\"2\" />\n            <b-col cols=\"8\">\n              <b-form-rating\n                readonly\n                :value=\"averageRating\"\n                variant=\"primary\"\n              />\n            </b-col>\n            <b-col cols=\"2\" />\n          </b-row>\n          <h6 class=\"mt-2\">\n            {{ ratingCount }}\n            {{ ratingCount >= 1 ? \"étoile\" : \"étoiles\" }} -\n            <!-- &amp; -->\n            {{ commentCount }} {{ commentCount >= 1 ? \"commentaire\" : \"commentaires\" }}\n          </h6>\n          <br />\n        </b-card>\n      </b-col>\n      <b-col cols=\"4\" class=\"justify-content-center\">\n        <b-row align-v=\"center\" class=\"my-2\">\n          <b-col cols=\"2\">\n            <small>5 étoiles</small>\n          </b-col>\n          <b-col cols=\"7\">\n            <b-progress variant=\"primary\">\n              <b-progress-bar\n                :value=\"fiveStarPercent\"\n                :label=\"`${fiveStar}`\"\n              ></b-progress-bar>\n            </b-progress>\n          </b-col>\n          <b-col cols=\"3\">\n            <small\n              >{{ fiveStarPercent }} <b-icon icon=\"percent\"></b-icon\n            ></small>\n          </b-col>\n        </b-row>\n\n        <b-row align-v=\"center\" class=\"my-2\">\n          <b-col cols=\"2\">\n            <small>4 étoiles</small>\n          </b-col>\n          <b-col cols=\"7\">\n            <b-progress variant=\"primary\">\n              <b-progress-bar\n                :value=\"fourStarPercent\"\n                :label=\"`${fourStar}`\"\n              ></b-progress-bar>\n            </b-progress>\n          </b-col>\n          <b-col cols=\"3\">\n            <small>\n              {{ fourStarPercent }}\n              <b-icon icon=\"percent\"></b-icon>\n            </small>\n          </b-col>\n        </b-row>\n\n        <b-row align-v=\"center\" class=\"my-2\">\n          <b-col cols=\"2\">\n            <small>3 étoiles</small>\n          </b-col>\n          <b-col cols=\"7\">\n            <b-progress variant=\"primary\">\n              <b-progress-bar\n                :value=\"threeStarPercent\"\n                :label=\"`${threeStar}`\"\n              ></b-progress-bar>\n            </b-progress>\n          </b-col>\n          <b-col cols=\"3\">\n            <small\n              >{{ threeStarPercent }} <b-icon icon=\"percent\"></b-icon\n            ></small>\n          </b-col>\n        </b-row>\n\n        <b-row align-v=\"center\" class=\"my-2\">\n          <b-col cols=\"2\">\n            <small>2 étoiles</small>\n          </b-col>\n          <b-col cols=\"7\">\n            <b-progress variant=\"primary\">\n              <b-progress-bar\n                :value=\"twoStarPercent\"\n                :label=\"`${twoStar}`\"\n              ></b-progress-bar>\n            </b-progress>\n          </b-col>\n          <b-col cols=\"3\">\n            <small>{{ twoStarPercent }} <b-icon icon=\"percent\"></b-icon></small>\n          </b-col>\n        </b-row>\n\n        <b-row align-v=\"center\" class=\"my-2\">\n          <b-col cols=\"2\">\n            <small>1 étoile</small>\n          </b-col>\n          <b-col cols=\"7\">\n            <b-progress variant=\"primary\">\n              <b-progress-bar\n                :value=\"oneStarPercent\"\n                :label=\"`${oneStar}`\"\n              ></b-progress-bar>\n            </b-progress>\n          </b-col>\n          <b-col cols=\"3\">\n            <small>{{ oneStarPercent }} <b-icon icon=\"percent\"></b-icon></small>\n          </b-col>\n        </b-row>\n      </b-col>\n      <b-col />\n    </b-row>\n\n    <hr />\n    <b-row>\n      <b-col cols=\"6\">\n        <h4>Avis des clients</h4>\n        <hr />\n        <div v-for=\"review in reviewList2\" :key=\"review.id\" class=\"mb-2\">\n          <b-card\n            bg-variant=\"white\"\n            text-variant=\"dark\"\n            v-if=\"review.comment != null && review.UserId != userId\"\n          >\n            <b-row>\n              <b-col cols=\"3\">\n                <b-img\n                  :src=\"review.User.profileImage\"\n                  height=\"60px\"\n                  width=\"60px\"\n                />\n                <div class=\"mt-3\">\n                  <b-link>\n                    {{ review.User.firstName + \" \" + review.User.lastName }}\n                  </b-link>\n                </div>\n              </b-col>\n              <b-col cols=\"9\">\n                <b-row>\n                  <b-col cols=\"7\">\n                    <b-form-rating\n                      readonly\n                      :value=\"review.rating\"\n                      variant=\"primary\"\n                    />\n                  </b-col>\n                </b-row>\n                <b-row class=\"mt-2\">\n                  <b-col>\n                    <p>{{ review.comment }}</p>\n                  </b-col>\n                </b-row>\n                <b-row>\n                  <b-col>\n                    <small class=\"mr-2\">\n                      <b-link\n                        v-if=\"userId == review.UserId\"\n                        @click=\"editReview(review)\"\n                      >\n                        edit\n                      </b-link>\n                    </small>\n                    <small>\n                      <b-link\n                        v-if=\"userId == review.UserId || admin\"\n                        @click=\"deleteReview(review)\"\n                      >\n                      <b-button>\n                        Supprimer\n                      </b-button>  \n                      </b-link>\n                    </small>\n                  </b-col>\n                </b-row>\n              </b-col>\n            </b-row>\n          </b-card>\n        </div>\n        <b-pagination\n          v-if=\"reviews > perPage\"\n          size=\"md\"\n          v-model=\"currentPage\"\n          :total-rows=\"reviews\"\n          :per-page=\"perPage\"\n          @input=\"paginate(currentPage)\"\n        ></b-pagination>\n      </b-col>\n      <b-col cols=\"6\">\n        <b-card bg-variant=\"white\" text-variant=\"dark\" v-if=\"userReviewFlag\">\n          <b-card-title> Votre avis </b-card-title>\n          <b-row>\n            <b-col cols=\"4\">\n              <b-img\n                :src=\"currentUserReview.User.profileImage\"\n                height=\"90px\"\n                width=\"90px\"\n              />\n              <div class=\"mt-2\">\n                <b-link>\n                  {{\n                    currentUserReview.User.firstName +\n                      \" \" +\n                      currentUserReview.User.lastName\n                  }}\n                </b-link>\n              </div>\n            </b-col>\n            <b-col cols=\"8\">\n              <b-row>\n                <b-col cols=\"7\">\n                  <b-form-rating\n                    readonly\n                    :value=\"currentUserReview.rating\"\n                    variant=\"primary\"\n                  />\n                </b-col>\n              </b-row>\n              <b-row class=\"mt-2\">\n                <b-col>\n                  <p>{{ currentUserReview.comment }}</p>\n                </b-col>\n              </b-row>\n              <b-row>\n                <b-col>\n                  <small class=\"mr-2\">\n                    <b-link @click=\"editReview(currentUserReview)\">\n                      <b-button>\n                        Modifier\n                      </b-button>  \n                    </b-link>\n                  </small>\n                  <small>\n                    <b-link @click=\"deleteReview(currentUserReview)\">\n                      <b-button>\n                        Supprimer\n                      </b-button>  \n                    </b-link>\n                  </small>\n                </b-col>\n              </b-row>\n            </b-col>\n          </b-row>\n        </b-card>\n        <b-card v-if=\"!userReviewFlag\">\n          <div class=\"mt-2 ml-3\">\n            <a variant=\"primary\">\n              <b-icon-pen />&nbsp;<strong>Donnez votre avis</strong>\n            </a>\n          </div>\n          <hr />\n          <b-form v-if=\"userLoggedIn\" @submit.stop.prevent=\"createReview\">\n            <b-row>\n              <b-col cols=\"5\">\n                <h6>Etoile</h6>\n                <b-form-rating v-model=\"rating\" variant=\"primary\" />\n              </b-col>\n            </b-row>\n            <div class=\"mt-4\">\n              Commentaire\n            </div>\n            <b-form-group>\n              <b-form-textarea\n                required\n                v-model=\"comment\"\n                placeholder=\"Laisser un commentaire ici\"\n                rows=\"3\"\n                max-rows=\"8\"\n              />\n            </b-form-group>\n            <b-button variant=\"primary\" type=\"submit\">\n              Envoyer\n            </b-button>\n          </b-form>\n          <div v-if=\"!userLoggedIn\">\n            connectez vous d'abord avant de donner votre avis.\n            <b-row>\n              <b-col>\n                <b-button to=\"/login\" class=\"mt-3\" variant=\"outline-dark\">\n                  Se connecter\n                </b-button>\n              </b-col>\n            </b-row>\n          </div>\n        </b-card>\n      </b-col>\n    </b-row>\n    <b-modal\n      v-if=\"userLoggedIn\"\n      hide-footer\n      id=\"editReviewModal\"\n      title=\"Write a review\"\n    >\n      <b-form @submit.stop.prevent=\"updateReview\">\n        <b-row>\n          <b-col cols=\"5\">\n            <h6>Etoile</h6>\n            <b-form-rating v-model=\"editRating\" variant=\"primary\" />\n          </b-col>\n        </b-row>\n        <div class=\"mt-4\">\n          Commentaire\n        </div>\n        <b-form-group>\n          <b-form-textarea\n            v-model=\"editComment\"\n            placeholder=\"Ecrire un commentaire\"\n            rows=\"3\"\n            required\n            max-rows=\"10\"\n          />\n        </b-form-group>\n        <b-button type=\"submit\" variant=\"primary\">\n          Modifier\n        </b-button>\n      </b-form>\n    </b-modal>\n  </div>\n</template>\n\n<script>\nimport ReviewService from \"@/services/ReviewService.js\";\nimport ProductsService from \"@/services/ProductsService.js\";\nexport default {\n  name: \"Review\",\n  components: {},\n  data() {\n    return {\n      zeroStar: 0,\n      zeroStarPercent: 0,\n      oneStar: 0,\n      oneStarPercent: 0,\n      twoStar: 0,\n      twoStarPercent: 0,\n      threeStar: 0,\n      threeStarPercent: 0,\n      fourStar: 0,\n      fourStarPercent: 0,\n      fiveStar: 0,\n      fiveStarPercent: 0,\n      ratingCount: 0,\n      averageRating: 0,\n      commentCount: 0,\n      currentUserReview: {},\n      userReviewFlag: false,\n      userId: 0,\n      admin: false,\n      userLoggedIn: false,\n      rating: 0,\n      comment: \"\",\n      reviewEditing: {},\n      editRating: 0,\n      editComment: \"\",\n      productId: 0,\n      currentPage: 1,\n      perPage: 3,\n      reviews: 0,\n      productRating: {},\n      reviewList: [],\n      reviewList2: []\n    };\n  },\n  async mounted() {\n    this.userId = this.$store.state.CurrentUser.userId;\n    this.admin = this.$store.state.CurrentUser.admin;\n    this.userLoggedIn = this.$store.state.CurrentUser.userLoggedIn;\n    this.productId = parseInt(this.$route.params.productId);\n    try {\n      this.productRating = (\n        await ProductsService.getProductRating(this.productId)\n      ).data;\n    } catch (error) {\n      console.log(error.response.data.error);\n    }\n    try {\n      this.reviewList = (\n        await ReviewService.getReviewList(this.productId)\n      ).data;\n      if (this.reviewList) {\n        this.reviews = this.reviewList.length;\n        const start = 0;\n        this.reviewList2 = this.reviewList.slice(start, start + this.perPage);\n      }\n    } catch (error) {\n      console.log(error.response.data.error);\n    }\n    var i;\n    for (i = 0; i < this.reviewList.length; i++) {\n      if (this.reviewList[i].comment != \"\") this.commentCount++;\n      if (this.reviewList[i].rating == 0) this.zeroStar++;\n      else if (this.reviewList[i].rating == 1) this.oneStar++;\n      else if (this.reviewList[i].rating == 2) this.twoStar++;\n      else if (this.reviewList[i].rating == 3) this.threeStar++;\n      else if (this.reviewList[i].rating == 4) this.fourStar++;\n      else if (this.reviewList[i].rating == 5) this.fiveStar++;\n\n      if (this.reviewList[i].UserId == this.userId)\n        this.currentUserReview = this.reviewList[i];\n      this.userReviewFlag = Object.keys(this.currentUserReview).length != 0;\n      if (!this.reviewList[i].mode) {\n        this.reviewList[i].mode = 0;\n      }\n    }\n    this.ratingCount =\n      this.oneStar +\n      this.twoStar +\n      this.threeStar +\n      this.fourStar +\n      this.fiveStar;\n    if (this.ratingCount != 0) {\n      this.averageRating =\n        Math.round(\n          (10 *\n            (5 * this.fiveStar +\n              4 * this.fourStar +\n              3 * this.threeStar +\n              2 * this.twoStar +\n              1 * this.oneStar)) /\n            this.ratingCount\n        ) / 10;\n      this.oneStarPercent = Math.round((this.oneStar * 100) / this.ratingCount);\n      this.twoStarPercent = Math.round((this.twoStar * 100) / this.ratingCount);\n      this.threeStarPercent = Math.round(\n        (this.threeStar * 100) / this.ratingCount\n      );\n      this.fourStarPercent = Math.round(\n        (this.fourStar * 100) / this.ratingCount\n      );\n      this.fiveStarPercent = Math.round(\n        (this.fiveStar * 100) / this.ratingCount\n      );\n    }\n  },\n  methods: {\n    paginate(currentPage) {\n      const start = (currentPage - 1) * this.perPage;\n      this.reviewList2 = this.reviewList.slice(start, start + this.perPage);\n    },\n    async createReview() {\n      await this.$store.dispatch(\"Review/createReview\", {\n        rating: this.rating,\n        comment: this.comment,\n        productId: this.productId,\n        productRating: this.productRating\n      });\n      await this.$store.dispatch(\"Products/setAllBackupProducts\");\n      window.location.reload();\n    },\n\n    editReview(review) {\n      this.editRating = review.rating;\n      this.editComment = review.comment;\n      this.reviewEditing = review;\n      this.$bvModal.show(\"editReviewModal\");\n    },\n    async updateReview() {\n      this.$bvModal.hide(\"editReviewModal\");\n      await this.$store.dispatch(\"Review/updateReview\", {\n        review: this.reviewEditing,\n        newRating: this.editRating,\n        newComment: this.editComment\n      });\n      await this.$store.dispatch(\"Products/setAllBackupProducts\");\n      window.location.reload();\n    },\n\n    async deleteReview(review) {\n      if (this.userLoggedIn) {\n        await this.$store.dispatch(\"Review/deleteReview\", review);\n        await this.$store.dispatch(\"Products/setAllBackupProducts\");\n        window.location.reload();\n      }\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped></style>\n"]}]}