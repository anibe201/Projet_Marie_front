{"remainingRequest":"C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\src\\views\\Admin\\AUsers.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\src\\views\\Admin\\AUsers.vue","mtime":1645609201000},{"path":"C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1664810865393},{"path":"C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\node_modules\\babel-loader\\lib\\index.js","mtime":1664810865430},{"path":"C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1664810865393},{"path":"C:\\Users\\AlexisAnohVianneyANI\\Downloads\\emarket-main\\shop\\node_modules\\vue-loader\\lib\\index.js","mtime":1664810875252}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBBVG9wSGVhZGVyIGZyb20gIkAvY29tcG9uZW50cy9BZG1pbnMvQVRvcEhlYWRlci52dWUiOwppbXBvcnQgRm9vdGVyIGZyb20gIkAvY29tcG9uZW50cy9Db21tb24vRm9vdGVyLnZ1ZSI7CmltcG9ydCBVc2VyU2VydmljZSBmcm9tICJAL3NlcnZpY2VzL1VzZXJTZXJ2aWNlLmpzIjsKaW1wb3J0IFJldmlld1NlcnZpY2UgZnJvbSAiQC9zZXJ2aWNlcy9SZXZpZXdTZXJ2aWNlLmpzIjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJBVXNlcnMiLAogIGNvbXBvbmVudHM6IHsKICAgIEFUb3BIZWFkZXIsCiAgICBGb290ZXIKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBhbnlUeXBlOiB7CiAgICAgICAgbmFtZTogIkFsbCIsCiAgICAgICAgdmFyaWFudDogImRhcmsiCiAgICAgIH0sCiAgICAgIHVzZXJJZDogMCwKICAgICAgc2VsZWN0ZWRUeXBlTmFtZTogIkFsbCIsCiAgICAgIHNlbGVjdGVkVHlwZVZhcmlhbnQ6ICJkYXJrIiwKICAgICAgc2VhcmNoVXNlclRleHQ6ICIiLAogICAgICB1c2VyczogMCwKICAgICAgc2Vjb25kVXNlckxpc3Q6IFtdLAogICAgICB1c2VyTGlzdDogW10sCiAgICAgIHVzZXJMaXN0MjogW10sCiAgICAgIHVzZXJTdGF0dXM6IFsKICAgICAgICB7CiAgICAgICAgICBuYW1lOiAiQWRtaW4iLAogICAgICAgICAgcHJpb3JpdHk6IDEsCiAgICAgICAgICBkZXNjcmlwdGlvbjogIk93bmVyIG9mIHRoaXMgc3lzdGVtLiIsCiAgICAgICAgICB2YXJpYW50OiAiZGFyayIKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIG5hbWU6ICJDdXN0b21lciIsCiAgICAgICAgICBwcmlvcml0eTogMiwKICAgICAgICAgIGRlc2NyaXB0aW9uOiAiRW5kIHVzZXIgb2YgdGhlIHN5c3RlbS4iLAogICAgICAgICAgdmFyaWFudDogIndhcm5pbmciCiAgICAgICAgfQogICAgICBdLAogICAgICBjdXJyZW50UGFnZTogMSwKICAgICAgcGVyUGFnZTogMjAKICAgIH07CiAgfSwKICBjb21wdXRlZDoge30sCgogIGFzeW5jIG1vdW50ZWQoKSB7CiAgICB0cnkgewogICAgICB0aGlzLnVzZXJJZCA9IHRoaXMuJHN0b3JlLnN0YXRlLkN1cnJlbnRVc2VyLnVzZXJJZDsKICAgICAgdGhpcy51c2VyTGlzdCA9IChhd2FpdCBVc2VyU2VydmljZS5nZXRVc2VyTGlzdCgpKS5kYXRhOwogICAgICB0aGlzLnVzZXJMaXN0MiA9IHRoaXMudXNlckxpc3Quc2xpY2UoKTsKICAgICAgaWYgKHRoaXMudXNlckxpc3QyKSB7CiAgICAgICAgdGhpcy51c2VycyA9IHRoaXMudXNlckxpc3QyLmxlbmd0aDsKICAgICAgICBjb25zdCBzdGFydCA9IDA7CiAgICAgICAgdGhpcy5zZWNvbmRVc2VyTGlzdCA9IHRoaXMudXNlckxpc3QyLnNsaWNlKHN0YXJ0LCBzdGFydCArIHRoaXMucGVyUGFnZSk7CiAgICAgIH0KICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgIGNvbnNvbGUubG9nKGVycm9yLnJlc3BvbnNlLmRhdGEuZXJyb3IpOwogICAgfQogIH0sCgogIG1ldGhvZHM6IHsKICAgIHNlYXJjaCgpIHsKICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRUeXBlTmFtZSAhPSAiQWxsIikgewogICAgICAgIHRoaXMudXNlckxpc3QyID0gdGhpcy51c2VyTGlzdDIuZmlsdGVyKHZhbCA9PiB7CiAgICAgICAgICByZXR1cm4gdmFsLnVzZXJUeXBlCiAgICAgICAgICAgIC50b0xvd2VyQ2FzZSgpCiAgICAgICAgICAgIC5pbmNsdWRlcyh0aGlzLnNlbGVjdGVkVHlwZU5hbWUudG9Mb3dlckNhc2UoKSk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgdGhpcy51c2VyTGlzdDIgPSB0aGlzLnVzZXJMaXN0Mi5maWx0ZXIodmFsID0+IHsKICAgICAgICByZXR1cm4gKAogICAgICAgICAgdmFsLmZpcnN0TmFtZQogICAgICAgICAgICAudG9Mb3dlckNhc2UoKQogICAgICAgICAgICAuaW5jbHVkZXModGhpcy5zZWFyY2hVc2VyVGV4dC50b0xvd2VyQ2FzZSgpKSB8fAogICAgICAgICAgdmFsLmxhc3ROYW1lCiAgICAgICAgICAgIC50b0xvd2VyQ2FzZSgpCiAgICAgICAgICAgIC5pbmNsdWRlcyh0aGlzLnNlYXJjaFVzZXJUZXh0LnRvTG93ZXJDYXNlKCkpIHx8CiAgICAgICAgICB2YWwuZW1haWwudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyh0aGlzLnNlYXJjaFVzZXJUZXh0LnRvTG93ZXJDYXNlKCkpCiAgICAgICAgKTsKICAgICAgfSk7CiAgICAgIHRoaXMudXNlcnMgPSB0aGlzLnVzZXJMaXN0Mi5sZW5ndGg7CiAgICAgIGNvbnN0IHN0YXJ0ID0gMDsKICAgICAgdGhpcy5zZWNvbmRVc2VyTGlzdCA9IHRoaXMudXNlckxpc3QyLnNsaWNlKHN0YXJ0LCBzdGFydCArIHRoaXMucGVyUGFnZSk7CiAgICB9LAogICAgc2VsZWN0VHlwZShzdGF0dXMpIHsKICAgICAgaWYgKHN0YXR1cy5uYW1lID09ICJBbGwiKSB7CiAgICAgICAgdGhpcy5zZWFyY2hVc2VyVGV4dCA9ICIiOwogICAgICAgIHRoaXMuc2VsZWN0ZWRUeXBlTmFtZSA9IHN0YXR1cy5uYW1lOwogICAgICAgIHRoaXMuc2VsZWN0ZWRUeXBlVmFyaWFudCA9IHN0YXR1cy52YXJpYW50OwogICAgICAgIHRoaXMudXNlckxpc3QyID0gdGhpcy51c2VyTGlzdC5zbGljZSgpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuc2VsZWN0ZWRUeXBlTmFtZSA9IHN0YXR1cy5uYW1lOwogICAgICAgIHRoaXMuc2VsZWN0ZWRUeXBlVmFyaWFudCA9IHN0YXR1cy52YXJpYW50OwogICAgICAgIHRoaXMudXNlckxpc3QyID0gdGhpcy51c2VyTGlzdC5maWx0ZXIoCiAgICAgICAgICBvYmogPT4gb2JqLnVzZXJUeXBlID09IHN0YXR1cy5uYW1lCiAgICAgICAgKTsKICAgICAgfQogICAgICB0aGlzLnVzZXJzID0gdGhpcy51c2VyTGlzdDIubGVuZ3RoOwogICAgICBjb25zdCBzdGFydCA9IDA7CiAgICAgIHRoaXMuc2Vjb25kVXNlckxpc3QgPSB0aGlzLnVzZXJMaXN0Mi5zbGljZShzdGFydCwgc3RhcnQgKyB0aGlzLnBlclBhZ2UpOwogICAgfSwKICAgIGFzeW5jIHVwZGF0ZVN0YXR1cyh1c2VyLCBzdGF0dXMpIHsKICAgICAgY29uc3QgaW5kZXggPSB0aGlzLnNlY29uZFVzZXJMaXN0LmZpbmRJbmRleChvYmogPT4gb2JqLmlkID09PSB1c2VyLmlkKTsKICAgICAgdGhpcy5zZWNvbmRVc2VyTGlzdFtpbmRleF0udXNlclR5cGUgPSBzdGF0dXMubmFtZTsKICAgICAgdGhpcy5zZWNvbmRVc2VyTGlzdFtpbmRleF0udmFyaWFudCA9IHN0YXR1cy52YXJpYW50OwogICAgICBhd2FpdCBVc2VyU2VydmljZS51cGRhdGVVc2VyKHsKICAgICAgICBpZDogdXNlci5pZCwKICAgICAgICB1c2VyVHlwZTogc3RhdHVzLm5hbWUsCiAgICAgICAgcHJpb3JpdHk6IHN0YXR1cy5wcmlvcml0eSwKICAgICAgICB2YXJpYW50OiBzdGF0dXMudmFyaWFudAogICAgICB9KTsKICAgIH0sCiAgICBhc3luYyBkZWxldGVBY2NvdW50KHVzZXIpIHsKICAgICAgdmFyIHJldmlld0xpc3QgPSBbXTsKICAgICAgdHJ5IHsKICAgICAgICByZXZpZXdMaXN0ID0gKGF3YWl0IFJldmlld1NlcnZpY2UuZ2V0VXNlcnNSZXZpZXdMaXN0KHVzZXIuaWQpKS5kYXRhOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUubG9nKGVycm9yLnJlc3BvbnNlLmRhdGEuZXJyb3IpOwogICAgICB9CiAgICAgIHZhciBpOwogICAgICBmb3IgKGkgaW4gcmV2aWV3TGlzdCkgewogICAgICAgIGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCJSZXZpZXcvZGVsZXRlUmV2aWV3IiwgcmV2aWV3TGlzdFtpXSk7CiAgICAgIH0KCiAgICAgIHRyeSB7CiAgICAgICAgYXdhaXQgVXNlclNlcnZpY2UuZGVsZXRlQWNjb3VudCh1c2VyLmlkKTsKICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgdGhpcy4kYnZUb2FzdC50b2FzdChlcnJvci5yZXNwb25zZS5kYXRhLmVycm9yLCB7CiAgICAgICAgICB0aXRsZTogIkVycm9yIGRlbGV0aW5nIEFjY291bnQiLAogICAgICAgICAgdmFyaWFudDogImRhbmdlciIsCiAgICAgICAgICB0b2FzdGVyOiAiYi10b2FzdGVyLXRvcC1jZW50ZXIiLAogICAgICAgICAgbm9DbG9zZUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICBzb2xpZDogdHJ1ZQogICAgICAgIH0pOwogICAgICAgIGNvbnNvbGUubG9nKGVycm9yLnJlc3BvbnNlLmRhdGEuZXJyb3IpOwogICAgICB9CiAgICB9LAogICAgcGFnaW5hdGUoY3VycmVudFBhZ2UpIHsKICAgICAgY29uc3Qgc3RhcnQgPSAoY3VycmVudFBhZ2UgLSAxKSAqIHRoaXMucGVyUGFnZTsKICAgICAgdGhpcy5zZWNvbmRVc2VyTGlzdCA9IHRoaXMudXNlckxpc3QyLnNsaWNlKHN0YXJ0LCBzdGFydCArIHRoaXMucGVyUGFnZSk7CiAgICB9CiAgfQp9Owo="},{"version":3,"sources":["AUsers.vue"],"names":[],"mappings":";AAkJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AUsers.vue","sourceRoot":"src/views/Admin","sourcesContent":["<template>\n  <div>\n    <ATopHeader></ATopHeader>\n    <b-container class=\"mt-2\">\n      <b-row>\n        <b-col class=\"text-center\">\n          <h3>Users</h3>\n        </b-col>\n      </b-row>\n      <hr />\n      <b-row>\n        <b-col>\n          <b-row>\n            <b-col cols=\"8\" />\n            <b-col cols=\"4\">\n              <b-form inline @submit.prevent=\"search\">\n                <b-form-input\n                  v-model=\"searchUserText\"\n                  size=\"\"\n                  class=\"mr-sm-2\"\n                  placeholder=\"Search user...\"\n                  @keyup.enter=\"search\"\n                />\n                <b-button @click=\"search\" variant=\"white\">\n                  <b-icon icon=\"search\"></b-icon\n                ></b-button>\n              </b-form>\n            </b-col>\n          </b-row>\n\n          <div v-if=\"users != 0\">\n            <hr />\n            <div>\n              <b-row>\n                <b-col> </b-col>\n                <b-col>\n                  <strong>Email</strong>\n                </b-col>\n                <b-col>\n                  <strong>Name</strong>\n                </b-col>\n                <b-col>\n                  <strong>Phone No.</strong>\n                </b-col>\n                <b-col class=\"text-center\">\n                  <strong>Status</strong>\n                  <b-dropdown\n                    size=\"sm\"\n                    id=\"dropdown-left\"\n                    :text=\"selectedTypeName\"\n                    :variant=\"selectedTypeVariant\"\n                    class=\"ml-2\"\n                  >\n                    <b-dropdown-item @click=\"selectType(anyType)\">\n                      {{ anyType.name }}\n                    </b-dropdown-item>\n                    <b-dropdown-item\n                      v-for=\"(status, idx) in userStatus\"\n                      :key=\"idx\"\n                      @click=\"selectType(status)\"\n                    >\n                      {{ status.name }}\n                    </b-dropdown-item>\n                  </b-dropdown>\n                </b-col>\n              </b-row>\n              <hr />\n            </div>\n\n            <div v-for=\"user in secondUserList\" :key=\"user.id\">\n              <b-row>\n                <b-col>\n                  <b-img\n                    height=\"80px\"\n                    :src=\"user.profileImage\"\n                    alt=\"No Image\"\n                  />\n                </b-col>\n                <b-col>\n                  {{ user.email }}\n                </b-col>\n                <b-col>{{ user.firstName }} {{ user.lastName }}</b-col>\n                <b-col>{{ user.phoneNo }}</b-col>\n                <b-col>\n                  <b-row>\n                    <b-col cols=\"7\">\n                      <b-dropdown\n                        size=\"sm\"\n                        block\n                        id=\"dropdown-left\"\n                        :text=\"user.userType\"\n                        :variant=\"user.variant\"\n                      >\n                        <b-dropdown-item\n                          v-for=\"(status, idx) in userStatus\"\n                          :key=\"idx\"\n                          @click=\"updateStatus(user, status)\"\n                        >\n                          {{ status.name }}\n                        </b-dropdown-item>\n                      </b-dropdown>\n                    </b-col>\n                    <b-col cols=\"5\">\n                      <b-button\n                        size=\"sm\"\n                        block\n                        variant=\"danger\"\n                        v-if=\"user.id != userId\"\n                        @click=\"deleteAccount(user)\"\n                      >\n                        Delete\n                      </b-button>\n                      <b-button\n                        size=\"sm\"\n                        block\n                        to=\"/admin/profile\"\n                        v-if=\"user.id == userId\"\n                        variant=\"info\"\n                      >\n                        Profile\n                      </b-button>\n                    </b-col>\n                  </b-row>\n                </b-col>\n              </b-row>\n              <hr />\n            </div>\n          </div>\n          <div class=\"m-4 d-flex justify-content-center\" v-if=\"users == 0\">\n            <h3>User not found...</h3>\n          </div>\n          <b-pagination\n            v-if=\"users != 0\"\n            size=\"lg\"\n            v-model=\"currentPage\"\n            :total-rows=\"users\"\n            :per-page=\"perPage\"\n            @input=\"paginate(currentPage)\"\n          ></b-pagination>\n        </b-col>\n      </b-row>\n    </b-container>\n    <Footer class=\"mt-5\" />\n  </div>\n</template>\n<script>\nimport ATopHeader from \"@/components/Admins/ATopHeader.vue\";\nimport Footer from \"@/components/Common/Footer.vue\";\nimport UserService from \"@/services/UserService.js\";\nimport ReviewService from \"@/services/ReviewService.js\";\nexport default {\n  name: \"AUsers\",\n  components: {\n    ATopHeader,\n    Footer\n  },\n  data() {\n    return {\n      anyType: {\n        name: \"All\",\n        variant: \"dark\"\n      },\n      userId: 0,\n      selectedTypeName: \"All\",\n      selectedTypeVariant: \"dark\",\n      searchUserText: \"\",\n      users: 0,\n      secondUserList: [],\n      userList: [],\n      userList2: [],\n      userStatus: [\n        {\n          name: \"Admin\",\n          priority: 1,\n          description: \"Owner of this system.\",\n          variant: \"dark\"\n        },\n        {\n          name: \"Customer\",\n          priority: 2,\n          description: \"End user of the system.\",\n          variant: \"warning\"\n        }\n      ],\n      currentPage: 1,\n      perPage: 20\n    };\n  },\n  computed: {},\n\n  async mounted() {\n    try {\n      this.userId = this.$store.state.CurrentUser.userId;\n      this.userList = (await UserService.getUserList()).data;\n      this.userList2 = this.userList.slice();\n      if (this.userList2) {\n        this.users = this.userList2.length;\n        const start = 0;\n        this.secondUserList = this.userList2.slice(start, start + this.perPage);\n      }\n    } catch (error) {\n      console.log(error.response.data.error);\n    }\n  },\n\n  methods: {\n    search() {\n      if (this.selectedTypeName != \"All\") {\n        this.userList2 = this.userList2.filter(val => {\n          return val.userType\n            .toLowerCase()\n            .includes(this.selectedTypeName.toLowerCase());\n        });\n      }\n      this.userList2 = this.userList2.filter(val => {\n        return (\n          val.firstName\n            .toLowerCase()\n            .includes(this.searchUserText.toLowerCase()) ||\n          val.lastName\n            .toLowerCase()\n            .includes(this.searchUserText.toLowerCase()) ||\n          val.email.toLowerCase().includes(this.searchUserText.toLowerCase())\n        );\n      });\n      this.users = this.userList2.length;\n      const start = 0;\n      this.secondUserList = this.userList2.slice(start, start + this.perPage);\n    },\n    selectType(status) {\n      if (status.name == \"All\") {\n        this.searchUserText = \"\";\n        this.selectedTypeName = status.name;\n        this.selectedTypeVariant = status.variant;\n        this.userList2 = this.userList.slice();\n      } else {\n        this.selectedTypeName = status.name;\n        this.selectedTypeVariant = status.variant;\n        this.userList2 = this.userList.filter(\n          obj => obj.userType == status.name\n        );\n      }\n      this.users = this.userList2.length;\n      const start = 0;\n      this.secondUserList = this.userList2.slice(start, start + this.perPage);\n    },\n    async updateStatus(user, status) {\n      const index = this.secondUserList.findIndex(obj => obj.id === user.id);\n      this.secondUserList[index].userType = status.name;\n      this.secondUserList[index].variant = status.variant;\n      await UserService.updateUser({\n        id: user.id,\n        userType: status.name,\n        priority: status.priority,\n        variant: status.variant\n      });\n    },\n    async deleteAccount(user) {\n      var reviewList = [];\n      try {\n        reviewList = (await ReviewService.getUsersReviewList(user.id)).data;\n      } catch (error) {\n        console.log(error.response.data.error);\n      }\n      var i;\n      for (i in reviewList) {\n        await this.$store.dispatch(\"Review/deleteReview\", reviewList[i]);\n      }\n\n      try {\n        await UserService.deleteAccount(user.id);\n        window.location.reload();\n      } catch (error) {\n        this.$bvToast.toast(error.response.data.error, {\n          title: \"Error deleting Account\",\n          variant: \"danger\",\n          toaster: \"b-toaster-top-center\",\n          noCloseButton: false,\n          solid: true\n        });\n        console.log(error.response.data.error);\n      }\n    },\n    paginate(currentPage) {\n      const start = (currentPage - 1) * this.perPage;\n      this.secondUserList = this.userList2.slice(start, start + this.perPage);\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped></style>\n"]}]}